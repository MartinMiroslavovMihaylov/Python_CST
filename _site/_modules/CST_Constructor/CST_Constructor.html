

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CST_Constructor.CST_Constructor &mdash; Python-CST Constructor Script 27.01.2026 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=b3658ba4"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Python-CST Constructor Script
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Install.html#cst-installation-and-file-location">CST Installation and file location</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Examples/index.html#full-code-examples">Full Code Examples:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Examples/Example_GSG_Pads_with_Bondwires.html">Example_GSG_Pads_with_Bondwires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Examples/Example_GSGSG_Pads_with_Bondwires.html">Example_GSGSG_Pads_with_Bondwires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Examples/Example_MZM.html">Example_MZM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Examples/Example_Phase_Modulator.html">Example_Phase_Modulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Examples/Example_Waveguide_FDE.html">Example_Waveguide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Extras/index.html">Curves ClassExamples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CST_Constructor.html">CST_Constructor Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands"><code class="docutils literal notranslate"><span class="pre">CST_Commands</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.AddGlobalParameter"><code class="docutils literal notranslate"><span class="pre">CST_Commands.AddGlobalParameter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.BondWire"><code class="docutils literal notranslate"><span class="pre">CST_Commands.BondWire()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Brick"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Brick()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ChangeSolverType"><code class="docutils literal notranslate"><span class="pre">CST_Commands.ChangeSolverType()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ClearAllPicks"><code class="docutils literal notranslate"><span class="pre">CST_Commands.ClearAllPicks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Conus"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Conus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CreateEfieldMonitor"><code class="docutils literal notranslate"><span class="pre">CST_Commands.CreateEfieldMonitor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Curve"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Curve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CurveToSolid"><code class="docutils literal notranslate"><span class="pre">CST_Commands.CurveToSolid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CurveWire"><code class="docutils literal notranslate"><span class="pre">CST_Commands.CurveWire()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Cut_structures"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Cut_structures()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Cylinder"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Cylinder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.DeleteGlobalParameter"><code class="docutils literal notranslate"><span class="pre">CST_Commands.DeleteGlobalParameter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Elipse"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Elipse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GGB_Probe"><code class="docutils literal notranslate"><span class="pre">CST_Commands.GGB_Probe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GSGSG_Bondwire_ChipToChip_connection"><code class="docutils literal notranslate"><span class="pre">CST_Commands.GSGSG_Bondwire_ChipToChip_connection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GSG_Bondwire_ChipToChip_connection"><code class="docutils literal notranslate"><span class="pre">CST_Commands.GSG_Bondwire_ChipToChip_connection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.MZM"><code class="docutils literal notranslate"><span class="pre">CST_Commands.MZM()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.MoveWaveguidePorts"><code class="docutils literal notranslate"><span class="pre">CST_Commands.MoveWaveguidePorts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.New_Project"><code class="docutils literal notranslate"><span class="pre">CST_Commands.New_Project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Open_Project"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Open_Project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.PhaseModulator"><code class="docutils literal notranslate"><span class="pre">CST_Commands.PhaseModulator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Pick"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Pick()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Poligon_2D"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Poligon_2D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Poligon_3D"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Poligon_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.RibWaveguide_ToSolid"><code class="docutils literal notranslate"><span class="pre">CST_Commands.RibWaveguide_ToSolid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.RotationTranslation"><code class="docutils literal notranslate"><span class="pre">CST_Commands.RotationTranslation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Save_Project"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Save_Project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.SetDiscretePort"><code class="docutils literal notranslate"><span class="pre">CST_Commands.SetDiscretePort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.SetMesh"><code class="docutils literal notranslate"><span class="pre">CST_Commands.SetMesh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Sphere"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Sphere()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Squere_Waveguide"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Squere_Waveguide()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.StartTimeSolver"><code class="docutils literal notranslate"><span class="pre">CST_Commands.StartTimeSolver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ToSolid"><code class="docutils literal notranslate"><span class="pre">CST_Commands.ToSolid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Translation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation_Rotation"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Translation_Rotation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation_Scale"><code class="docutils literal notranslate"><span class="pre">CST_Commands.Translation_Scale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.WaveguidePort"><code class="docutils literal notranslate"><span class="pre">CST_Commands.WaveguidePort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.WaveguidePortWithPins"><code class="docutils literal notranslate"><span class="pre">CST_Commands.WaveguidePortWithPins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Al"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_Al()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Au"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_Au()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_GGB_Probe_Material"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_GGB_Probe_Material()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Glue"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_Glue()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Si"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_Si()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_SiO2"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_SiO2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_anisotropy_material"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_anisotropy_material()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_json_material"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_json_material()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_material"><code class="docutils literal notranslate"><span class="pre">CST_Commands.add_material()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.removeObject"><code class="docutils literal notranslate"><span class="pre">CST_Commands.removeObject()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setBackground"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setBackground()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setBoundary"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setBoundary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setDomainSolverType"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setDomainSolverType()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setElectricalSimulationProperties"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setElectricalSimulationProperties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setFreqSolver"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setFreqSolver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setOpticalSimulationProperties"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setOpticalSimulationProperties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setSimFreqeuncy"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setSimFreqeuncy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setSimWavelength"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setSimWavelength()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setTimeSolver"><code class="docutils literal notranslate"><span class="pre">CST_Commands.setTimeSolver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.set_Units"><code class="docutils literal notranslate"><span class="pre">CST_Commands.set_Units()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.Curves"><code class="docutils literal notranslate"><span class="pre">Curves</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Bezier_Curve"><code class="docutils literal notranslate"><span class="pre">Curves.Bezier_Curve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Cosinus_Curve"><code class="docutils literal notranslate"><span class="pre">Curves.Cosinus_Curve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Euler_Curve"><code class="docutils literal notranslate"><span class="pre">Curves.Euler_Curve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Python-CST Constructor Script</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">CST_Constructor.CST_Constructor</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for CST_Constructor.CST_Constructor</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">cst</span>
<span class="kn">import</span> <span class="nn">cst.interface</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">fresnel</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span><span class="mi">22</span><span class="p">})</span>



<div class="viewcode-block" id="CST_Commands">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands">[docs]</a>
<span class="k">class</span> <span class="nc">CST_Commands</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Connect to existing CST Window or open new one </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Connect to existing CST Window or open new working window.</span>
<span class="sd">           Possible CST Projects:</span>
<span class="sd">                                - CST Cable Studio project</span>
<span class="sd">                                - CST Design Studio project</span>
<span class="sd">                                - CST EM Studio project</span>
<span class="sd">                                - Filter Designer 3D project</span>
<span class="sd">                                - CST Mphysics Studio project</span>
<span class="sd">                                - CST Microwave Studio project</span>
<span class="sd">                                - CST PCB Studio project</span>
<span class="sd">                                - CST Particle Studio project</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">de</span> <span class="o">=</span> <span class="n">cst</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">DesignEnvironment</span><span class="o">.</span><span class="n">connect_to_any_or_new</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CS&quot;</span><span class="p">,</span> <span class="s2">&quot;DS&quot;</span><span class="p">,</span> <span class="s2">&quot;EMS&quot;</span><span class="p">,</span> <span class="s2">&quot;FD3D&quot;</span><span class="p">,</span> <span class="s2">&quot;MPS&quot;</span><span class="p">,</span> <span class="s2">&quot;MWS&quot;</span><span class="p">,</span> <span class="s2">&quot;PCBS&quot;</span><span class="p">,</span> <span class="s2">&quot;PS&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="kc">None</span>
    


<div class="viewcode-block" id="CST_Commands.New_Project">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.New_Project">[docs]</a>
    <span class="k">def</span> <span class="nf">New_Project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_project</span><span class="p">):</span>
        <span class="c1"># Start an new Project </span>
        <span class="k">if</span> <span class="n">name_project</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_names_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;CS&quot;</span><span class="p">:</span>
                <span class="c1"># CST Cable Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_cs</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;DS&quot;</span><span class="p">:</span>
                <span class="c1"># CST Design Studio project </span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_ds</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;EMS&quot;</span><span class="p">:</span>
                <span class="c1"># CST EM Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_ems</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;FD3D&quot;</span><span class="p">:</span>
                <span class="c1"># Filter Designer 3D project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_fd3d</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;MPS&quot;</span><span class="p">:</span>
                <span class="c1"># CST Mphysics Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_mps</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;MWS&quot;</span><span class="p">:</span>
                <span class="c1"># CST Microwave Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_mws</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;PCBS&quot;</span><span class="p">:</span>
                <span class="c1"># CST PCB Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_pcbs</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name_project</span> <span class="o">==</span> <span class="s2">&quot;PS&quot;</span><span class="p">:</span>
                <span class="c1"># CST Particle Studio project</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">new_ps</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="w">                            </span><span class="sd">&quot;&quot;&quot;Possible new Project Names are:</span>
<span class="sd">                            &#39;CS&#39;   for CST Cable Studio project</span>
<span class="sd">                            &#39;DS&#39;   for CST Design Studio project</span>
<span class="sd">                            &#39;EMS&#39;  for CST EM Studio project</span>
<span class="sd">                            &#39;FD3D&#39; for Filter Designer 3D project</span>
<span class="sd">                            &#39;MPS&#39;  for CST Mphysics Studio project</span>
<span class="sd">                            &#39;MWS&#39;  for CST Microwave Studio project</span>
<span class="sd">                            &#39;PCBS&#39; for CST PCB Studio project</span>
<span class="sd">                            &#39;PS&#39;   for CST Particle Studio project&quot;&quot;&quot;</span>
                            <span class="p">)</span></div>

        
    

<div class="viewcode-block" id="CST_Commands.Save_Project">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Save_Project">[docs]</a>
    <span class="k">def</span> <span class="nf">Save_Project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save CST Project to path with an given name</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to where the CST file should be saved.</span>
<span class="sd">            name (srr): Name of the file to save</span>
<span class="sd">            overwrite (bool, optional): If the save file exist you can set &quot;overwrite=True&quot; to overwrite the existing save project. Defaults to False.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.cst&quot;</span><span class="p">,</span> <span class="n">allow_overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.Open_Project">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Open_Project">[docs]</a>
    <span class="k">def</span> <span class="nf">Open_Project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open existing project.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path and name to the project that you want ot open. </span>
<span class="sd">            For example : path = &quot;C:/Test_folder/Test_cst_Project.cst&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># open the project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">de</span><span class="o">.</span><span class="n">open_project</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>



<div class="viewcode-block" id="CST_Commands.removeObject">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.removeObject">[docs]</a>
    <span class="k">def</span> <span class="nf">removeObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete objects in project</span>

<span class="sd">        Args: Parameters (dict) with all needed parameters for the function. </span>
<span class="sd">                Parameters[&quot;Type&quot;] : (str) Type of the Deleted objet. It can be:  </span>
<span class="sd">                                                                    &#39;Folder&#39;</span>
<span class="sd">                                                                    &#39;Material&#39;</span>
<span class="sd">                                                                    &#39;Component&#39;</span>
<span class="sd">                                                                    &#39;Port&#39;</span>
<span class="sd">                                                                    &#39;Curve&#39; </span>
<span class="sd">                Parameters[&quot;Name&quot;] : (str) Name of the object to delete. When &#39;Port&#39; choosen you only need </span>
<span class="sd">                to give the number of the port , like Parameters[&quot;Name&quot;] = &quot;1&quot;</span>

<span class="sd">            For example Parameters[&quot;Type&quot;] = &#39;Component&#39;</span>
<span class="sd">                        Parameters[&quot;Name&quot;] = &#39;Box&#39;</span>
<span class="sd">                        This will delte an component called box. </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;Folder&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                         Wire.DeleteFolder &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;Material&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                         Material.Delete &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;Component&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                         Component.Delete &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;Port&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                         Port.Delete &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;Curve&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                         Curve.DeleteCurve &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not supportet Type. You can choose between, &#39;Component&#39;, &#39;Folder&#39;, Material, &#39;Port&#39;, or &#39;Curve&#39; !&quot;</span><span class="p">)</span></div>

  




    <span class="c1">############################################################################</span>
    <span class="c1"># CST solver parameters</span>
    <span class="c1">############################################################################</span>
    

<div class="viewcode-block" id="CST_Commands.set_Units">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.set_Units">[docs]</a>
    <span class="k">def</span> <span class="nf">set_Units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set CSt enviroment global units.</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with the name and value of the parameter.</span>
<span class="sd">                            Parameters[&quot;Unit Lenght&quot;] - str with measurement unit for lenght. For example &quot;um&quot;</span>
<span class="sd">                            Parameters[&quot;Unit Frequency&quot;] - str with measurement unit for frequency. For example &quot;GHz&quot;</span>
<span class="sd">                            Parameters[&quot;Unit Time&quot;] - str with measurement unit for time. For example &quot;ns&quot;</span>
<span class="sd">                            Parameters[&quot;Unit Temperature&quot;] - str with measurement unit for temperatur. For example &quot;K&quot;</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">u_Lenght</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Unit Lenght&quot;</span><span class="p">]</span>
        <span class="n">u_Freq</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Unit Frequency&quot;</span><span class="p">]</span>
        <span class="n">u_Time</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Unit Time&quot;</span><span class="p">]</span>
        <span class="n">u_Temp</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Unit Temperature&quot;</span><span class="p">]</span>
        <span class="c1"># define a String holding the VBA code for setting the units</span>

        <span class="n">unit_vba</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Units</span>
<span class="s2">                            .SetUnit (&quot;Length&quot;, &quot;</span><span class="si">{</span><span class="n">u_Lenght</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                            .SetUnit (&quot;Frequency&quot;,&quot;</span><span class="si">{</span><span class="n">u_Freq</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                            .SetUnit (&quot;Time&quot;, &quot;</span><span class="si">{</span><span class="n">u_Time</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                            .SetUnit (&quot;Temperature&quot;, &quot;</span><span class="si">{</span><span class="n">u_Temp</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
        
        <span class="c1"># add the VBA code to the History List</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set units&quot;</span><span class="p">,</span> <span class="n">unit_vba</span><span class="p">)</span></div>




    
<div class="viewcode-block" id="CST_Commands.add_json_material">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_json_material">[docs]</a>
    <span class="k">def</span> <span class="nf">add_json_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a JSON material file if one is provided by the manufacturer or another source.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to file.</span>
<span class="sd">            name (str): Name of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># load materials from JSON file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">materials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.add_material">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_material">[docs]</a>
    <span class="k">def</span> <span class="nf">add_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an pre-set of Materials that are for now only available. An extra materials need to be added here. </span>
<span class="sd">           Materials that are added to this CST_Constructor:</span>
<span class="sd">                                                            - &quot;Si&quot; Silicon</span>
<span class="sd">                                                            - &quot;LiNbO3&quot; Lithium niobate x-cut</span>
<span class="sd">                                                            - &quot;SiO2&quot; silicon dioxide</span>
<span class="sd">                                                            - &quot;Au&quot; Gold</span>
<span class="sd">                                                            - &quot;Al&quot; Aluminium</span>
<span class="sd">                                                            - &quot;Glue&quot; Special Glue for the Bondwire floating shield according to KIT Model</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_of_materials</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">,</span> <span class="s2">&quot;LiNbO3&quot;</span><span class="p">,</span> <span class="s2">&quot;SiO2&quot;</span><span class="p">,</span> <span class="s2">&quot;Au&quot;</span><span class="p">,</span> <span class="s2">&quot;Gold&quot;</span><span class="p">,</span> <span class="s2">&quot;Al&quot;</span><span class="p">,</span> <span class="s2">&quot;Glue&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">list_of_materials</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Si&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_Si</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;LiNbO3&quot;</span><span class="p">:</span>
                <span class="n">Data</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
                <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.584095</span>
                <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_anisotropy_material</span><span class="p">(</span><span class="s2">&quot;LiNbO3&quot;</span><span class="p">,</span> <span class="n">Data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;SiO2&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Au&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Gold&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Al&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_Al</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Glue&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_Glue</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ProbeMaterials&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_GGB_Probe_Material</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="w">                            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                            For now only the following materials can be added with this python script:</span>
<span class="sd">                            &quot;Si&quot;</span>
<span class="sd">                            &quot;LiNbO3&quot;</span>
<span class="sd">                            &quot;SiO2&quot;</span>
<span class="sd">                            &quot;Au or Gold&quot;</span>
<span class="sd">                            &quot;Al&quot;</span>
<span class="sd">                            &quot;Glue&quot;</span>
<span class="sd">                            ProbeMaterials</span>
<span class="sd">                            &quot;&quot;&quot;</span>
                            <span class="p">)</span></div>






<div class="viewcode-block" id="CST_Commands.add_anisotropy_material">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_anisotropy_material">[docs]</a>
    <span class="k">def</span> <span class="nf">add_anisotropy_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Anisotropic material to Material Libs</span>

<span class="sd">        Args:</span>
<span class="sd">            Name (str): Name of the Material</span>
<span class="sd">            Values (Dict): Dictionary with the material Values:</span>
<span class="sd">                            Values[&quot;X&quot;] : X Epsilon Value</span>
<span class="sd">                            Values[&quot;Y&quot;] : Y Epsilon Value</span>
<span class="sd">                            Values[&quot;Z&quot;] : Z Epsilon Value</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Chix = round((Values[&quot;X&quot;] - 1), 2)</span>
        <span class="c1"># Chiy = round((Values[&quot;Y&quot;] - 1), 2)</span>
        <span class="c1"># Chiz = round((Values[&quot;Z&quot;] - 1), 2 )</span>
        <span class="n">Chix</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> 
        <span class="n">Chiy</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> 
        <span class="n">Chiz</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="n">name</span>


        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Material</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .FrqType &quot;All&quot;</span>
<span class="s2">                        .Type &quot;Anisotropic&quot;</span>
<span class="s2">                        .SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;</span>
<span class="s2">                        .MuX &quot;1&quot;</span>
<span class="s2">                        .MuY &quot;1&quot;</span>
<span class="s2">                        .MuZ &quot;1&quot;</span>
<span class="s2">                        .EpsilonX &quot;</span><span class="si">{</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .EpsilonY &quot;</span><span class="si">{</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .EpsilonZ &quot;</span><span class="si">{</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;&#39;</span>
<span class="s2">                        .DispModelEps &quot;nonlinear2nd&quot;</span>
<span class="s2">                        .DispCoeff0EpsX &quot;</span><span class="si">{</span><span class="n">Chix</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .DispCoeff0EpsY &quot;</span><span class="si">{</span><span class="n">Chiy</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .DispCoeff0EpsZ &quot;</span><span class="si">{</span><span class="n">Chiz</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .DispModelMu &quot;None&quot;</span>
<span class="s2">                        .AddDispEpsPole1stOrderX &quot;0&quot;,&quot;0&quot;</span>
<span class="s2">                        .Color &quot;1&quot;,&quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add LiNbO3 material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>



<div class="viewcode-block" id="CST_Commands.add_Si">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Si">[docs]</a>
    <span class="k">def</span> <span class="nf">add_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add silicon to the Material Library</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Add Silicon to materials</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Material</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Name &quot;Si&quot;</span>
<span class="s2">                        .FrqType &quot;All&quot;</span>
<span class="s2">                        .Type &quot;Normal&quot;</span>
<span class="s2">                        .SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;</span>
<span class="s2">                        .Mu &quot;1&quot;</span>
<span class="s2">                        .Epsilon &quot;11.9&quot;</span>
<span class="s2">                        .Rho &quot;2330&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;148&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .MechanicsType &quot;Normal&quot;</span>
<span class="s2">                        .SpecificHeat &quot;700&quot;</span>
<span class="s2">                        .YoungsModulus &quot;112&quot;</span>
<span class="s2">                        .PoissonsRatio &quot;0.28&quot;</span>
<span class="s2">                        .Colour &quot;0.749&quot;, &quot;0.749&quot;, &quot;0.560&quot; </span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add Si material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="CST_Commands.add_SiO2">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_SiO2">[docs]</a>
    <span class="k">def</span> <span class="nf">add_SiO2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add silicon dioxide to the Material Library</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add Meterial SiO2</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Material</span>
<span class="s2">                        .Reset </span>
<span class="s2">                        .Name &quot;SiO2&quot;</span>
<span class="s2">                        .Rho &quot;2270.0&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;0.32&quot;</span>
<span class="s2">                        .SpecificHeat &quot;1000&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .DynamicViscosity &quot;0&quot;</span>
<span class="s2">                        .UseEmissivity &quot;True&quot;</span>
<span class="s2">                        .Emissivity &quot;0&quot;</span>
<span class="s2">                        .MetabolicRate &quot;0.0&quot;</span>
<span class="s2">                        .VoxelConvection &quot;0.0&quot;</span>
<span class="s2">                        .BloodFlow &quot;0&quot;</span>
<span class="s2">                        .MechanicsType &quot;Isotropic&quot;</span>
<span class="s2">                        .YoungsModulus &quot;66&quot;</span>
<span class="s2">                        .PoissonsRatio &quot;0.17&quot;</span>
<span class="s2">                        .ThermalExpansionRate &quot;0.56&quot;</span>
<span class="s2">                        .SolarRadiationAbsorptionType &quot;Opaque&quot;</span>
<span class="s2">                        .Absorptance &quot;0.0&quot;</span>
<span class="s2">                        .UseSemiTransparencyCalculator &quot;False&quot;</span>
<span class="s2">                        .SolarRadTransmittance &quot;0.0&quot;</span>
<span class="s2">                        .SolarRadReflectance &quot;0.0&quot;</span>
<span class="s2">                        .SolarRadSpecimenThickness &quot;0.0&quot;</span>
<span class="s2">                        .SolarRadRefractiveIndex &quot;1.0&quot;</span>
<span class="s2">                        .SolarRadAbsorptionCoefficient &quot;0.0&quot;</span>
<span class="s2">                        .IntrinsicCarrierDensityModel &quot;none&quot;</span>
<span class="s2">                        .FrqType &quot;all&quot;</span>
<span class="s2">                        .Type &quot;Normal&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Geometry&quot;, &quot;um&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Time&quot;, &quot;s&quot;</span>
<span class="s2">                        .Epsilon &quot;3.8&quot;</span>
<span class="s2">                        .Mu &quot;1&quot;</span>
<span class="s2">                        .Sigma &quot;0&quot;</span>
<span class="s2">                        .TanD &quot;0.0&quot;</span>
<span class="s2">                        .TanDFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDGiven &quot;False&quot;</span>
<span class="s2">                        .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .SetConstTanDStrategyEps &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderEps &quot;3&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqEps &quot;0&quot;</span>
<span class="s2">                        .SetElParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                        .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                        .SigmaM &quot;0&quot;</span>
<span class="s2">                        .TanDM &quot;0.0&quot;</span>
<span class="s2">                        .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDMGiven &quot;False&quot;</span>
<span class="s2">                        .TanDMModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .SetConstTanDStrategyMu &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderMu &quot;3&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqMu &quot;0&quot;</span>
<span class="s2">                        .SetMagParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .DispModelEps  &quot;None&quot;</span>
<span class="s2">                        .DispModelMu &quot;None&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeEps &quot;Nth Order&quot;</span>
<span class="s2">                        .MaximalOrderNthModelFitEps &quot;10&quot;</span>
<span class="s2">                        .ErrorLimitNthModelFitEps &quot;0.1&quot;</span>
<span class="s2">                        .UseOnlyDataInSimFreqRangeNthModelEps &quot;False&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeMu &quot;Nth Order&quot;</span>
<span class="s2">                        .MaximalOrderNthModelFitMu &quot;10&quot;</span>
<span class="s2">                        .ErrorLimitNthModelFitMu &quot;0.1&quot;</span>
<span class="s2">                        .UseOnlyDataInSimFreqRangeNthModelMu &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                        .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                        .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                        .NLADirectionX &quot;1&quot;</span>
<span class="s2">                        .NLADirectionY &quot;0&quot;</span>
<span class="s2">                        .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                        .Colour &quot;0.529&quot;, &quot;0.808&quot;, &quot;0.922&quot; </span>
<span class="s2">                        .Wireframe &quot;False&quot; </span>
<span class="s2">                        .Reflection &quot;False&quot; </span>
<span class="s2">                        .Allowoutline &quot;True&quot; </span>
<span class="s2">                        .Transparentoutline &quot;False&quot; </span>
<span class="s2">                        .Transparency &quot;0&quot; </span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add SiO2 material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.add_Au">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Au">[docs]</a>
    <span class="k">def</span> <span class="nf">add_Au</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add gold to the Material Library</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add Meterial Gold.</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Material</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Name &quot;Au&quot;</span>
<span class="s2">                        .FrqType &quot;static&quot;</span>
<span class="s2">                        .Type &quot;Normal&quot;</span>
<span class="s2">                        .SetMaterialUnit &quot;Hz&quot;, &quot;mm&quot;</span>
<span class="s2">                        .Epsilon &quot;1&quot;</span>
<span class="s2">                        .Mu &quot;1.0&quot;</span>
<span class="s2">                        .Kappa &quot;4.561e+007&quot;</span>
<span class="s2">                        .TanD &quot;0.0&quot;</span>
<span class="s2">                        .TanDFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDGiven &quot;False&quot;</span>
<span class="s2">                        .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .KappaM &quot;0&quot;</span>
<span class="s2">                        .TanDM &quot;0.0&quot;</span>
<span class="s2">                        .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDMGiven &quot;False&quot;</span>
<span class="s2">                        .TanDMModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .DispModelEps &quot;None&quot;</span>
<span class="s2">                        .DispModelMu &quot;None&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeEps &quot;General 1st&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeMu &quot;General 1st&quot;</span>
<span class="s2">                        .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                        .FrqType &quot;all&quot;</span>
<span class="s2">                        .Type &quot;Lossy metal&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Geometry&quot;, &quot;mm&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Time&quot;, &quot;s&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Temperature&quot;, &quot;Kelvin&quot;</span>
<span class="s2">                        .Mu &quot;1.0&quot;</span>
<span class="s2">                        .Sigma &quot;4.561e+007&quot;</span>
<span class="s2">                        .Rho &quot;19320.0&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;314.0&quot;</span>
<span class="s2">                        .SpecificHeat &quot;130&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .MetabolicRate &quot;0&quot;</span>
<span class="s2">                        .BloodFlow &quot;0&quot;</span>
<span class="s2">                        .VoxelConvection &quot;0&quot;</span>
<span class="s2">                        .MechanicsType &quot;Isotropic&quot;</span>
<span class="s2">                        .YoungsModulus &quot;78&quot;</span>
<span class="s2">                        .PoissonsRatio &quot;0.42&quot;</span>
<span class="s2">                        .ThermalExpansionRate &quot;14&quot;</span>
<span class="s2">                        .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                        .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                        .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                        .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                        .NLADirectionX &quot;1&quot;</span>
<span class="s2">                        .NLADirectionY &quot;0&quot;</span>
<span class="s2">                        .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                        .Color &quot;1&quot;,&quot;0.84&quot;, &quot;0&quot;</span>
<span class="s2">                        .Wireframe &quot;False&quot;</span>
<span class="s2">                        .Reflection &quot;False&quot;</span>
<span class="s2">                        .Allowoutline &quot;True&quot;</span>
<span class="s2">                        .Transparentoutline &quot;False&quot;</span>
<span class="s2">                        .Transparency &quot;0&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add Au material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.add_Al">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Al">[docs]</a>
    <span class="k">def</span> <span class="nf">add_Al</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Aluminium to the Material Library</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add Meterial Gold.</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Material</span>
<span class="s2">                            .Reset</span>
<span class="s2">                            .Name &quot;Al&quot;</span>
<span class="s2">                            .Folder &quot;&quot;</span>
<span class="s2">                            .FrqType &quot;static&quot;</span>
<span class="s2">                            .Type &quot;Normal&quot;</span>
<span class="s2">                            .SetMaterialUnit &quot;Hz&quot;, &quot;mm&quot;</span>
<span class="s2">                            .Epsilon &quot;1&quot;</span>
<span class="s2">                            .Mu &quot;1.0&quot;</span>
<span class="s2">                            .Kappa &quot;3.56e+007&quot;</span>
<span class="s2">                            .TanD &quot;0.0&quot;</span>
<span class="s2">                            .TanDFreq &quot;0.0&quot;</span>
<span class="s2">                            .TanDGiven &quot;False&quot;</span>
<span class="s2">                            .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                            .KappaM &quot;0&quot;</span>
<span class="s2">                            .TanDM &quot;0.0&quot;</span>
<span class="s2">                            .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                            .TanDMGiven &quot;False&quot;</span>
<span class="s2">                            .TanDMModel &quot;ConstTanD&quot;</span>
<span class="s2">                            .DispModelEps &quot;None&quot;</span>
<span class="s2">                            .DispModelMu &quot;None&quot;</span>
<span class="s2">                            .DispersiveFittingSchemeEps &quot;General 1st&quot;</span>
<span class="s2">                            .DispersiveFittingSchemeMu &quot;General 1st&quot;</span>
<span class="s2">                            .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                            .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                            .FrqType &quot;all&quot;</span>
<span class="s2">                            .Type &quot;Lossy metal&quot;</span>
<span class="s2">                            .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                            .MaterialUnit &quot;Geometry&quot;, &quot;mm&quot;</span>
<span class="s2">                            .MaterialUnit &quot;Time&quot;, &quot;s&quot;</span>
<span class="s2">                            .MaterialUnit &quot;Temperature&quot;, &quot;Kelvin&quot;</span>
<span class="s2">                            .Mu &quot;1.0&quot;</span>
<span class="s2">                            .Sigma &quot;3.56e+007&quot;</span>
<span class="s2">                            .Rho &quot;2700.0&quot;</span>
<span class="s2">                            .ThermalType &quot;Normal&quot;</span>
<span class="s2">                            .ThermalConductivity &quot;237.0&quot;</span>
<span class="s2">                            .SpecificHeat &quot;900&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                            .MetabolicRate &quot;0&quot;</span>
<span class="s2">                            .BloodFlow &quot;0&quot;</span>
<span class="s2">                            .VoxelConvection &quot;0&quot;</span>
<span class="s2">                            .MechanicsType &quot;Isotropic&quot;</span>
<span class="s2">                            .YoungsModulus &quot;69&quot;</span>
<span class="s2">                            .PoissonsRatio &quot;0.33&quot;</span>
<span class="s2">                            .ThermalExpansionRate &quot;23&quot;</span>
<span class="s2">                            .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                            .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                            .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                            .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                            .NLADirectionX &quot;1&quot;</span>
<span class="s2">                            .NLADirectionY &quot;0&quot;</span>
<span class="s2">                            .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                            .Colour &quot;1&quot;, &quot;1&quot;, &quot;0&quot;</span>
<span class="s2">                            .Colour &quot;0.643&quot;, &quot;0.666&quot;, &quot;0.635&quot; </span>
<span class="s2">                            .Wireframe &quot;False&quot;</span>
<span class="s2">                            .Reflection &quot;False&quot;</span>
<span class="s2">                            .Allowoutline &quot;True&quot;</span>
<span class="s2">                            .Transparentoutline &quot;False&quot;</span>
<span class="s2">                            .Transparency &quot;0&quot;</span>
<span class="s2">                            .Create</span>
<span class="s2">                        End With</span>

<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add Al material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.add_Glue">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_Glue">[docs]</a>
    <span class="k">def</span> <span class="nf">add_Glue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add special glue for the floating shield bond wires according to the KIT model..</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add Material Glue</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                     With Material </span>
<span class="s2">                    .Reset </span>
<span class="s2">                    .Name &quot;DAF_Glue&quot;</span>
<span class="s2">                    .Folder &quot;&quot;</span>
<span class="s2">                    .Rho &quot;0&quot;</span>
<span class="s2">                    .ThermalType &quot;Normal&quot;</span>
<span class="s2">                    .ThermalConductivity &quot;0&quot;</span>
<span class="s2">                    .SpecificHeat &quot;0&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                    .DynamicViscosity &quot;0&quot;</span>
<span class="s2">                    .UseEmissivity &quot;True&quot;</span>
<span class="s2">                    .Emissivity &quot;0&quot;</span>
<span class="s2">                    .MetabolicRate &quot;0.0&quot;</span>
<span class="s2">                    .VoxelConvection &quot;0.0&quot;</span>
<span class="s2">                    .BloodFlow &quot;0&quot;</span>
<span class="s2">                    .Absorptance &quot;0&quot;</span>
<span class="s2">                    .MechanicsType &quot;Unused&quot;</span>
<span class="s2">                    .SolarRadiationAbsorptionType &quot;Opaque&quot;</span>
<span class="s2">                    .Absorptance &quot;0&quot;</span>
<span class="s2">                    .UseSemiTransparencyCalculator &quot;False&quot;</span>
<span class="s2">                    .SolarRadTransmittance &quot;0.0&quot;</span>
<span class="s2">                    .SolarRadReflectance &quot;0.0&quot;</span>
<span class="s2">                    .SolarRadSpecimenThickness &quot;0.0&quot;</span>
<span class="s2">                    .SolarRadRefractiveIndex &quot;1.0&quot;</span>
<span class="s2">                    .SolarRadAbsorptionCoefficient &quot;0.0&quot;</span>
<span class="s2">                    .IntrinsicCarrierDensity &quot;0&quot;</span>
<span class="s2">                    .IntrinsicCarrierDensityModel &quot;none&quot;</span>
<span class="s2">                    .FrqType &quot;all&quot;</span>
<span class="s2">                    .Type &quot;Normal&quot;</span>
<span class="s2">                    .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                    .MaterialUnit &quot;Geometry&quot;, &quot;um&quot;</span>
<span class="s2">                    .MaterialUnit &quot;Time&quot;, &quot;ns&quot;</span>
<span class="s2">                    .MaterialUnit &quot;Temperature&quot;, &quot;degC&quot;</span>
<span class="s2">                    .Epsilon &quot;2.6&quot;</span>
<span class="s2">                    .Mu &quot;1&quot;</span>
<span class="s2">                    .Sigma &quot;0&quot;</span>
<span class="s2">                    .TanD &quot;0.043&quot;</span>
<span class="s2">                    .TanDFreq &quot;100&quot;</span>
<span class="s2">                    .TanDGiven &quot;True&quot;</span>
<span class="s2">                    .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                    .SetConstTanDStrategyEps &quot;AutomaticOrder&quot;</span>
<span class="s2">                    .ConstTanDModelOrderEps &quot;3&quot;</span>
<span class="s2">                    .DjordjevicSarkarUpperFreqEps &quot;0&quot;</span>
<span class="s2">                    .SetElParametricConductivity &quot;False&quot;</span>
<span class="s2">                    .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                    .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                    .SigmaM &quot;0&quot;</span>
<span class="s2">                    .TanDM &quot;0.0&quot;</span>
<span class="s2">                    .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                    .TanDMGiven &quot;False&quot;</span>
<span class="s2">                    .TanDMModel &quot;ConstTanD&quot;</span>
<span class="s2">                    .SetConstTanDStrategyMu &quot;AutomaticOrder&quot;</span>
<span class="s2">                    .ConstTanDModelOrderMu &quot;3&quot;</span>
<span class="s2">                    .DjordjevicSarkarUpperFreqMu &quot;0&quot;</span>
<span class="s2">                    .SetMagParametricConductivity &quot;False&quot;</span>
<span class="s2">                    .DispModelEps  &quot;None&quot;</span>
<span class="s2">                    .DispModelMu &quot;None&quot;</span>
<span class="s2">                    .DispersiveFittingSchemeEps &quot;Nth Order&quot;</span>
<span class="s2">                    .MaximalOrderNthModelFitEps &quot;10&quot;</span>
<span class="s2">                    .ErrorLimitNthModelFitEps &quot;0.1&quot;</span>
<span class="s2">                    .UseOnlyDataInSimFreqRangeNthModelEps &quot;False&quot;</span>
<span class="s2">                    .DispersiveFittingSchemeMu &quot;Nth Order&quot;</span>
<span class="s2">                    .MaximalOrderNthModelFitMu &quot;10&quot;</span>
<span class="s2">                    .ErrorLimitNthModelFitMu &quot;0.1&quot;</span>
<span class="s2">                    .UseOnlyDataInSimFreqRangeNthModelMu &quot;False&quot;</span>
<span class="s2">                    .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                    .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                    .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                    .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                    .NLADirectionX &quot;1&quot;</span>
<span class="s2">                    .NLADirectionY &quot;0&quot;</span>
<span class="s2">                    .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                    .Colour &quot;0&quot;, &quot;1&quot;, &quot;1&quot; </span>
<span class="s2">                    .Wireframe &quot;False&quot; </span>
<span class="s2">                    .Reflection &quot;False&quot; </span>
<span class="s2">                    .Allowoutline &quot;True&quot; </span>
<span class="s2">                    .Transparentoutline &quot;False&quot; </span>
<span class="s2">                    .Transparency &quot;0&quot; </span>
<span class="s2">                    .Create</span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add Glue material&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>


        
        
        
<div class="viewcode-block" id="CST_Commands.add_GGB_Probe_Material">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.add_GGB_Probe_Material">[docs]</a>
    <span class="k">def</span> <span class="nf">add_GGB_Probe_Material</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an materials according to GGB Probes. </span>

<span class="sd">           Returns:</span>
<span class="sd">            str: String with the VBA code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define Probes Materials</span>
        <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Material </span>
<span class="s2">                        .Reset </span>
<span class="s2">                        .Name &quot;Teflon (PTFE) (loss free)&quot; </span>
<span class="s2">                        .Folder &quot;&quot; </span>
<span class="s2">                        .Rho &quot;2200.0&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;0.2&quot;</span>
<span class="s2">                        .SpecificHeat &quot;1000&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .DynamicViscosity &quot;0&quot;</span>
<span class="s2">                        .UseEmissivity &quot;True&quot;</span>
<span class="s2">                        .Emissivity &quot;0&quot;</span>
<span class="s2">                        .MetabolicRate &quot;0.0&quot;</span>
<span class="s2">                        .VoxelConvection &quot;0.0&quot;</span>
<span class="s2">                        .BloodFlow &quot;0&quot;</span>
<span class="s2">                        .Absorptance &quot;0&quot;</span>
<span class="s2">                        .MechanicsType &quot;Isotropic&quot;</span>
<span class="s2">                        .YoungsModulus &quot;0.5&quot;</span>
<span class="s2">                        .PoissonsRatio &quot;0.4&quot;</span>
<span class="s2">                        .ThermalExpansionRate &quot;140&quot;</span>
<span class="s2">                        .IntrinsicCarrierDensity &quot;0&quot;</span>
<span class="s2">                        .FrqType &quot;all&quot;</span>
<span class="s2">                        .Type &quot;Normal&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Geometry&quot;, &quot;mm&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Time&quot;, &quot;s&quot;</span>
<span class="s2">                        .Epsilon &quot;2.1&quot;</span>
<span class="s2">                        .Mu &quot;1.0&quot;</span>
<span class="s2">                        .Sigma &quot;0.0&quot;</span>
<span class="s2">                        .TanD &quot;0.0&quot;</span>
<span class="s2">                        .TanDFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDGiven &quot;False&quot;</span>
<span class="s2">                        .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .SetConstTanDStrategyEps &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderEps &quot;1&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqEps &quot;0&quot;</span>
<span class="s2">                        .SetElParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                        .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                        .SigmaM &quot;0.0&quot;</span>
<span class="s2">                        .TanDM &quot;0.0&quot;</span>
<span class="s2">                        .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDMGiven &quot;False&quot;</span>
<span class="s2">                        .TanDMModel &quot;ConstSigma&quot;</span>
<span class="s2">                        .SetConstTanDStrategyMu &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderMu &quot;1&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqMu &quot;0&quot;</span>
<span class="s2">                        .SetMagParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .DispModelEps  &quot;None&quot;</span>
<span class="s2">                        .DispModelMu &quot;None&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeEps &quot;1st Order&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeMu &quot;1st Order&quot;</span>
<span class="s2">                        .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                        .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                        .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                        .NLADirectionX &quot;1&quot;</span>
<span class="s2">                        .NLADirectionY &quot;0&quot;</span>
<span class="s2">                        .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                        .Colour &quot;0.75&quot;, &quot;0.95&quot;, &quot;0.85&quot; </span>
<span class="s2">                        .Wireframe &quot;False&quot; </span>
<span class="s2">                        .Reflection &quot;False&quot; </span>
<span class="s2">                        .Allowoutline &quot;True&quot; </span>
<span class="s2">                        .Transparentoutline &quot;False&quot; </span>
<span class="s2">                        .Transparency &quot;0&quot; </span>
<span class="s2">                        .Create</span>
<span class="s2">                    End With </span>

<span class="s2">                    With Material </span>
<span class="s2">                        .Reset </span>
<span class="s2">                        .Name &quot;epoxy_casting_CR110&quot; </span>
<span class="s2">                        .Folder &quot;&quot; </span>
<span class="s2">                        .Rho &quot;0&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;0&quot;</span>
<span class="s2">                        .SpecificHeat &quot;0&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .DynamicViscosity &quot;0&quot;</span>
<span class="s2">                        .UseEmissivity &quot;True&quot;</span>
<span class="s2">                        .Emissivity &quot;0&quot;</span>
<span class="s2">                        .MetabolicRate &quot;0&quot;</span>
<span class="s2">                        .VoxelConvection &quot;0&quot;</span>
<span class="s2">                        .BloodFlow &quot;0&quot;</span>
<span class="s2">                        .Absorptance &quot;0&quot;</span>
<span class="s2">                        .MechanicsType &quot;Unused&quot;</span>
<span class="s2">                        .IntrinsicCarrierDensity &quot;0&quot;</span>
<span class="s2">                        .FrqType &quot;all&quot;</span>
<span class="s2">                        .Type &quot;Normal&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Frequency&quot;, &quot;GHz&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Geometry&quot;, &quot;um&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Time&quot;, &quot;ns&quot;</span>
<span class="s2">                        .MaterialUnit &quot;Temperature&quot;, &quot;K&quot;</span>
<span class="s2">                        .Epsilon &quot;2.5&quot;</span>
<span class="s2">                        .Mu &quot;1&quot;</span>
<span class="s2">                        .Sigma &quot;0&quot;</span>
<span class="s2">                        .TanD &quot;0.0&quot;</span>
<span class="s2">                        .TanDFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDGiven &quot;False&quot;</span>
<span class="s2">                        .TanDModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .SetConstTanDStrategyEps &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderEps &quot;1&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqEps &quot;0&quot;</span>
<span class="s2">                        .SetElParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .ReferenceCoordSystem &quot;Global&quot;</span>
<span class="s2">                        .CoordSystemType &quot;Cartesian&quot;</span>
<span class="s2">                        .SigmaM &quot;0&quot;</span>
<span class="s2">                        .TanDM &quot;0.0&quot;</span>
<span class="s2">                        .TanDMFreq &quot;0.0&quot;</span>
<span class="s2">                        .TanDMGiven &quot;False&quot;</span>
<span class="s2">                        .TanDMModel &quot;ConstTanD&quot;</span>
<span class="s2">                        .SetConstTanDStrategyMu &quot;AutomaticOrder&quot;</span>
<span class="s2">                        .ConstTanDModelOrderMu &quot;1&quot;</span>
<span class="s2">                        .DjordjevicSarkarUpperFreqMu &quot;0&quot;</span>
<span class="s2">                        .SetMagParametricConductivity &quot;False&quot;</span>
<span class="s2">                        .DispModelEps  &quot;None&quot;</span>
<span class="s2">                        .DispModelMu &quot;None&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeEps &quot;Nth Order&quot;</span>
<span class="s2">                        .MaximalOrderNthModelFitEps &quot;10&quot;</span>
<span class="s2">                        .ErrorLimitNthModelFitEps &quot;0.1&quot;</span>
<span class="s2">                        .UseOnlyDataInSimFreqRangeNthModelEps &quot;False&quot;</span>
<span class="s2">                        .DispersiveFittingSchemeMu &quot;Nth Order&quot;</span>
<span class="s2">                        .MaximalOrderNthModelFitMu &quot;10&quot;</span>
<span class="s2">                        .ErrorLimitNthModelFitMu &quot;0.1&quot;</span>
<span class="s2">                        .UseOnlyDataInSimFreqRangeNthModelMu &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionEps &quot;False&quot;</span>
<span class="s2">                        .UseGeneralDispersionMu &quot;False&quot;</span>
<span class="s2">                        .NonlinearMeasurementError &quot;1e-1&quot;</span>
<span class="s2">                        .NLAnisotropy &quot;False&quot;</span>
<span class="s2">                        .NLAStackingFactor &quot;1&quot;</span>
<span class="s2">                        .NLADirectionX &quot;1&quot;</span>
<span class="s2">                        .NLADirectionY &quot;0&quot;</span>
<span class="s2">                        .NLADirectionZ &quot;0&quot;</span>
<span class="s2">                        .Colour &quot;0.501961&quot;, &quot;0.501961&quot;, &quot;0&quot; </span>
<span class="s2">                        .Wireframe &quot;False&quot; </span>
<span class="s2">                        .Reflection &quot;False&quot; </span>
<span class="s2">                        .Allowoutline &quot;True&quot; </span>
<span class="s2">                        .Transparentoutline &quot;False&quot; </span>
<span class="s2">                        .Transparency &quot;0&quot; </span>
<span class="s2">                        .Create</span>
<span class="s2">                    End With </span>

<span class="s2">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create Material Teflon (PTFE) (loss free) and epoxy_casting_CR110 for GGB Probe&quot;</span><span class="p">,</span> <span class="n">vba_code1</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.AddGlobalParameter">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.AddGlobalParameter">[docs]</a>
    <span class="k">def</span> <span class="nf">AddGlobalParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add Global parameters to the working enviroment</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with the name and value of the parameter. For Example:</span>
<span class="sd">                            GlobalParam = {}</span>
<span class="sd">                            GlobalParam[&#39;Length&#39;] = 20</span>
<span class="sd">                            This will add Length = 20 to your CSt global enviroments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Parameters Values and Keys</span>
        <span class="n">Param</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">Values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Param</span><span class="p">)):</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StoreParameter &quot;</span><span class="si">{</span><span class="n">Param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, </span><span class="si">{</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># join them with newlines</span>
        <span class="n">line_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">line_block</span><span class="si">}</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;add global parameter&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>



<div class="viewcode-block" id="CST_Commands.DeleteGlobalParameter">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.DeleteGlobalParameter">[docs]</a>
    <span class="k">def</span> <span class="nf">DeleteGlobalParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete an Global parameter from the enviroment.</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (str): Parameter name to be removed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Parameters Values and Keys</span>

        <span class="c1"># Param = list(Parameters.keys())</span>
        <span class="n">Param</span> <span class="o">=</span> <span class="n">Parameters</span>
        <span class="c1"># tmp = []</span>
        <span class="c1"># for i in range(len(Param)):</span>
        <span class="c1">#     tmp.append(f&#39;DeleteParameter &quot;{Param[i]}&quot;&#39;)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DeleteParameter &quot;</span><span class="si">{</span><span class="n">Param</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="c1"># # join them with newlines</span>
        <span class="c1"># line_block = &quot;\n&quot;.join(tmp)</span>
        
        <span class="c1"># vba_code = f&quot;&quot;&quot;</span>
        <span class="c1">#             {line_block}</span>
        <span class="c1">#             &quot;&quot;&quot;</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        </span><span class="si">{</span><span class="n">tmp</span><span class="si">}</span>
<span class="s2">                    &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;delete global parameter&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>



        
<div class="viewcode-block" id="CST_Commands.setBackground">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setBackground">[docs]</a>
    <span class="k">def</span> <span class="nf">setBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the Simulation background.</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dic): Dictionary with coordinates for the background. </span>
<span class="sd">                                Parameters[&quot;Type Background&quot;] = str, Type of the Background. Defoult is &quot;Normal&quot;</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                                Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">            Type (str, optional): Type of background material. Cehck CST for more information. Defaults to Normal.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#Check Background Type</span>
        <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Normal&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Background</span>
<span class="s2">                    .ResetBackground</span>
<span class="s2">                    .Type &quot;</span><span class="si">{</span><span class="n">Type</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Epsilon &quot;1.0&quot;</span>
<span class="s2">                    .Mu &quot;1.0&quot;</span>
<span class="s2">                    .Rho &quot;1.204&quot;</span>
<span class="s2">                    .ThermalType &quot;Normal&quot;</span>
<span class="s2">                    .ThermalConductivity &quot;0&quot;</span>
<span class="s2">                    .SpecificHeat &quot;1005&quot;</span>
<span class="s2">                    .ApplyInAllDirections &quot;False&quot;</span>
<span class="s2">                    .XminSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .XmaxSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .YminSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .YmaxSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .ZminSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .ZmaxSpace &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set background&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>       </div>



<div class="viewcode-block" id="CST_Commands.setBoundary">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setBoundary">[docs]</a>
    <span class="k">def</span> <span class="nf">setBoundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Boundary box Parameters</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Boundary Parameters </span>
<span class="sd">                                Parameters[&quot;Xmin Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Xmax Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Ymin Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Ymax Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Zmin Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Zmax Boundary&quot;] = str </span>
<span class="sd">                                Parameters[&quot;Xsymmetry Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Ysymmetry Boundary&quot;] = str</span>
<span class="sd">                                Parameters[&quot;Zsymmetry Boundary&quot;] = str</span>


<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Boundary parameters</span>
        <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span>
        <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span>
        <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span>
        <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span>
        <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span>
        <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span>
        <span class="n">Xsym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span>
        <span class="n">Ysym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
        <span class="n">Zsym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Boundary</span>
<span class="s2">                    .Xmin &quot;</span><span class="si">{</span><span class="n">Xmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Xmax &quot;</span><span class="si">{</span><span class="n">Xmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Ymin &quot;</span><span class="si">{</span><span class="n">Ymin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Ymax &quot;</span><span class="si">{</span><span class="n">Ymax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Zmin &quot;</span><span class="si">{</span><span class="n">Zmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Zmax &quot;</span><span class="si">{</span><span class="n">Zmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Xsymmetry &quot;</span><span class="si">{</span><span class="n">Xsym</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Ysymmetry &quot;</span><span class="si">{</span><span class="n">Ysym</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Zsymmetry &quot;</span><span class="si">{</span><span class="n">Zsym</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .ApplyInAllDirections &quot;False&quot;</span>
<span class="s2">                    .XPeriodicShift &quot;45.0&quot;</span>
<span class="s2">                    .YPeriodicShift &quot;0.0&quot;</span>
<span class="s2">                    .ZPeriodicShift &quot;0.0&quot;</span>
<span class="s2">                    .PeriodicUseConstantAngles &quot;True&quot;</span>
<span class="s2">                    .SetPeriodicBoundaryAngles &quot;30.0&quot;, &quot;0.0&quot;</span>
<span class="s2">                    .XminPotential &quot;&quot;</span>
<span class="s2">                    .XmaxPotential &quot;&quot;</span>
<span class="s2">                    .YminPotential &quot;&quot;</span>
<span class="s2">                    .YmaxPotential &quot;&quot;</span>
<span class="s2">                    .ZmaxPotential &quot;&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set boundary&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.setSimFreqeuncy">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setSimFreqeuncy">[docs]</a>
    <span class="k">def</span> <span class="nf">setSimFreqeuncy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Simulation Frequency</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Min Frequency&quot;] : Min Frequency of Simulation</span>
<span class="sd">                                Parameters[&quot;Max Frequency&quot;] : Max Frequency of Simulation</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FreqMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Frequency&quot;</span><span class="p">]</span>
        <span class="n">FreqMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Frequency&quot;</span><span class="p">]</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Solver</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .FrequencyRange &quot;</span><span class="si">{</span><span class="n">FreqMin</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">FreqMax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set sim frequency&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>


    


<div class="viewcode-block" id="CST_Commands.setSimWavelength">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setSimWavelength">[docs]</a>
    <span class="k">def</span> <span class="nf">setSimWavelength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Simulation SetSimWavelength</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Min Wavelength&quot;] : Min Wavelength</span>
<span class="sd">                                Parameters[&quot;Max Wavelength&quot;] : Max Wavelength</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WavelengthMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Wavelength&quot;</span><span class="p">]</span>
        <span class="n">WavelengtMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Wavelength&quot;</span><span class="p">]</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Solver</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .WavelengthRange &quot;</span><span class="si">{</span><span class="n">WavelengthMin</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">WavelengtMax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set sim wavelength&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        

   


<span class="c1">############################################################################</span>
<span class="c1"># Building objects</span>
<span class="c1">############################################################################</span>


<div class="viewcode-block" id="CST_Commands.Brick">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Brick">[docs]</a>
    <span class="k">def</span> <span class="nf">Brick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Brick object.</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Brick Lenght Min&quot;] : int/float for min Lenght. It will be center so the lenght that you give will be set to Lenght/2</span>
<span class="sd">                                Parameters[&quot;Brick Lenght Max&quot;] : int/float for Max Lenght. It will be center so the lenght that you give will be set to Lenght/2</span>
<span class="sd">                                Parameters[&quot;Brick Width Min&quot;] : int/float for Min Width. It will be center so the width that you give will be set to Width/2</span>
<span class="sd">                                Parameters[&quot;Brick Width Max&quot;] : int/float for Max Width. It will be center so the width that you give will be set to Width/2</span>
<span class="sd">                                Parameters[&quot;Brick Hight Min&quot;] : int/float for Min Hight. It will be center so the hight that you give will be set to Hight/2</span>
<span class="sd">                                Parameters[&quot;Brick Hight Max&quot;] : int/float for Max Hight. It will be center so the hight that you give will be set to Hight/2</span>
<span class="sd">                                Parameters[&quot;Material&quot;] : str with Materials for the Brick object</span>
<span class="sd">                                Parameters[&quot;Brick Name&quot;] : str with Brick Name</span>
<span class="sd">                                Parameters[&quot;Component Name&quot;] : str with Component Name. The strcuture will be made as &quot;Component Name:Brick Name&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">LenghtMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span>
        <span class="n">LenghtMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span>
        <span class="n">WidthMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span>
        <span class="n">WidthMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span>
        <span class="n">HightMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span>
        <span class="n">HightMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span>
        <span class="n">Component_name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>

        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Material&quot;</span><span class="p">,</span> <span class="s2">&quot;PEC&quot;</span><span class="p">)</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Brick</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Component &quot;</span><span class="si">{</span><span class="n">Component_name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xrange &quot;</span><span class="si">{</span><span class="n">LenghtMin</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">LenghtMax</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Yrange &quot;</span><span class="si">{</span><span class="n">WidthMin</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">WidthMax</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zrange &quot;</span><span class="si">{</span><span class="n">HightMin</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">HightMax</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create brick </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        
        
<div class="viewcode-block" id="CST_Commands.Sphere">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Sphere">[docs]</a>
    <span class="k">def</span> <span class="nf">Sphere</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create Sphere object.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>

<span class="sd">                                Parameters[&quot;Axis&quot;] : str to set an oriantation Axis. Can be &quot;X&quot;, &quot;Y&quot; or &quot;Z&quot;.</span>
<span class="sd">                                Parameters[&quot;Center Radius&quot;] : int/float Radius of the sphere</span>
<span class="sd">                                Parameters[&quot;Top Radius&quot;] : int/float set sphere top radius</span>
<span class="sd">                                Parameters[&quot;Bottom Radius&quot;] : int/float set sphere bottom radius</span>
<span class="sd">                                Parameters[&quot;Center Positions&quot;] : dict with XCenter, YCenter and ZCenter. For example:</span>
<span class="sd">                                                                Positions = {}</span>
<span class="sd">                                                                Positions[&quot;X&quot;] = 2</span>
<span class="sd">                                                                Positions[&quot;Y&quot;] = 2</span>
<span class="sd">                                                                Positions[&quot;Z&quot;] = 2</span>
<span class="sd">                                                                Parameters[&quot;Center Positions&quot;] = Positions</span>
<span class="sd">                                Parameters[&quot;Material&quot;] : str with Materials for the Sphere object</span>
<span class="sd">                                Parameters[&quot;Name&quot;] : str with Sphere Name</span>
<span class="sd">                                Parameters[&quot;Component Name&quot;] : str with Component Name. The strcuture will be made as &quot;Component Name:Name&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
        <span class="n">ComponentName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">Axis</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Axis&quot;</span><span class="p">]</span>
        <span class="n">CentRadius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Radius&quot;</span><span class="p">]</span>
        <span class="n">Centers</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s2">&quot;Top Radius&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">TopRadius</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TopRadius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Top Radius&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;Bottom Radius&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">BotRadius</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BotRadius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bottom Radius&quot;</span><span class="p">]</span>
            
                    
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Sphere </span>
<span class="s2">                     .Reset </span>
<span class="s2">                     .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Component &quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Axis &quot;</span><span class="si">{</span><span class="n">Axis</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .CenterRadius &quot;</span><span class="si">{</span><span class="n">CentRadius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .TopRadius &quot;</span><span class="si">{</span><span class="n">TopRadius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .BottomRadius &quot;</span><span class="si">{</span><span class="n">BotRadius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Center &quot;</span><span class="si">{</span><span class="n">Centers</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Centers</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Centers</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Segments &quot;0&quot; </span>
<span class="s2">                     .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create sphere </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        
        


        

<div class="viewcode-block" id="CST_Commands.Curve">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Curve">[docs]</a>
    <span class="k">def</span> <span class="nf">Curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create 2D Curve in the CST enviroment.</span>
<span class="sd">        </span>
<span class="sd">        Args: Parameters (dict) parameters dict</span>
<span class="sd">                Parameters[&quot;Curve Name&quot;] : (str) Name of the Curves</span>
<span class="sd">                Parameters[&quot;Points&quot;] : (dict) Dictionary of Curve Points. For example. </span>
<span class="sd">                            x = []</span>
<span class="sd">                            y = []</span>
<span class="sd">                            for i in range(0, 100):</span>
<span class="sd">                                x.append(i)</span>
<span class="sd">                                y.append(i*4)</span>
<span class="sd">                            x = np.array(x)</span>
<span class="sd">                            y = np.array(y)</span>
<span class="sd">                            Points[&#39;X&#39;] = x</span>
<span class="sd">                            Points[&#39;Y&#39;] = y</span>
<span class="sd">                            Points[&#39;X&#39;] = CosinusCurve[:,0]</span>
<span class="sd">                            Points[&#39;Y&#39;] = CosinusCurve[:,1]</span>
<span class="sd">                            obj.Curve(&quot;Curve_Python&quot;, Points)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Parameters</span>
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span>
        <span class="n">Points</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Points&quot;</span><span class="p">]</span>

        <span class="c1"># Extract the first points as starting Points</span>
        <span class="n">Start_PointX</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Start_PointY</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.LineTo &quot;</span><span class="si">{</span><span class="n">Points</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">Points</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="c1"># join them with newlines</span>
        <span class="n">line_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Polygon </span>
<span class="s2">                        .Reset </span>
<span class="s2">                        .Name &quot;</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                        .Curve &quot;</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Point &quot;</span><span class="si">{</span><span class="n">Start_PointX</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Start_PointY</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                        </span><span class="si">{</span><span class="n">line_block</span><span class="si">}</span>
<span class="s2">                        .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create curve&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        
        
    
<div class="viewcode-block" id="CST_Commands.Elipse">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Elipse">[docs]</a>
    <span class="k">def</span> <span class="nf">Elipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Elipse object, in Z-orientation in the moment, in CST enviroment. </span>

<span class="sd">            Args:</span>
<span class="sd">                Parameters (dict): Dictionary with Parameters</span>

<span class="sd">                                    Parameters[&quot;Name&quot;] : str Name of the Elipse object</span>
<span class="sd">                                    Parameters[&quot;Curve Name&quot;] : str with Component Name. The strcuture will be made as &quot;Curve Name:Name&quot;</span>
<span class="sd">                                    Parameters[&quot;X Radius&quot;] : int/float radius in X-Direction of the elipse</span>
<span class="sd">                                    Parameters[&quot;Y Radius&quot;] : int/float radius in Y-Direction of the elipse</span>
<span class="sd">                                    Parameters[&quot;X Center&quot;] : int/float position of X-Center</span>
<span class="sd">                                    Parameters[&quot;Y Center&quot;] : int/float position of Y-Center</span>
<span class="sd">                                </span>
<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
        <span class="n">NameCurve</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Ellipse</span>
<span class="s2">                     .Reset </span>
<span class="s2">                     .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Curve &quot;</span><span class="si">{</span><span class="n">NameCurve</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .XRadius &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X Radius&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                     .YRadius &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y Radius&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Xcenter &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X Center&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Ycenter &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y Center&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Segments &quot;0&quot; </span>
<span class="s2">                     .Create</span>
<span class="s2">                End With</span>
<span class="s2">                </span>
<span class="s2">                        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create elipse curve </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        



<div class="viewcode-block" id="CST_Commands.Poligon_2D">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Poligon_2D">[docs]</a>
    <span class="k">def</span> <span class="nf">Poligon_2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the 2D poligon for tRib waveguide</span>
<span class="sd">        Args: Parameters (dict) of parameters fot the function</span>
<span class="sd">                Parameters[&quot;Waveguide Name&quot;] : (str) Name of the poligon</span>
<span class="sd">                Parameters[&quot;Points X&quot;] : (dict) Poligon dictionary wiht X Points</span>
<span class="sd">                Parameters[&quot;Points Y&quot;] : (dict) Poligon dictionary wiht X Points</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">WGName</span>  <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span>
        <span class="n">Points_X</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Points X&quot;</span><span class="p">]</span>
        <span class="n">Points_Y</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Points Y&quot;</span><span class="p">]</span>

    
        <span class="c1"># Extract the first points as starting Points</span>
        <span class="n">Start_PointX</span> <span class="o">=</span> <span class="n">Points_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Start_PointY</span> <span class="o">=</span> <span class="n">Points_Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Points_X</span><span class="p">)):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.LineTo &quot;</span><span class="si">{</span><span class="n">Points_X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">Points_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="c1"># join them with newlines</span>
        <span class="n">line_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Polygon</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">WGName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Curve &quot;</span><span class="si">{</span><span class="n">WGName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Point &quot;</span><span class="si">{</span><span class="n">Start_PointX</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Start_PointY</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">line_block</span><span class="si">}</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;2d polygon&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>  </div>

            



<div class="viewcode-block" id="CST_Commands.Poligon_3D">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Poligon_3D">[docs]</a>
    <span class="k">def</span> <span class="nf">Poligon_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the 2D poligon for tRib waveguide</span>

<span class="sd">        Args:</span>
<span class="sd">            WGName (str): Name of the poligon</span>
<span class="sd">            Points (dict): Dictionary with the Points:</span>
<span class="sd">                            Points[&#39;X&#39;] = []</span>
<span class="sd">                            Points[&#39;Y&#39;] = []</span>
<span class="sd">                            Points[&#39;Z&#39;] = []   </span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> 
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> 
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">][</span><span class="s2">&quot;X&quot;</span><span class="p">])):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.Point &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">][</span><span class="s2">&quot;X&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">][</span><span class="s2">&quot;Y&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">][</span><span class="s2">&quot;Z&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="c1"># join them with newlines</span>
        <span class="n">line_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Polygon3D</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Curve &quot;</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">line_block</span><span class="si">}</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3d polygon </span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span> </div>





    
    <span class="c1"># MZM Design</span>
<div class="viewcode-block" id="CST_Commands.MZM">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.MZM">[docs]</a>
    <span class="k">def</span> <span class="nf">MZM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an MZM Modulator. Materials used:</span>
<span class="sd">                                                Gold - For the electrodes</span>
<span class="sd">                                                LiNbO3 - For Optical Waveguides</span>
<span class="sd">                                                SiO2 - For Substrate</span>
<span class="sd">                Args:</span>
<span class="sd">                    Parameters (dict): Dictionary with all the needed values</span>
<span class="sd">                    Parameters[&quot;Lenght_Electrodes&quot;] : Length of the Electrodes. The Waveguides will be 2 (Units) longer then the electrodes.</span>
<span class="sd">                    Parameters[&quot;Width GND&quot;] : Width of the GND electrodes</span>
<span class="sd">                    Parameters[&quot;Width Signal&quot;] : Width of the Signal Electrode</span>
<span class="sd">                    Parameters[&quot;Width WG&quot;] : Top wWidth of the optical waveguide. It is an Rib waveguide</span>
<span class="sd">                    Parameters[&quot;Gap&quot;] : Gap between Signal and optical Waveguide</span>
<span class="sd">                    Parameters[&quot;angle&quot;] : Angle of the side wall of the optical waveguide</span>
<span class="sd">                    Parameters[&quot;High Electrodes&quot;] : Hight of the Electodes</span>
<span class="sd">                    Parameters[&quot;High WG&quot;] : Hight of the optical Waveguide</span>
<span class="sd">                    Parameters[&quot;High Slab&quot;] : Hight of the Slab. When choosen &quot;0&quot; no Slab will be implemented. </span>
<span class="sd">                    Parameters[&quot;High Substrate&quot;] : Hight of the substrate</span>

<span class="sd">                Returns:</span>
<span class="sd">                    str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Length_MZM</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes Lenght&quot;</span><span class="p">]</span>
        <span class="n">Length_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes Lenght&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">Width_Electrodes</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width GND&quot;</span><span class="p">]</span>
        <span class="n">Width_Signal</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width Signal&quot;</span><span class="p">]</span>
        <span class="n">Width_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width WG&quot;</span><span class="p">]</span>
        <span class="n">Gap</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Gap&quot;</span><span class="p">]</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;angle&quot;</span><span class="p">]</span>
        <span class="n">Height_Electrodes</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Electrodes&quot;</span><span class="p">]</span>
        <span class="n">Height_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High WG&quot;</span><span class="p">]</span>
        <span class="n">Heigh_Slab</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Slab&quot;</span><span class="p">]</span>
        <span class="n">Height_Substrate</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Substrate&quot;</span><span class="p">]</span>

    


        <span class="c1"># Set optical Material Properties Eps X,Y,Z</span>
        <span class="n">Data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.584095</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">add_anisotropy_material</span><span class="p">(</span><span class="s2">&quot;LiNbO3&quot;</span><span class="p">,</span> <span class="n">Data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>


        <span class="c1"># Calculate Top and Bottom Widths of the Waveguide</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Height_WG</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">Angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)))</span>  <span class="c1"># in Radians</span>
        <span class="n">extention</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">Width_WG_New</span> <span class="o">=</span> <span class="n">Width_WG</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">extention</span> 

        <span class="c1"># Global Parameters</span>
        <span class="n">WidthObject</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Width_Signal</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Gap</span>


        <span class="c1"># Substrate Definition </span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SiO2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
     



        <span class="c1"># Slab definition</span>
        <span class="k">if</span> <span class="n">Heigh_Slab</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LiNbO3&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>

            
        <span class="c1"># Calculate Top and Bottom Widths of the Waveguide</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Height_WG</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">Angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)))</span>  <span class="c1"># in Radians</span>
        <span class="n">extention</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">Width_WG_New</span> <span class="o">=</span> <span class="n">Width_WG</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">extention</span> 

        <span class="c1">#  Electrodes </span>
        <span class="n">NamesElectrodes</span> <span class="o">=</span> <span class="s2">&quot;Electrode_Left&quot;</span><span class="p">,</span> <span class="s2">&quot;Electrode_Right&quot;</span><span class="p">,</span> <span class="s2">&quot;Signal&quot;</span>

        <span class="c1"># Plase Electrodes</span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Height_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
        


        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Gap</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Gap</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Signal</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Height_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>



        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Width_Electrodes</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Height_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>

        

        <span class="c1"># Plase Waveguides</span>
        <span class="n">GND_Left_Corner</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gap</span> <span class="o">+</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">GND_Right_Corner</span> <span class="o">=</span> <span class="p">(</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Width_Electrodes</span><span class="p">)</span> <span class="o">-</span> <span class="n">Gap</span> <span class="o">-</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span>

        <span class="n">PosLeft</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">((</span><span class="n">GND_Left_Corner</span>  <span class="o">+</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">((</span><span class="n">GND_Left_Corner</span>  <span class="o">-</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">PosRight</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">((</span><span class="n">GND_Right_Corner</span> <span class="o">-</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">((</span><span class="n">GND_Right_Corner</span> <span class="o">+</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>


        <span class="c1"># New Waveguide Placement with 2D Polygon and Translation </span>
        <span class="n">PointsLeft</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosLeft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>


        <span class="c1"># Waveguide and Waveguide to </span>
        <span class="c1"># Translation Parameters</span>

        <span class="c1"># self.Poligon_2D(WGName = &quot;Waveguide_Left&quot;, Points = PointsLeft)</span>
        <span class="n">Parameters_2D</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsLeft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_2D</span><span class="p">(</span><span class="n">Parameters_2D</span><span class="p">)</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s1">&#39;Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ShapeCenter&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HeightZ</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Hight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Angle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>  <span class="o">=</span><span class="s2">&quot;LiNbO3&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Folder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RibWaveguide_ToSolid</span><span class="p">(</span><span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">)</span>
        


        <span class="n">PointsRight</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">PointsRight</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">PointsRight</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PosRight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosRight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosRight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosRight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosRight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        

        <span class="c1"># Waveguide and Waveguide to solid</span>
        <span class="n">Parameters_2D</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsRight</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsRight</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_2D</span><span class="p">(</span><span class="n">Parameters_2D</span><span class="p">)</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s1">&#39;Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ShapeCenter&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HeightZ</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Hight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Angle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>  <span class="o">=</span><span class="s2">&quot;LiNbO3&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Folder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Right&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RibWaveguide_ToSolid</span><span class="p">(</span><span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">)</span></div>

        <span class="c1"># self.RibWaveguide_ToSolid(&quot;Waveguide_Right&quot;, WaveguideName = &quot;Waveguide_Right&quot;, WG_Hight = -Length_WG, Angle = 0, WGFolderName = &quot;Waveguide_Right&quot;, WGName = &quot;Waveguide_Right&quot;, Material=&quot;LiNbO3&quot;)</span>





    <span class="c1"># Phase Modulator Design</span>
<div class="viewcode-block" id="CST_Commands.PhaseModulator">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.PhaseModulator">[docs]</a>
    <span class="k">def</span> <span class="nf">PhaseModulator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Phase Modulator. Materials used:</span>
<span class="sd">                                                Gold - For the electrodes</span>
<span class="sd">                                                LiNbO3 - For Optical Waveguides</span>
<span class="sd">                                                SiO2 - For Substrate</span>
<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with all the needed values</span>
<span class="sd">                    Parameters[&quot;Lenght_Electrodes&quot;] : Length of the Electrodes. The Waveguides will be 2 (Units) longer then the electrodes.</span>
<span class="sd">                    Parameters[&quot;Width GND&quot;] : Width of the GND electrodes</span>
<span class="sd">                    Parameters[&quot;Width Signal&quot;] : Width of the Signal Electrode</span>
<span class="sd">                    Parameters[&quot;Width WG&quot;] : Top wWidth of the optical waveguide. It is an Rib waveguide</span>
<span class="sd">                    Parameters[&quot;Gap&quot;] : Gap between Signal and optical Waveguide</span>
<span class="sd">                    Parameters[&quot;angle&quot;] : Angle of the side wall of the optical waveguide</span>
<span class="sd">                    Parameters[&quot;High Electrodes&quot;] : Hight of the Electodes</span>
<span class="sd">                    Parameters[&quot;High WG&quot;] : Hight of the optical Waveguide</span>
<span class="sd">                    Parameters[&quot;High Slab&quot;] : Hight of the Slab. When choosen &quot;0&quot; no Slab will be implemented. </span>
<span class="sd">                    Parameters[&quot;High Substrate&quot;] : Hight of the substrate</span>
<span class="sd">        Returns:</span>
<span class="sd">                    str: String with VBA Code </span>
<span class="sd">                    </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Length_MZM</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes Lenght&quot;</span><span class="p">]</span>
        <span class="n">Length_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes Lenght&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">Width_Electrodes</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width GND&quot;</span><span class="p">]</span>
        <span class="n">Width_Signal</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width Signal&quot;</span><span class="p">]</span>
        <span class="n">Width_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width WG&quot;</span><span class="p">]</span>
        <span class="n">Gap</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Gap&quot;</span><span class="p">]</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;angle&quot;</span><span class="p">]</span>
        <span class="n">Height_Electrodes</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Electrodes&quot;</span><span class="p">]</span>
        <span class="n">Height_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High WG&quot;</span><span class="p">]</span>
        <span class="n">Heigh_Slab</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Slab&quot;</span><span class="p">]</span>
        <span class="n">Height_Substrate</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;High Substrate&quot;</span><span class="p">]</span>


        <span class="c1"># Set optical Material Properties Eps X,Y,Z</span>
        <span class="n">Data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.584095</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_anisotropy_material</span><span class="p">(</span><span class="s2">&quot;LiNbO3&quot;</span><span class="p">,</span> <span class="n">Data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>


        <span class="c1"># Calculate Top and Bottom Widths of the Waveguide</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Height_WG</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">Angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)))</span>  <span class="c1"># in Radians</span>
        <span class="n">extention</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">Width_WG_New</span> <span class="o">=</span> <span class="n">Width_WG</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">extention</span> 

        <span class="c1"># Global Parameters</span>
        <span class="n">WidthObject</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Width_Signal</span> <span class="o">+</span> <span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Gap</span>


        <span class="c1"># Substrate Definition </span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">WidthObject</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">WidthObject</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SiO2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>




        <span class="c1"># Slab definition</span>
        <span class="k">if</span> <span class="n">Heigh_Slab</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">WidthObject</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">WidthObject</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LiNbO3&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>

            
        <span class="c1"># Calculate Top and Bottom Widths of the Waveguide</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Height_WG</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">Angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)))</span>  <span class="c1"># in Radians</span>
        <span class="n">extention</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">Width_WG_New</span> <span class="o">=</span> <span class="n">Width_WG</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">extention</span> 

        <span class="c1">#  Electrodes </span>
        <span class="n">NamesElectrodes</span> <span class="o">=</span> <span class="s2">&quot;Electrode&quot;</span><span class="p">,</span> <span class="s2">&quot;Signal&quot;</span>

        <span class="c1"># Plase Electrodes</span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_MZM</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_MZM</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Height_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>


        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_MZM</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_MZM</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Gap</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span> <span class="o">+</span> <span class="n">Width_WG_New</span> <span class="o">+</span> <span class="n">Gap</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Signal</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Height_Electrodes</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NamesElectrodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>


        <span class="c1"># Plase Waveguides</span>
        <span class="n">GND_Left_Corner</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Width_Electrodes</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gap</span> <span class="o">+</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span>
        
        <span class="n">PosLeft</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">((</span><span class="n">GND_Left_Corner</span>  <span class="o">+</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">((</span><span class="n">GND_Left_Corner</span>  <span class="o">-</span> <span class="n">Width_WG_New</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span> 
    

        <span class="c1"># New Waveguide Placement with 2D Polygon and Translation </span>
        <span class="n">PointsLeft</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Height_WG</span><span class="p">,</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosLeft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="nb">round</span><span class="p">((</span><span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">extention</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">PosLeft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># Waveguide and Waveguide to </span>
        <span class="c1"># Translation Parameters</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span>

        <span class="n">Parameters_2D</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">Parameters_2D</span><span class="p">[</span><span class="s2">&quot;Points Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PointsLeft</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_2D</span><span class="p">(</span><span class="n">Parameters_2D</span><span class="p">)</span>

        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s1">&#39;Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ShapeCenter&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        <span class="n">Trans</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HeightZ</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Height_WG</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Trans</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Curve&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Trans</span><span class="p">)</span>
        
        <span class="n">Parameters_RibWaveguide_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Hight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Angle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>  <span class="o">=</span><span class="s2">&quot;LiNbO3&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Folder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Waveguide_Left&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RibWaveguide_ToSolid</span><span class="p">(</span><span class="n">Parameters_RibWaveguide_toSolid</span><span class="p">)</span></div>

     


<div class="viewcode-block" id="CST_Commands.Squere_Waveguide">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Squere_Waveguide">[docs]</a>
    <span class="k">def</span> <span class="nf">Squere_Waveguide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function generate and simple straight waveguide. Materials used:</span>
<span class="sd">                                                Gold - For the electrodes</span>
<span class="sd">                                                LiNbO3 - For Optical Waveguides</span>
<span class="sd">                                                SiO2 - For Substrate</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with all the needed values</span>
<span class="sd">                    Parameters[&quot;Lenght WG&quot;] : Length of the Waveguide.</span>
<span class="sd">                    Parameters[&quot;High_WG&quot;] : Hight of the optical Waveguide</span>
<span class="sd">                    Parameters[&quot;Width WG&quot;] : : Top Width of the optical waveguide. It is an Rib waveguide.</span>
<span class="sd">                    Parameters[&quot;Substrate Height&quot;] : Hight of the substrate.</span>
<span class="sd">                    Parameters[&quot;Slab Heigh&quot;] : Hight of the Slab. When choosen &quot;0&quot; no Slab will be implemented. </span>

<span class="sd">        Returns:</span>
<span class="sd">                    str: String with VBA Code </span>
<span class="sd">                    </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Length_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Lenght WG&quot;</span><span class="p">]</span>
        <span class="n">Hight_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Hight WG&quot;</span><span class="p">]</span>
        <span class="n">Width_WG</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Width WG&quot;</span><span class="p">]</span>
        <span class="n">Height_Substrate</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Substrate Height&quot;</span><span class="p">]</span>
        <span class="n">Heigh_Slab</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Slab Heigh&quot;</span><span class="p">]</span>
        <span class="c1"># Material = Parameters[&quot;Materials&quot;]</span>



        <span class="c1"># Set optical Material Properties Eps X,Y,Z</span>
        <span class="n">Data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.584095</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.906</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_anisotropy_material</span><span class="p">(</span><span class="s2">&quot;LiNbO3&quot;</span><span class="p">,</span> <span class="n">Data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>

        

        <span class="c1"># Global Parameters for the WG</span>
        <span class="n">WidthObject</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">Width_WG</span> 
    

        <span class="c1"># Substrate Definition </span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Substrate&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SiO2&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>



        <span class="c1"># Slab definition</span>
        <span class="k">if</span> <span class="n">Heigh_Slab</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WidthObject</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LNOI_Slab&quot;</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LiNbO3&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
            <span class="n">HeightZ</span> <span class="o">=</span> <span class="n">Height_Substrate</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Heigh_Slab</span>
        
        <span class="c1"># Create squere Waveguide</span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Length_WG</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Width_WG</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Width_WG</span><span class="o">/</span><span class="mi">2</span> 
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HeightZ</span> <span class="o">+</span> <span class="n">Hight_WG</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;WG&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;WG&quot;</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LiNbO3&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.GSG_Bondwire_ChipToChip_connection">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GSG_Bondwire_ChipToChip_connection">[docs]</a>
    <span class="k">def</span> <span class="nf">GSG_Bondwire_ChipToChip_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function generate and two Chips connected by bondwires setup</span>
<span class="sd">        The Setup is taken from IHP the Bondpads are from Aluminiam the </span>
<span class="sd">        bondwires are also from Aluminium. The Glue and floating shield over the </span>
<span class="sd">        bondwires was taken from KIT Paper setup. This setup is for GSG Pads.</span>
<span class="sd">        This Function have the Option to import the GGP GSg probes. </span>
<span class="sd">        Materials:</span>
<span class="sd">                    Gold - Floating Shield</span>
<span class="sd">                    DAF Glue - For the glue between the bondwires</span>
<span class="sd">                    Al - For bondwires and bondpads</span>
<span class="sd">                    SiO2 - Layer under the bondpads on the boths chips</span>
<span class="sd">                    Si - Substrate Layer below the SiO2</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with all the needed values</span>
<span class="sd">                    Parameters[&quot;PAD Width GND&quot;]  : GND Bondpads width</span>
<span class="sd">                    Parameters[&quot;PAD Width Signal&quot;] : Signal Bondpads width</span>
<span class="sd">                    Parameters[&quot;PAD Length&quot;] : Signal and GND bondpads lenght</span>
<span class="sd">                    Parameters[&quot;PAD Thickness&quot;] : Signal and GND bondpads thickness</span>
<span class="sd">                    Parameters[&quot;PADs Distance&quot;] : Distance from first chip bondpads to the secound chip bondpads</span>
<span class="sd">                    Parameters[&quot;Bonwire height&quot;] : Bondwire hight in the middle point</span>
<span class="sd">                    Parameters[&quot;Bonwire radius&quot;] : Bondwire ridius</span>
<span class="sd">                    Parameters[&quot;Floating Shield&quot;] : (boolen) Set an floating shield with glue as dielectricum to improve the Bandwidth of the Bondwires connections.</span>
<span class="sd">                    If set True you need to set Parameters[&quot;Floating Shield Thickness&quot;] and Parameters[&quot;Glue Thickness&quot;] too!</span>
<span class="sd">                    Parameters[&quot;Glue Thickness&quot;] : (int/float) DAF glue thickness: measured from the SiO layer of the first chip upward to the SiO layer of the second chip</span>
<span class="sd">                    Parameters[&quot;Floating Shield Thickness&quot;] : (int/float) Floating shield gold metal thickness</span>
<span class="sd">                    Parameters[&quot;Accuracy&quot;] : FDTD Solver Accuracy. Can be :</span>
<span class="sd">                                                                            80 dB</span>
<span class="sd">                                                                            60 dB</span>
<span class="sd">                                                                            50 dB</span>
<span class="sd">                                                                            40 dB</span>
<span class="sd">                                                                            35 dB</span>
<span class="sd">                                                                            30 dB</span>
<span class="sd">                                                                            25 dB</span>
<span class="sd">                                                                            20 dB</span>
<span class="sd">                                                                            &#39;no check&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">                    str: String with VBA Code </span>
<span class="sd">                    </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Define Curves Parameters and Data</span>
        <span class="n">Lenght</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">Offset</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="n">points</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># Generate the Bezier and Cos points</span>
        <span class="n">ObjCurves</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">(</span><span class="n">Lenght</span><span class="p">,</span> <span class="n">Offset</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
        <span class="n">CosinusCurve</span> <span class="o">=</span> <span class="n">ObjCurves</span><span class="o">.</span><span class="n">Cosinus_Curve</span><span class="p">()</span>
 

        <span class="c1"># Import Materials into CST enviroment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Al</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Glue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Si</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>

        <span class="n">PAD_Width</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Width GND&quot;</span><span class="p">]</span> 
        <span class="n">SIG_PAD_Width</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Width Signal&quot;</span><span class="p">]</span> 
        <span class="n">PAD_Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Length&quot;</span><span class="p">]</span>
        <span class="n">PAD_Thickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Thickness&quot;</span><span class="p">]</span>
        <span class="n">Component_Name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_input&quot;</span><span class="p">,</span> <span class="s2">&quot;_output&quot;</span><span class="p">]</span>
        <span class="n">Names_Chips</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Chip_L&quot;</span><span class="p">,</span> <span class="s2">&quot;Chip_R&quot;</span><span class="p">]</span>
        <span class="n">PAD_Dist_given</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PADs Distance&quot;</span><span class="p">]</span>
        <span class="n">PAD_Dist</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="n">PAD_Dist_given</span> <span class="o">-</span> <span class="n">PAD_Length</span><span class="p">,</span> <span class="n">PAD_Dist_given</span> <span class="o">+</span> <span class="n">PAD_Length</span><span class="p">]</span>
        <span class="n">Bondwire_Height</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bonwire height&quot;</span><span class="p">]</span>
        <span class="n">Bondwire_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bonwire radius&quot;</span><span class="p">]</span>
        <span class="n">SpanY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Y Span&quot;</span><span class="p">]</span>
        <span class="n">SpanZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Z Span&quot;</span><span class="p">]</span>
        <span class="n">Facet_Number</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="n">Solver_Accuracy</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span> 
        <span class="n">Solver_Impedance_Status</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">Solver_Impedance_Value</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">Solver_Source_Port</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
        <span class="n">Solver_Mesh_Type</span> <span class="o">=</span> <span class="s2">&quot;TLM&quot;</span>
        <span class="n">Solver_Calc_Modes</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">Probes</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Probes&quot;</span><span class="p">]</span>

    
        <span class="c1"># Set Chip Distance from Pad to pad and the spacing</span>
        <span class="c1"># this will set the Chip width too</span>
        <span class="n">Dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>


        <span class="c1"># Create Pads Loop</span>
        <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Material_Pads</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GND_L&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Component_Name</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;GND&quot;</span><span class="p">:</span>
                    <span class="c1"># Create squere Electrodes </span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span> <span class="o">*</span> <span class="mi">2</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Pads</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Create squere Electrodes </span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">SIG_PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SIG_PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span> <span class="o">*</span> <span class="mi">2</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Pads</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>
        

        <span class="c1"># Create two Chips Left and Right Loop </span>
        <span class="n">Material_Substrate</span> <span class="o">=</span> <span class="s2">&quot;Si&quot;</span>
        <span class="n">Material_iso</span> <span class="o">=</span> <span class="s2">&quot;SiO2&quot;</span>
        <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Names_Chips</span><span class="p">)):</span>
            <span class="c1"># Create SiO2 Layer</span>
            <span class="c1"># Parameters[&quot;Brick Lenght Max&quot;] = PAD_Dist[1] + PAD_Length</span>
            <span class="c1"># Parameters[&quot;Brick Lenght Min&quot;] = PAD_Dist[0] - PAD_Length</span>
            <span class="k">if</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> <span class="o">-</span> <span class="mi">50</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> <span class="o">+</span> <span class="mi">50</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.92</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SiO2_Layer&quot;</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Chips</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_iso</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>

            <span class="c1"># Create Substrate</span>
            <span class="c1"># Parameters[&quot;Brick Lenght Max&quot;] = PAD_Dist[1] + PAD_Length</span>
            <span class="c1"># Parameters[&quot;Brick Lenght Min&quot;] = PAD_Dist[0] - PAD_Length</span>
            <span class="k">if</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> <span class="o">-</span> <span class="mi">50</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> <span class="o">+</span> <span class="mi">50</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.92</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">298.86</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Substrate_Chip&quot;</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Chips</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Substrate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>

        <span class="c1"># Create GND PADS Bondwires</span>
        <span class="n">Names_Wires</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Wire_L_GND_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_L_GND_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_R_GND_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_R_GND_2&quot;</span><span class="p">]</span>
        <span class="n">Dist2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dist2</span><span class="p">)):</span>

            <span class="n">Parameters_Bondwire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>

            <span class="n">ParametersWire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters_Bondwire</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Height</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Radius</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Bondwire Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Spline&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Center Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;extended&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BondWire</span><span class="p">(</span><span class="n">ParametersWire</span><span class="p">)</span>
     

            <span class="n">Parameters_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="s2">&quot;Al&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ToSolid</span><span class="p">(</span><span class="n">Parameters_toSolid</span><span class="p">)</span>
   
        
        <span class="c1"># Create Signal PADS Bondwires</span>
        <span class="n">Names_Wires</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Wire_Sig&quot;</span><span class="p">]</span>
        <span class="n">Dist2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>


        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dist2</span><span class="p">)):</span>
            <span class="n">Parameters_Bondwire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>

            <span class="n">ParametersWire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters_Bondwire</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Height</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Radius</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Bondwire Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Spline&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Center Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;extended&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BondWire</span><span class="p">(</span><span class="n">ParametersWire</span><span class="p">)</span>
     

            <span class="n">Parameters_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="s2">&quot;Al&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ToSolid</span><span class="p">(</span><span class="n">Parameters_toSolid</span><span class="p">)</span>

        <span class="c1"># Create Top Plate for Bond Wires and cladding</span>
         <span class="c1"># Create Top Plate for Bond Wires and cladding</span>
        <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Floating Shield&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

            <span class="c1"># Set glue thickness and floating shield thickness</span>
            <span class="n">Glue_Thickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Glue Thickness&quot;</span><span class="p">]</span>
            <span class="n">FloatingShieldThickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Floating Shield Thickness&quot;</span><span class="p">]</span>
            <span class="c1"># PAD_Thickness = 2.8</span>
            <span class="n">Name_Shield</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield&quot;</span>
            <span class="n">Component_Name</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield&quot;</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
            <span class="n">Material_Clad</span> <span class="o">=</span> <span class="s2">&quot;DAF_Glue&quot;</span>


            <span class="c1"># Create cladding</span>
            <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Brick_Parameters[&quot;Brick Hight Min&quot;] = PAD_Thickness*2 </span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield_Clad&quot;</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Component_Name</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Clad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>



            <span class="c1"># Create squere floating shield</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">FloatingShieldThickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="c1"># Brick_Parameters[&quot;Brick Hight Max&quot;] = PAD_Thickness*2 + Glue_Thickness*2 + FloatingShieldThickness*2</span>
            <span class="c1"># Brick_Parameters[&quot;Brick Hight Min&quot;] = PAD_Thickness*2 + Glue_Thickness*2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name_Shield</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Component_Name</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">Probes</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># Pick Faces for Input Waveguide Port 1</span>
            <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Facer_input</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="n">Facer_input</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_input&quot;</span><span class="p">)</span>

            <span class="c1"># pick input faces</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facer_input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>

            <span class="c1"># Create Port Input</span>
            <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Picks&quot;</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Positive&quot;</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">SpanY</span><span class="p">,</span> <span class="n">SpanZ</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Number of picks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;GND_L:GND_L_input&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig:Sig_input&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R:GND_R_input&quot;</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>



            <span class="c1"># Pick Faces for Input Waveguide Port 2</span>
            <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Facer_output</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="n">Facer_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_output&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facer_output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>

            <span class="c1">#Create Port Output</span>
            <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Picks&quot;</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Positive&quot;</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">SpanY</span><span class="p">,</span> <span class="n">SpanZ</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Number of picks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;GND_L:GND_L_output&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig:Sig_output&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R:GND_R_output&quot;</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>


        <span class="k">elif</span> <span class="n">Probes</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

            <span class="c1"># create_GGB_Probe()</span>
            <span class="n">Parameters_Probes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Probes</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Probe_Left&quot;</span>
            <span class="n">Parameters_Probes</span><span class="p">[</span><span class="s2">&quot;Orientation Angle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
            <span class="n">Parameters_Probes</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GGB_L&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GGB_Probe</span><span class="p">(</span><span class="n">Parameters_Probes</span><span class="p">)</span>

            <span class="c1"># Move Probes Left</span>
            <span class="n">Parameters_Probes_Move</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Probe_Left&quot;</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position X&quot;] = PAD_Dist[0] - PAD_Length/2 + 20</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position Y&quot;] = 0</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position Z&quot;] = PAD_Thickness/2</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PAD_Thickness</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Parameters_Probes_Move</span><span class="p">)</span>
            


            <span class="c1"># create_GGB_Probe()</span>
            <span class="n">Parameters_Probes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Probes</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Probe_Right&quot;</span>
            <span class="n">Parameters_Probes</span><span class="p">[</span><span class="s2">&quot;Orientation Angle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GGB_Probe</span><span class="p">(</span><span class="n">Parameters_Probes</span><span class="p">)</span>

            <span class="c1"># Move Probes Right</span>
            <span class="n">Parameters_Probes_Move</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Probe_Right&quot;</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position X&quot;] = PAD_Dist[1] + PAD_Length/2 - 20</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position Y&quot;] = 0</span>
            <span class="c1"># Parameters_Probes_Move[&quot;Position Z&quot;] = PAD_Thickness/2</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PAD_Thickness</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">Parameters_Probes_Move</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">Parameters_Probes_Move</span><span class="p">)</span>


        <span class="c1"># Set FDTD Time domain solver </span>
        <span class="n">Parameters_Solver</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Accuracy</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Auto Impedance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Impedance_Status</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Impedance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Impedance_Value</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Source Port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Source_Port</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Solver Mesh Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Mesh_Type</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Caclculate Modes Only&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Calc_Modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTimeSolver</span><span class="p">(</span><span class="n">Parameters_Solver</span><span class="p">)</span></div>






<div class="viewcode-block" id="CST_Commands.GSGSG_Bondwire_ChipToChip_connection">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GSGSG_Bondwire_ChipToChip_connection">[docs]</a>
    <span class="k">def</span> <span class="nf">GSGSG_Bondwire_ChipToChip_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function generate and two Chips connected by bondwires setup</span>
<span class="sd">        The Setup is taken from IHP the Bondpads are from Aluminiam the </span>
<span class="sd">        bondwires are also from Aluminium. The Glue and floating shield over the </span>
<span class="sd">        bondwires was taken from KIT Paper setup. This setup is for GSGSG Pads.</span>
<span class="sd">        Materials:</span>
<span class="sd">                    Gold - Floating Shield</span>
<span class="sd">                    DAF Glue - For the glue between the bondwires</span>
<span class="sd">                    Al - For bondwires and bondpads</span>
<span class="sd">                    SiO2 - Layer under the bondpads on the boths chips</span>
<span class="sd">                    Si - Substrate Layer below the SiO2</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with all the needed values</span>
<span class="sd">                    Parameters[&quot;PAD Width GND&quot;]  : GND Bondpads width</span>
<span class="sd">                    Parameters[&quot;PAD Width Signal&quot;] : Signal Bondpads width</span>
<span class="sd">                    Parameters[&quot;PAD Length&quot;] : Signal and GND bondpads lenght</span>
<span class="sd">                    Parameters[&quot;PAD Thickness&quot;] : Signal and GND bondpads thickness</span>
<span class="sd">                    Parameters[&quot;PADs Distance&quot;] : Distance from first chip bondpads to the secound chip bondpads</span>
<span class="sd">                    Parameters[&quot;Bonwire height&quot;] : Bondwire hight in the middle point</span>
<span class="sd">                    Parameters[&quot;Bonwire radius&quot;] : Bondwire ridius</span>
<span class="sd">                    Parameters[&quot;Floating Shield&quot;] : (boolen) Set an floating shield with glue as dielectricum to improve the Bandwidth of the Bondwires connections.</span>
<span class="sd">                    If set True you need to set Parameters[&quot;Floating Shield Thickness&quot;] and Parameters[&quot;Glue Thickness&quot;] too!</span>
<span class="sd">                    Parameters[&quot;Glue Thickness&quot;] : (int/float) DAF glue thickness: measured from the SiO layer of the first chip upward to the SiO layer of the second chip</span>
<span class="sd">                    Parameters[&quot;Floating Shield Thickness&quot;] : (int/float) Floating shield gold metal thickness</span>
<span class="sd">                    Parameters[&quot;Accuracy&quot;] : FDTD Solver Accuracy. Can be :</span>
<span class="sd">                                                                            80 dB</span>
<span class="sd">                                                                            60 dB</span>
<span class="sd">                                                                            50 dB</span>
<span class="sd">                                                                            40 dB</span>
<span class="sd">                                                                            35 dB</span>
<span class="sd">                                                                            30 dB</span>
<span class="sd">                                                                            25 dB</span>
<span class="sd">                                                                            20 dB</span>
<span class="sd">                                                                            &#39;no check&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">                    str: String with VBA Code </span>
<span class="sd">                    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define Curves Parameters and Data</span>
        <span class="n">Lenght</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">Offset</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="n">points</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># Generate the Bezier and Cos points</span>
        <span class="n">ObjCurves</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">(</span><span class="n">Lenght</span><span class="p">,</span> <span class="n">Offset</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
        <span class="n">CosinusCurve</span> <span class="o">=</span> <span class="n">ObjCurves</span><span class="o">.</span><span class="n">Cosinus_Curve</span><span class="p">()</span>
 

        <span class="c1"># Import Materials into CST enviroment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Al</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Au</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Glue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_Si</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_SiO2</span><span class="p">()</span>

        <span class="n">PAD_Width</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Width GND&quot;</span><span class="p">]</span> 
        <span class="n">SIG_PAD_Width</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Width Signal&quot;</span><span class="p">]</span> 
        <span class="n">PAD_Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Length&quot;</span><span class="p">]</span>
        <span class="n">PAD_Thickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PAD Thickness&quot;</span><span class="p">]</span>
        <span class="n">Component_Name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_input&quot;</span><span class="p">,</span> <span class="s2">&quot;_output&quot;</span><span class="p">]</span>
        <span class="n">Names_Chips</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Chip_L&quot;</span><span class="p">,</span> <span class="s2">&quot;Chip_R&quot;</span><span class="p">]</span>
        <span class="n">PAD_Dist_given</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;PADs Distance&quot;</span><span class="p">]</span>
        <span class="n">PAD_Dist</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="n">PAD_Dist_given</span> <span class="o">-</span> <span class="n">PAD_Length</span><span class="p">,</span> <span class="n">PAD_Dist_given</span> <span class="o">+</span> <span class="n">PAD_Length</span><span class="p">]</span>
        <span class="n">Bondwire_Height</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bonwire height&quot;</span><span class="p">]</span>
        <span class="n">Bondwire_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bonwire radius&quot;</span><span class="p">]</span>
        
        <span class="n">SpanY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Y Span&quot;</span><span class="p">]</span>
        <span class="n">SpanZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Z Span&quot;</span><span class="p">]</span>
        
        <span class="n">Facet_Number</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
        <span class="n">Solver_Accuracy</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span> 
        <span class="n">Solver_Impedance_Status</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">Solver_Impedance_Value</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">Solver_Source_Port</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
        <span class="n">Solver_Mesh_Type</span> <span class="o">=</span> <span class="s2">&quot;TLM&quot;</span>
        <span class="n">Solver_Calc_Modes</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Set Chip Distance from Pad to pad and the spacing</span>
        <span class="c1"># this will set the Chip width too</span>
        <span class="n">Dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>


        <span class="c1"># Create Pads Loop</span>
        <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Material_Pads</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GND_L&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_L&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_Mid&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_R&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Component_Name</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;GND&quot;</span><span class="p">:</span>
                    <span class="c1"># Create squere Electrodes </span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span> <span class="o">*</span> <span class="mi">2</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Pads</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Create squere Electrodes </span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">SIG_PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">SIG_PAD_Width</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span> <span class="o">*</span> <span class="mi">2</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
                    <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Pads</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>




        <span class="c1"># Create two Chips Left and Right Loop </span>
        <span class="n">Material_Substrate</span> <span class="o">=</span> <span class="s2">&quot;Si&quot;</span>
        <span class="n">Material_iso</span> <span class="o">=</span> <span class="s2">&quot;SiO2&quot;</span>
        <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Names_Chips</span><span class="p">)):</span>
            <span class="c1"># Create SiO2 Layer</span>
            <span class="k">if</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> <span class="o">-</span> <span class="mi">50</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> <span class="o">+</span> <span class="mi">50</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.92</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SiO2_Layer&quot;</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Chips</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_iso</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>

            <span class="c1"># Create Substrate</span>
            <span class="k">if</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> <span class="o">-</span> <span class="mi">50</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">PAD_Length</span> 
                <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">PAD_Length</span> <span class="o">+</span> <span class="mi">50</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">3</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.92</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">298.86</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Substrate_Chip&quot;</span> <span class="o">+</span> <span class="n">Component_Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Chips</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Substrate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>



        <span class="c1"># Create GND PADS Bondwires</span>
        <span class="n">Names_Wires</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Wire_L_GND_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_L_GND_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_Mid_GND_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_Mid_GND_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_R_GND_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_R_GND_2&quot;</span><span class="p">]</span>
        <span class="n">Dist2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="o">-</span><span class="mi">175</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dist2</span><span class="p">)):</span>

            <span class="n">Parameters_Bondwire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>


            <span class="n">ParametersWire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters_Bondwire</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Height</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Radius</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Bondwire Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Spline&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Center Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;extended&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BondWire</span><span class="p">(</span><span class="n">ParametersWire</span><span class="p">)</span>
            
            <span class="n">Parameters_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="s2">&quot;Al&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ToSolid</span><span class="p">(</span><span class="n">Parameters_toSolid</span><span class="p">)</span>
            

        
        <span class="c1"># Create Signal PADS Bondwires</span>
        <span class="n">Names_Wires</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Wire_L_Sig&quot;</span><span class="p">,</span> <span class="s2">&quot;Wire_R_Sig&quot;</span><span class="p">]</span>
        <span class="n">Dist2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>


        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dist2</span><span class="p">)):</span>
            <span class="n">Parameters_Bondwire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;X2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> 
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Y2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dist2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_Bondwire</span><span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Thickness</span>

            
            <span class="n">ParametersWire</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters_Bondwire</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Height</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bondwire_Radius</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Bondwire Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Spline&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Center Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;extended&quot;</span>
            <span class="n">ParametersWire</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BondWire</span><span class="p">(</span><span class="n">ParametersWire</span><span class="p">)</span>

            <span class="n">Parameters_toSolid</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Names_Wires</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_BondWire&quot;</span>
            <span class="n">Parameters_toSolid</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="s2">&quot;Al&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ToSolid</span><span class="p">(</span><span class="n">Parameters_toSolid</span><span class="p">)</span>
    


        

        <span class="c1"># Create Top Plate for Bond Wires and cladding</span>
        <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Floating Shield&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

            <span class="c1"># Set glue thickness and floating shield thickness</span>
            <span class="n">Glue_Thickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Glue Thickness&quot;</span><span class="p">]</span>
            <span class="n">FloatingShieldThickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Floating Shield Thickness&quot;</span><span class="p">]</span>

            <span class="c1"># PAD_Thickness = 2.8</span>
            <span class="n">Name_Shield</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield&quot;</span>
            <span class="n">Component_Name</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield&quot;</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
            <span class="n">Material_Clad</span> <span class="o">=</span> <span class="s2">&quot;DAF_Glue&quot;</span>


            <span class="c1"># Create cladding</span>
            <span class="n">Brick_Parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Floating_Shield_Clad&quot;</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Component_Name</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material_Clad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>



            <span class="c1"># Create squere floating shield</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAD_Dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">PAD_Length</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">+</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dist</span><span class="p">)</span> <span class="o">-</span> <span class="n">PAD_Width</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">FloatingShieldThickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="p">(</span><span class="n">PAD_Thickness</span> <span class="o">+</span> <span class="n">Bondwire_Height</span> <span class="o">+</span> <span class="n">Bondwire_Radius</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Glue_Thickness</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name_Shield</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Component_Name</span>
            <span class="n">Brick_Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">Brick_Parameters</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">pass</span>


        
        <span class="c1"># Pick Faces for Input Waveguide Port 1</span>
        <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Facer_input</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
            <span class="n">Facer_input</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_input&quot;</span><span class="p">)</span>

        <span class="c1"># pick input faces</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facer_input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>

        <span class="c1"># Create Port Input</span>
        <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Picks&quot;</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Positive&quot;</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">SpanY</span><span class="p">,</span> <span class="n">SpanZ</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Number of picks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;GND_L:GND_L_input&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_L:Sig_L_input&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_Mid:GND_Mid_input&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_Mid:GND_Mid_input&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_R:Sig_R_input&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R:GND_R_input&quot;</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>



        <span class="c1"># Pick Faces for Input Waveguide Port 2</span>
        <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Facer_output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
            <span class="n">Facer_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">Name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_output&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">)):</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Facer_output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>

        <span class="c1">#Create Port Output</span>
        <span class="n">Parameters_Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Picks&quot;</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Positive&quot;</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">SpanY</span><span class="p">,</span> <span class="n">SpanZ</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Number of picks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Port Polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Picked Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;GND_L:GND_L_output&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_L:Sig_L_output&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_Mid:GND_Mid_output&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_Mid:GND_Mid_output&quot;</span><span class="p">,</span> <span class="s2">&quot;Sig_R:Sig_R_output&quot;</span><span class="p">,</span> <span class="s2">&quot;GND_R:GND_R_output&quot;</span><span class="p">]</span>
        <span class="n">Parameters_Port</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Facet_Number</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters_Port</span><span class="p">)</span>


        <span class="c1"># Set FDTD Time domain solver </span>
        
        <span class="c1"># Set Time Solver</span>
        <span class="n">Parameters_Solver</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Accuracy</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Auto Impedance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Impedance_Status</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Impedance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Impedance_Value</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Source Port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Source_Port</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Solver Mesh Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Mesh_Type</span>
        <span class="n">Parameters_Solver</span><span class="p">[</span><span class="s2">&quot;Caclculate Modes Only&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Solver_Calc_Modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTimeSolver</span><span class="p">(</span><span class="n">Parameters_Solver</span><span class="p">)</span></div>





    <span class="c1"># def BondWire(self, NameWire, Coordinates, Height, Radius, BondwireType = &quot;Spline&quot;, CenterPosition = 0.5, alpha = None, beta = None, Material = None, SolidWireModel = True, Termination = None, NameFolder = None):</span>
<div class="viewcode-block" id="CST_Commands.BondWire">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.BondWire">[docs]</a>
    <span class="k">def</span> <span class="nf">BondWire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Bond Wire.</span>

<span class="sd">        Args: Parameters (dict) with parameters</span>
<span class="sd">                Parameters[&quot;Name Wire&quot;] : (str): Name of the Bondwire</span>
<span class="sd">                Parameters[&quot;Coordinates&quot;] : (dict) Dictionary with Coordinates in X,Y,Z plane to create the Bondwire:  </span>
<span class="sd">                                For Example </span>
<span class="sd">                                    Parameters = {}</span>
<span class="sd">                                    Parameters[&#39;X1&#39;] = 0</span>
<span class="sd">                                    Parameters[&#39;Y1&#39;] = 0</span>
<span class="sd">                                    Parameters[&#39;Z1&#39;] = 0</span>
<span class="sd">                                    Parameters[&#39;X2&#39;] = 5</span>
<span class="sd">                                    Parameters[&#39;Y2&#39;] = 5</span>
<span class="sd">                                    Parameters[&#39;Z2&#39;] = 0</span>
<span class="sd">                Parameters[&quot;Height&quot;] : (int/float) Hight of the middle point of the Bondwire</span>
<span class="sd">                Parameters[&quot;Radius&quot;] : (int/float) Radius of the bond wire. Bond wire is an cylinder type of object.</span>
<span class="sd">                Parameters[&quot;Bondwire Type&quot;] : (str, optional) The type of bond wire. Defaults to &quot;Spline&quot;. Other inputs are:</span>
<span class="sd">                                                &quot;Spline&quot; </span>
<span class="sd">                                                &quot;JEDEC4&quot;</span>
<span class="sd">                                                &quot;JEDEC5&quot;</span>
<span class="sd">                Parameters[&quot;Center Position&quot;] : (int/float) The center Position of the Height. This can be moved to make </span>
<span class="sd">                                            an object that dont have the top height in the middle. Defaults to 0.5.</span>
<span class="sd">                Parameters[&quot;alpha&quot;] : (int/float, optional) When using &quot;JEDEC5&quot; an alpha parameter need to be defined. See CST documentation!! Defaults to None.</span>
<span class="sd">                Parameters[&quot;beta&quot;] : (int/float, optional) When using &quot;JEDEC5&quot; an betta parameter need to be defined. See CST documentation!!. Defaults to None.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                    in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                    will not be found. Defaults to &quot;PCE&quot;.</span>
<span class="sd">                Parameters[&quot;SolidWireModel&quot;] : (bool, optional) This option will turn the bondiwre into solid object. Defaults to True.</span>
<span class="sd">                Parameters[&quot;Termination&quot;] : (str, optional) How the Bondwire will be temrinated. Defaults to None. Options are:</span>
<span class="sd">                                            &quot;natural&quot; </span>
<span class="sd">                                            &quot;rounded&quot; </span>
<span class="sd">                                            &quot;extended&quot;</span>
<span class="sd">                Parameters[&quot;NameFolder&quot;] : (str, optional) The name of the folder. Defaults to name of the wire.</span>
<span class="sd">            </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Parameters</span>
        <span class="n">NameWire</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span>
        <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span> 
        <span class="n">Height</span> <span class="o">=</span>  <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span>
        <span class="n">Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span>
        <span class="n">BondwireType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bondwire Type&quot;</span><span class="p">]</span>
        <span class="n">CenterPosition</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Position&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">SolidWireModel</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span>
        <span class="n">Termination</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span>

        <span class="c1"># Check the BondwireType</span>
        <span class="k">if</span> <span class="n">BondwireType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Spline&quot;</span><span class="p">,</span> <span class="s2">&quot;JEDEC4&quot;</span><span class="p">,</span> <span class="s2">&quot;JEDEC5&quot;</span><span class="p">]:</span>
            <span class="n">BondwireType</span> <span class="o">=</span> <span class="n">BondwireType</span>
            <span class="k">if</span> <span class="n">BondwireType</span> <span class="o">==</span> <span class="s2">&quot;JEDEC5&quot;</span><span class="p">:</span>
                <span class="n">alpha</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">beta</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">&#39;When using &quot;JEDEC5&quot; an alpha and betta parameters need to be defined. See CST documentation!! &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;BondwireType can be on of [&#39;Spline&#39;, &#39;JEDEC4&#39;, &#39;JEDEC5&#39;]&quot;</span><span class="p">)</span>


        <span class="c1"># Material Def</span>
        <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;PCE&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>


        <span class="c1"># Check Termination</span>
        <span class="k">if</span> <span class="n">Termination</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Termination</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;natural&quot;</span> <span class="p">,</span> <span class="s2">&quot;rounded&quot;</span> <span class="p">,</span> <span class="s2">&quot;extended&quot;</span><span class="p">]:</span>
                <span class="n">Termination</span> <span class="o">=</span> <span class="n">Termination</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Termination can be only one of [&quot;natural&quot; , &quot;rounded&quot; , &quot;extended&quot;]&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Termination</span> <span class="o">=</span> <span class="s2">&quot;natural&quot;</span>

        <span class="c1"># Folder Name</span>
        <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameWire</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>


        <span class="k">if</span> <span class="n">BondwireType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Spline&quot;</span><span class="p">,</span> <span class="s2">&quot;JEDEC4&quot;</span><span class="p">]:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Wire</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Folder &quot;</span><span class="si">{</span><span class="n">NameFolder</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Type &quot;Bondwire&quot;</span>
<span class="s2">                        .Name &quot;</span><span class="si">{</span><span class="n">NameWire</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .BondWireType &quot;</span><span class="si">{</span><span class="n">BondwireType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Point1 &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;False&quot;</span>
<span class="s2">                        .Point2 &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;False&quot;</span>
<span class="s2">                        .Height &quot;</span><span class="si">{</span><span class="n">Height</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Radius &quot;</span><span class="si">{</span><span class="n">Radius</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .RelativeCenterPosition &quot;</span><span class="si">{</span><span class="n">CenterPosition</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SolidWireModel &quot;</span><span class="si">{</span><span class="n">SolidWireModel</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Termination &quot;</span><span class="si">{</span><span class="n">Termination</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Add</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create bondwire </span><span class="si">{</span><span class="n">NameWire</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
            

        <span class="k">else</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Wire</span>
<span class="s2">                    .Reset</span>
<span class="s2">                        .Folder &quot;</span><span class="si">{</span><span class="n">NameFolder</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Type &quot;Bondwire&quot;</span>
<span class="s2">                        .Name &quot;</span><span class="si">{</span><span class="n">NameWire</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .BondWireType &quot;</span><span class="si">{</span><span class="n">BondwireType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Point1 &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;False&quot;</span>
<span class="s2">                        .Point2 &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;False&quot;</span>
<span class="s2">                        .Height &quot;</span><span class="si">{</span><span class="n">Height</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Radius &quot;</span><span class="si">{</span><span class="n">Radius</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .alpha &quot;</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .beta &quot;</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SolidWireModel &quot;</span><span class="si">{</span><span class="n">SolidWireModel</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Termination &quot;</span><span class="si">{</span><span class="n">Termination</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Add</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create bondwire </span><span class="si">{</span><span class="n">NameWire</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




    <span class="c1"># def CurveWire(self, NameWire, Radius, Points = None, Material = None, SolidWireModel = True, Termination = None, NameFolder = None, CurveFolderName = None, CurveName = None):</span>
<div class="viewcode-block" id="CST_Commands.CurveWire">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CurveWire">[docs]</a>
    <span class="k">def</span> <span class="nf">CurveWire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create curve wire based coordinates parameters points </span>

<span class="sd">        Args: Parameters (dict) Dictionary with parameters needed for the function.</span>
<span class="sd">                Parameters[&quot;Name Wire&quot;] : (str) Name of the wire</span>
<span class="sd">                Parameters[&quot;Radius&quot;] : (int/float) Radius of the curve</span>
<span class="sd">                Parameters[&quot;Points&quot;] : (dict, optional) Dictionary of X and  Y points for the curve. Defaults to None.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                    in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                    will not be found. Defaults to &quot;PCE&quot;.</span>
<span class="sd">                Parameters[&quot;SolidWireModel&quot;] : (bool, optional) This option will turn the Curve Wire into solid object. Defaults to True.</span>
<span class="sd">                Parameters[&quot;Termination&quot;] : (str, optional) How the Bondwire will be temrinated. Defaults to None. Options are:</span>
<span class="sd">                                            &quot;natural&quot; </span>
<span class="sd">                                            &quot;rounded&quot; </span>
<span class="sd">                                            &quot;extended&quot;</span>
<span class="sd">                Parameters[&quot;NameFolder&quot;] : (str, optional) The name of the bondwire folder. Defaults to name of the wire.</span>
<span class="sd">                Parameters[&quot;CurveFolderName&quot;] : (str, optional) Name of the Curve folder name. Defaults to None.</span>
<span class="sd">                Parameters[&quot;CurveName&quot;] : (str, optional) Curve name. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Parameters</span>
        <span class="n">NameWire</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Wire&quot;</span><span class="p">]</span>
        <span class="n">Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">]</span>
        <span class="n">Points</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Points&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> 
        <span class="n">SolidWireModel</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;SolidWireModel&quot;</span><span class="p">]</span>
        <span class="n">Parameters</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Termination&quot;</span><span class="p">]</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;NameFolder&quot;</span><span class="p">]</span> 
        <span class="n">CurveFolderName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;CurveFolderName&quot;</span><span class="p">]</span>
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;CurveName&quot;</span><span class="p">]</span>
        <span class="c1"># Check of Dict of Points for X and Y are given</span>
        <span class="k">if</span> <span class="n">Points</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;To create an Curve you need an Dictionary with two Variable &quot;X&quot; and &quot;Y&quot;. The Values for Dict[&quot;X&quot;] can be an array of points&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>


        <span class="c1"># Folder Name</span>
        <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameWire</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>


        <span class="c1"># Check Termination</span>
        <span class="k">if</span> <span class="n">Termination</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Termination</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;natural&quot;</span><span class="p">,</span> <span class="s2">&quot;rounded&quot;</span><span class="p">,</span> <span class="s2">&quot;extended&quot;</span><span class="p">]:</span>
                <span class="n">Termination</span> <span class="o">=</span> <span class="n">Termination</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Termination can be only one of [&quot;natural&quot; , &quot;rounded&quot; , &quot;extended&quot;]&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Termination</span> <span class="o">=</span> <span class="s2">&quot;natural&quot;</span>

        <span class="c1"># Material Def</span>
        <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;PCE&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>

        <span class="c1"># Check if Curve Name and Folder Name are given</span>
        <span class="k">if</span> <span class="n">CurveFolderName</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">CurveName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;To create an Curve Wire you need to give the Curve Folder Name (CurveFolderName) and the Curve Name (CurveName) that you already gave!&quot;</span><span class="p">)</span>


        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Wire</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Folder &quot;</span><span class="si">{</span><span class="n">NameFolder</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Type &quot;Curvewire&quot;</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">NameWire</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Curve &quot;</span><span class="si">{</span><span class="n">CurveFolderName</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Radius &quot;</span><span class="si">{</span><span class="n">Radius</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .SolidWireModel &quot;</span><span class="si">{</span><span class="n">SolidWireModel</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Termination &quot;</span><span class="si">{</span><span class="n">Termination</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Add</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create curve wire&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.Cylinder">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Cylinder">[docs]</a>
    <span class="k">def</span> <span class="nf">Cylinder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Cylinder object in CST enviroment.</span>
<span class="sd">        </span>
<span class="sd">            Args: Parameters (dict) Dictionary with parameters needed for the function.</span>
<span class="sd">                Parameters[&quot;Cylinder Name&quot;] : (str) Name of the cylinder</span>
<span class="sd">                Parameters[&quot;Component Name&quot;] : (str) Name of the cylinder component in the component tree.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                    in your simulation and then use this function.</span>
<span class="sd">                Parameters[&quot;Outer Radius&quot;] : (int/float) Cylinder outer radius.</span>
<span class="sd">                Parameters[&quot;Inner Radius&quot;] : (int/float) Cylinder inner radius.                </span>
<span class="sd">                Parameters[&quot;Orentation Axis&quot;] : (str) Cylunder Orientation axis can be &quot;X&quot;, &quot;Y&quot; or &quot;Z&quot;.</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;X&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;X min&quot;] : (int/float) X min parameter</span>
<span class="sd">                    Parameters[&quot;X max&quot;] : (int/float) X max parameter</span>
<span class="sd">                    Parameters[&quot;Z center&quot;] : (int/float) Z center parameter</span>
<span class="sd">                    Parameters[&quot;Y center&quot;] : (int/float) Y center parameter</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;Y&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;Y min&quot;] : (int/float) Y min parameter</span>
<span class="sd">                    Parameters[&quot;Y max&quot;] : (int/float) Y max parameter</span>
<span class="sd">                    Parameters[&quot;Z center&quot;] : (int/float) Z center parameter</span>
<span class="sd">                    Parameters[&quot;X center&quot;] : (int/float) X center parameter</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;Z&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;Z min&quot;] : (int/float) Z min parameter</span>
<span class="sd">                    Parameters[&quot;Z max&quot;] : (int/float) Z max parameter</span>
<span class="sd">                    Parameters[&quot;X center&quot;] : (int/float) X center parameter</span>
<span class="sd">                    Parameters[&quot;Y center&quot;] : (int/float) Y center parameter</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span>
        <span class="n">Component_name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">Outer_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span>
        <span class="n">Inner_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span>
        <span class="n">Orentation_Axis</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span>
        
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Cylinder </span>
<span class="s2">                    .Reset </span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Component &quot;</span><span class="si">{</span><span class="n">Component_name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .OuterRadius &quot;</span><span class="si">{</span><span class="n">Outer_Radius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .InnerRadius &quot;</span><span class="si">{</span><span class="n">Inner_Radius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Axis &quot;</span><span class="si">{</span><span class="n">Orentation_Axis</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="n">X_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X min&quot;</span><span class="p">]</span>
            <span class="n">X_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X max&quot;</span><span class="p">]</span>
            <span class="n">Zcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z center&quot;</span><span class="p">]</span>
            <span class="n">Ycenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    .Xrange &quot;</span><span class="si">{</span><span class="n">X_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">X_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Zcenter &quot;</span><span class="si">{</span><span class="n">Zcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Ycenter &quot;</span><span class="si">{</span><span class="n">Ycenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>

        <span class="k">elif</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">Y_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y min&quot;</span><span class="p">]</span>
            <span class="n">Y_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y max&quot;</span><span class="p">]</span>
            <span class="n">Zcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z center&quot;</span><span class="p">]</span>
            <span class="n">Xcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    .Yrange &quot;</span><span class="si">{</span><span class="n">Y_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Y_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Zcenter &quot;</span><span class="si">{</span><span class="n">Zcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Xcenter &quot;</span><span class="si">{</span><span class="n">Xcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>
        <span class="k">elif</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="n">Z_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span>
            <span class="n">Z_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span>
            <span class="n">Xcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span>
            <span class="n">Ycenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    .Zrange &quot;</span><span class="si">{</span><span class="n">Z_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Z_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Xcenter &quot;</span><span class="si">{</span><span class="n">Xcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Ycenter &quot;</span><span class="si">{</span><span class="n">Ycenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Orentation Axis can be only X, Y and Z!&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create cylinder&quot;</span><span class="p">,</span> <span class="n">full_vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.Conus">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Conus">[docs]</a>
    <span class="k">def</span> <span class="nf">Conus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Conus object in CST enviroment.</span>
<span class="sd">                </span>
<span class="sd">            Args: Parameters (dict) Dictionary with parameters needed for the function.</span>
<span class="sd">                Parameters[&quot;Conus Name&quot;] : (str) Name of the conus.</span>
<span class="sd">                Parameters[&quot;Component Name&quot;] : (str) Name of the conus component in the component tree.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                    in your simulation and then use this function.</span>
<span class="sd">                Parameters[&quot;Top Radius&quot;] : (int/float) conus top radius.</span>
<span class="sd">                Parameters[&quot;Bottom Radius&quot;] : (int/float) Conus bottom radius.                </span>
<span class="sd">                Parameters[&quot;Orentation Axis&quot;] : (str) Conus Orientation axis can be &quot;X&quot;, &quot;Y&quot; or &quot;Z&quot;.</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;X&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;X min&quot;] : (int/float) X min parameter</span>
<span class="sd">                    Parameters[&quot;X max&quot;] : (int/float) X max parameter</span>
<span class="sd">                    Parameters[&quot;Z center&quot;] : (int/float) Z center parameter</span>
<span class="sd">                    Parameters[&quot;Y center&quot;] : (int/float) Y center parameter</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;Y&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;Y min&quot;] : (int/float) Y min parameter</span>
<span class="sd">                    Parameters[&quot;Y max&quot;] : (int/float) Y max parameter</span>
<span class="sd">                    Parameters[&quot;Z center&quot;] : (int/float) Z center parameter</span>
<span class="sd">                    Parameters[&quot;X center&quot;] : (int/float) X center parameter</span>
<span class="sd">                If Parameters[&quot;Orentation Axis&quot;] = &quot;Z&quot; then the following parameters are needed :</span>
<span class="sd">                    Parameters[&quot;Z min&quot;] : (int/float) Z min parameter</span>
<span class="sd">                    Parameters[&quot;Z max&quot;] : (int/float) Z max parameter</span>
<span class="sd">                    Parameters[&quot;X center&quot;] : (int/float) X center parameter</span>
<span class="sd">                    Parameters[&quot;Y center&quot;] : (int/float) Y center parameter</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>
<span class="sd">            ValueError: Error massage</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Conus Name&quot;</span><span class="p">]</span>
        <span class="n">Component_name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">Outer_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Top Radius&quot;</span><span class="p">]</span>
        <span class="n">Inner_Radius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Bottom Radius&quot;</span><span class="p">]</span>
        <span class="n">Orentation_Axis</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Cone </span>
<span class="s2">                     .Reset </span>
<span class="s2">                     .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Component &quot;</span><span class="si">{</span><span class="n">Component_name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .TopRadius &quot;</span><span class="si">{</span><span class="n">Outer_Radius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .BottomRadius &quot;</span><span class="si">{</span><span class="n">Inner_Radius</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                     .Axis &quot;</span><span class="si">{</span><span class="n">Orentation_Axis</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                     &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="n">X_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X min&quot;</span><span class="p">]</span>
            <span class="n">X_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X max&quot;</span><span class="p">]</span>
            <span class="n">Zcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z center&quot;</span><span class="p">]</span>
            <span class="n">Ycenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    </span>
<span class="s2">                    .Xrange &quot;</span><span class="si">{</span><span class="n">X_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">X_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Zcenter &quot;</span><span class="si">{</span><span class="n">Zcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Ycenter &quot;</span><span class="si">{</span><span class="n">Ycenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>

        <span class="k">elif</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">Y_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y min&quot;</span><span class="p">]</span>
            <span class="n">Y_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y max&quot;</span><span class="p">]</span>
            <span class="n">Zcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z center&quot;</span><span class="p">]</span>
            <span class="n">Xcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    .Yrange &quot;</span><span class="si">{</span><span class="n">Y_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Y_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Zcenter &quot;</span><span class="si">{</span><span class="n">Zcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Xcenter &quot;</span><span class="si">{</span><span class="n">Xcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>
            
        <span class="k">elif</span> <span class="n">Orentation_Axis</span> <span class="o">==</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="n">Z_min</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span>
            <span class="n">Z_max</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span>
            <span class="n">Xcenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span>
            <span class="n">Ycenter</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span>
            <span class="n">vba_code1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    .Zrange &quot;</span><span class="si">{</span><span class="n">Z_min</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Z_max</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Xcenter &quot;</span><span class="si">{</span><span class="n">Xcenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Ycenter &quot;</span><span class="si">{</span><span class="n">Ycenter</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                    .Segments &quot;0&quot; </span>
<span class="s2">                    .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="n">full_vba_code</span> <span class="o">=</span> <span class="n">vba_code</span> <span class="o">+</span> <span class="n">vba_code1</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create cylinder&quot;</span><span class="p">,</span> <span class="n">full_vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.GGB_Probe">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.GGB_Probe">[docs]</a>
    <span class="k">def</span> <span class="nf">GGB_Probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create GGB Probes in CSt enviroment.</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with parameters needed for the structure.</span>
<span class="sd">                Parameters[&quot;Component Name&quot;] : (str) Name of the Component</span>
<span class="sd">                Parameters[&quot;Orientation Angle&quot;] : (int/float) angle of tilting the GGB Probes</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="c1"># Global Parameters</span>
        <span class="n">ComponentName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>
        <span class="n">angleOrientation</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orientation Angle&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_GGB_Probe_Material</span><span class="p">()</span>
       
        <span class="c1"># Create GGB Probes Body Cylinder</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Body_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">290</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">170</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Create GGB Probes Signal Cylinder</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Signal_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Create GGB Probes Isolation Cylinder</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Isolation_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Teflon (PTFE) (loss free)&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">170</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        
        <span class="c1"># Create Signal Conus</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Conus Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Conus_Probe_Sig&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Top Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Bottom Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">51.91</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">197.30</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Conus</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        

        <span class="c1"># Create Signal Conus Tip</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Conus Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Conus_Probe_Sig_Tip&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Top Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">51.91</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Bottom Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.31</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">197.30</span> <span class="o">-</span> <span class="mf">45.10</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">197.30</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Conus</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Create Ground forms Left</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">Points</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">105</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">185</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_3D</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Porbe_GND_L_Tip&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CurveToSolid</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Translate to right </span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_L_Tip&quot;</span>
        <span class="c1"># DictComponent[&quot;Position X&quot;] = 25/2</span>
        <span class="c1"># DictComponent[&quot;Position Y&quot;] = -186.1</span>
        <span class="c1"># DictComponent[&quot;Position Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">186.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># DictComponent[&quot;Structure Type&quot;] = &quot;Shape&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        
        
        <span class="c1">#  Create Ground forms Right</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">Points</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">130</span><span class="p">,</span> <span class="o">-</span><span class="mi">85</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">185</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_3D</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Porbe_GND_R_Tip&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CurveToSolid</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Translate to right 180 degree</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_R_Tip&quot;</span>
        <span class="c1"># DictComponent[&quot;Position X&quot;] = -25/2</span>
        <span class="c1"># DictComponent[&quot;Position Y&quot;] = 186.1</span>
        <span class="c1"># DictComponent[&quot;Position Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">186.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># DictComponent[&quot;Structure Type&quot;] = &quot;Shape&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Create Sphere</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Elipse&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="s2">&quot;epoxy_casting_CR110&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">Pos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Pos</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Pos</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Pos</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pos</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1">#Transform Sphere to Elipse </span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Scale&quot;</span> 
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Elipse&quot;</span> 
        <span class="c1"># Pos = {}</span>
        <span class="c1"># Pos[&quot;X&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Y&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Scale = {}</span>
        <span class="c1"># Scale[&quot;X&quot;] = 1.5</span>
        <span class="c1"># Scale[&quot;Y&quot;] = 2</span>
        <span class="c1"># Scale[&quot;Z&quot;] = 1</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Scale Factors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Subtract</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Cut Structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Elipse&quot;</span>
        <span class="n">Structures</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Conus_Probe_Sig&quot;</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Isolation_Probe&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_L_Tip&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_R_Tip&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Body_Probe&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Signal_Probe&quot;</span><span class="p">]</span>
        
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Structures</span><span class="p">)):</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Structure to Cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Structures</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">Cut_structures</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
            
            
        <span class="c1"># Rebuild the missing parts after the sphere </span>
        <span class="c1"># Create GGB Probes Body Cylinder    </span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Body_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">290</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">170</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        
        <span class="c1"># Create GGB Probes Signal Cylinder</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Signal_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>

        
        <span class="c1"># Create GGB Probes Isolation Cylinder</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Cylinder Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Isolation_Probe&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Teflon (PTFE) (loss free)&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Outer Radius&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">170</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Inner Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
   
        <span class="c1"># Create Signal Conus</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Conus Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Conus_Probe_Sig&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Top Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Bottom Radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">51.91</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">197.30</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Z max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;X center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Y center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Orentation Axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Conus</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        

        <span class="c1"># Create Ground forms Left</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>  
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">105</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">185</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_3D</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Porbe_GND_L_Tip&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CurveToSolid</span><span class="p">(</span> <span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Translate to right </span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_L_Tip&quot;</span>
        <span class="c1"># DictComponent[&quot;Position X&quot;] = 25/2</span>
        <span class="c1"># DictComponent[&quot;Position Y&quot;] = -186.1</span>
        <span class="c1"># DictComponent[&quot;Position Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">186.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># DictComponent[&quot;Structure Type&quot;] = &quot;Shape&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1">#  Create Ground forms Right</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">130</span><span class="p">,</span> <span class="o">-</span><span class="mi">85</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">]</span>
        <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">185</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>   
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Poligon_3D</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Porbe_GND_R_Tip&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;GND_Curve_Pin&quot;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CurveToSolid</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Translate to right 180 degree</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_R_Tip&quot;</span>
        <span class="c1"># DictComponent[&quot;Position X&quot;] = -25/2</span>
        <span class="c1"># DictComponent[&quot;Position Y&quot;] = 186.1</span>
        <span class="c1"># DictComponent[&quot;Position Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">186.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># DictComponent[&quot;Structure Type&quot;] = &quot;Shape&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        
        <span class="c1"># Translate probe to -30 degree</span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Origin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Free&quot;</span>
        <span class="c1"># Pos[&quot;X&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Y&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># angle = {}</span>
        <span class="c1"># angle[&quot;X&quot;] = 0</span>
        <span class="c1"># angle[&quot;Y&quot;] = angleOrientation</span>
        <span class="c1"># angle[&quot;Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleOrientation</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        <span class="c1"># Subtract</span>
        <span class="n">ObjectsToCut</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Conus_Probe_Sig_Tip&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_L_Tip&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Porbe_GND_R_Tip&quot;</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Elipse&quot;</span><span class="p">,</span>  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Body_Probe&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Isolation_Probe&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">angleOrientation</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">angleCutPlate</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">angleCutPlate</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ObjectsToCut</span><span class="p">)):</span>
                
            <span class="c1"># 30 Degree Plate for the cut </span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span> 
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Lenght Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Width Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">750</span> 
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Width Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">750</span> 
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Hight Max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Hight Min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Brick Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cut_Plate&quot;</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PEC&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Brick</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
            
            
            
            <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Cut_Plate&quot;</span>
            <span class="c1"># Pos[&quot;X&quot;] = 0</span>
            <span class="c1"># Pos[&quot;Y&quot;] = 0</span>
            <span class="c1"># Pos[&quot;Z&quot;] = 0</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># angle = {}</span>
            <span class="c1"># angle[&quot;X&quot;] = 0</span>
            <span class="c1"># angle[&quot;Y&quot;] = angleCutPlate</span>
            <span class="c1"># angle[&quot;Z&quot;] = 0</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleCutPlate</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
            
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
            

            <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Cut_Plate&quot;</span>
            <span class="c1"># DictComponent[&quot;Position X&quot;] = 0</span>
            <span class="c1"># DictComponent[&quot;Position Y&quot;] = 0</span>
            <span class="c1"># DictComponent[&quot;Position Z&quot;] = -144</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">144</span><span class="p">]</span>
            <span class="c1"># DictComponent[&quot;Structure Type&quot;] = &quot;Shape&quot;</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
            
            <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Structure to Cut&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ComponentName</span><span class="si">}</span><span class="s2">:Cut_Plate&quot;</span>
            <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Cut Structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectsToCut</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cut_structures</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
            
            
        <span class="c1"># Tranlate Probe to Tips Z = 0 Positiopn </span>
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Rotate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="c1"># Pos[&quot;X&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Y&quot;] = 0</span>
        <span class="c1"># Pos[&quot;Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># angle = {}</span>
        <span class="c1"># angle[&quot;X&quot;] = 0</span>
        <span class="c1"># angle[&quot;Y&quot;] = angleOrientation</span>
        <span class="c1"># angle[&quot;Z&quot;] = 0</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleOrientation</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span>
        
        <span class="n">DictComponent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Translate&quot;</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComponentName</span>
        <span class="c1"># DictComponent[&quot;Position X&quot;] = 0</span>
        <span class="c1"># DictComponent[&quot;Position Y&quot;] = 0</span>
        <span class="c1"># DictComponent[&quot;Position Z&quot;] = 124.5</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">124.5</span><span class="p">]</span>
        <span class="n">DictComponent</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Shape&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Translation</span><span class="p">(</span><span class="n">DictComponent</span><span class="p">)</span></div>

        
       




<span class="c1">############################################################################</span>
<span class="c1"># Transform to Solid</span>
<span class="c1">############################################################################</span>

    <span class="c1"># def ToSolid(self, SolidName, CurveName = &quot;Polygon&quot;, NameFolder = None, Material = None ):</span>
<div class="viewcode-block" id="CST_Commands.ToSolid">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ToSolid">[docs]</a>
    <span class="k">def</span> <span class="nf">ToSolid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function transfer an function or polynom to solid object.</span>

<span class="sd">        Args: Parameters (dict) of parameters needed for the function</span>
<span class="sd">                Parameters[&quot;Solid Name&quot;] : (str) Name of the solid object</span>
<span class="sd">                Parameters[&quot;Curve Name&quot;] : (str, optional) Name of the curve. Defaults to &quot;Polygon&quot;.</span>
<span class="sd">                Parameters[&quot;Name Folder&quot;] : (str, optional) Name of the folder. Defaults to Curve name.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                    in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                    will not be found. Defaults to Aluminum.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Parameters </span>
        <span class="n">SolidName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span>
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>       

        <span class="c1">#Check Curve Name</span>
        <span class="k">if</span> <span class="n">CurveName</span> <span class="o">!=</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
            <span class="n">CurveName</span> <span class="o">=</span> <span class="n">CurveName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Folder Name</span>
        <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">CurveName</span>

        <span class="c1"># Material Def</span>
        <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Aluminum&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>


        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Wire</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .SolidName &quot;</span><span class="si">{</span><span class="n">SolidName</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">SolidName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Folder &quot;</span><span class="si">{</span><span class="n">NameFolder</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .KeepWire &quot;False&quot;</span>
<span class="s2">                    .ConvertToSolidShape</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;to solid </span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>


    
<div class="viewcode-block" id="CST_Commands.CurveToSolid">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CurveToSolid">[docs]</a>
    <span class="k">def</span> <span class="nf">CurveToSolid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function transfer curve to solid object.</span>

<span class="sd">        Args: Parameters (dict) of parameters needed for the function</span>
<span class="sd">                Parameters[&quot;Name&quot;]  : (str) Name of the solid object</span>
<span class="sd">                Parameters[&quot;Component Name&quot;] : (str, optional) Name of the component in the component tree.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for the solid.</span>
<span class="sd">                Parameters[&quot;Thickness&quot;] : (int/float) Thickness of the solid curve</span>
<span class="sd">                Parameters[&quot;Angle&quot;] : (int/float) Angle</span>
<span class="sd">                Parameters[&quot;Curve Folder&quot;] : (str) Curve folder. First you need to crate curve and then give here the correct name of the curve folder.</span>
<span class="sd">                Parameters[&quot;Curve Name&quot;] : (str) Curve folder. First you need to crate curve and then give here the correct name of the curve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> 
        <span class="n">NameComponent</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Component Name&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">Thickness</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Thickness&quot;</span><span class="p">]</span>
        <span class="n">CurveFolder</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Folder&quot;</span><span class="p">]</span>
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Curve Name&quot;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s2">&quot;Angle&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">Angle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle&quot;</span><span class="p">]</span>
        
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With ExtrudeCurve</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">NameComponent</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Component &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Thickness &quot;</span><span class="si">{</span><span class="n">Thickness</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Twistangle &quot;0&quot;</span>
<span class="s2">                    .Taperangle &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Curve &quot;</span><span class="si">{</span><span class="n">CurveFolder</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">CurveName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curve to solid </span><span class="si">{</span><span class="n">NameComponent</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

                
        
        

    <span class="c1"># def RibWaveguide_ToSolid(self, SolidName, WaveguideName = &quot;Rib_Waveguide&quot;, WG_Hight = None, Angle = None, NameFolder = None, Material = None, WGFolderName = None, WGName = None ):</span>
<div class="viewcode-block" id="CST_Commands.RibWaveguide_ToSolid">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.RibWaveguide_ToSolid">[docs]</a>
    <span class="k">def</span> <span class="nf">RibWaveguide_ToSolid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This is ToSolid function that will allow the use to create the RibWaveguide. </span>
<span class="sd">            TODO: Murrge the TOSolid and RibWaveguideToSolid functions later on. </span>

<span class="sd">            Args: Parameters (dict) Parameters dict needed for the function:</span>
<span class="sd">                Parameters[&quot;Waveguide Name&quot;] : (str, optional) Waveguide Name. Defaults to &quot;Rib_Waveguide&quot;.</span>
<span class="sd">                Parameters[&quot;Wavaguide Hight&quot;] : (int/float, optional) Hight of the waveguide. Defaults to None. </span>
<span class="sd">                Parameters[&quot;Angle&quot;] : (int/float, optional) Side angle of the waveguide. Defaults to None</span>
<span class="sd">                Parameters[&quot;Name Folder&quot;] : (str, optional) Folder name. Defaults to None.</span>
<span class="sd">                Parameters[&quot;Material&quot;] : (str, optional) Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                        in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                        will not be found. Defaults to None.</span>
<span class="sd">                Parameters[&quot;Waveguide Folder Name&quot;] : (str, optional) Name of the folder where the poligon 3D or 2D is created. Defaults to None.</span>
<span class="sd">                Parameters[&quot;Waveguide Name&quot;] : (str, optional) Name of the Poligon 3D or 2D. Defaults to None.</span>
<span class="sd">            </span>
<span class="sd">            Raises:</span>
<span class="sd">                ValueError: Error massage</span>

<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="c1"># Parameters set</span>
        <span class="n">WaveguideName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span>
        <span class="n">WG_Hight</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Waveguide Hight&quot;</span><span class="p">]</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle&quot;</span><span class="p">]</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Folder&quot;</span><span class="p">]</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span>
        <span class="n">WGFolderName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Waveguide Folder Name&quot;</span><span class="p">]</span> 
        <span class="n">WGName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Waveguide Name&quot;</span><span class="p">]</span>
        <span class="c1">#Check Curve Name</span>
        <span class="k">if</span> <span class="n">WaveguideName</span> <span class="o">!=</span> <span class="s2">&quot;Rib_Waveguide&quot;</span><span class="p">:</span>
            <span class="n">WaveguideName</span> <span class="o">=</span> <span class="n">WaveguideName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Folder Name</span>
        <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">WaveguideName</span>

        <span class="c1"># Material Def</span>
        <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Copper (annealed)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>

        <span class="c1"># Angle and Height. Pre define Hight = 2 and Angle = 30</span>
        <span class="k">if</span> <span class="n">WG_Hight</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">WG_Hight</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WG_Hight</span> <span class="o">=</span> <span class="n">WG_Hight</span>

        <span class="k">if</span> <span class="n">Angle</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Angle</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Angle</span> <span class="o">=</span> <span class="n">Angle</span>

        
        <span class="c1"># Check if Curve Name and Folder Name are given</span>
        <span class="k">if</span> <span class="n">WGFolderName</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">WGName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;To create an Rib Waveguide you need to give the Waveguide Folder Name (WGFolderName) and the Rib Waveguide Name (WGName) that you already gave!&quot;</span><span class="p">)</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With ExtrudeCurve</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">WaveguideName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Component &quot;</span><span class="si">{</span><span class="n">WaveguideName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Material &quot;</span><span class="si">{</span><span class="n">Material</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Thickness &quot;</span><span class="si">{</span><span class="n">WG_Hight</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Twistangle &quot;0&quot;</span>
<span class="s2">                    .Taperangle &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Curve &quot;</span><span class="si">{</span><span class="n">WGFolderName</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">WGName</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create rib waveguide&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span> </div>




<span class="c1">############################################################################</span>
<span class="c1"># Ports</span>
<span class="c1">############################################################################</span>


<div class="viewcode-block" id="CST_Commands.WaveguidePort">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.WaveguidePort">[docs]</a>
    <span class="k">def</span> <span class="nf">WaveguidePort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the Waveguide Port for  </span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Port Parameters</span>
<span class="sd">                                Parameters[&quot;Orientation&quot;] = Str with Port Orientation can be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                            this function an 2 ports will be defined so please give an array with two Oriantations</span>
<span class="sd">                                                            like  Parameters[&quot;Orientation&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                                Parameters[&quot;Coordinates&quot;] = Str witch Coordinates type, &quot;Picks&quot; is the best one!</span>
<span class="sd">                                Parameters[&quot;Span&quot;] = Array with Array of port span [[Ymin, Ymax],[Zmin, Zmax]]</span>
<span class="sd">                                Parameters[&quot;Potential&quot;] = Array with port Potential . For example [1,2]</span>
<span class="sd">                                Parameters[&quot;Port Number&quot;] = Array with Port number [1,2]</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Parameters to determin port position </span>
        <span class="n">Orientation</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span>
        <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span>
        <span class="c1"># Choose coordinates</span>
        <span class="n">Span11</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Span12</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Span21</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Span22</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Polarity = Parameters[&quot;Polarity&quot;]</span>
        <span class="c1"># SolidName = Parameters[&quot;Solid Name&quot;]</span>
        <span class="c1"># PickID = Parameters[&quot;Face ID&quot;]</span>
        <span class="c1">#Return Ports in Dictionary for one Object 2 Ports can be define </span>
        <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Ports Numbers</span>
        <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

        <span class="c1"># loop true mode sets</span>
        <span class="n">Potentials</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Potential&quot;</span><span class="p">]</span>


        <span class="c1">#Start Loop for Ports</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Potentials</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Port</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .PortNumber &quot;</span><span class="si">{</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .NumberOfModes &quot;5&quot;</span><span class="se">\</span>
<span class="s2">                        .ReferencePlaneDistance &quot;0&quot;</span>
<span class="s2">                        .Coordinates &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Orientation &quot;</span><span class="si">{</span><span class="n">Orientation</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .PortOnBound &quot;False&quot;</span>
<span class="s2">                        .ClipPickedPortToBound &quot;False&quot;</span>
<span class="s2">                        .YrangeAdd  &quot;</span><span class="si">{</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZrangeAdd  &quot;</span><span class="si">{</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .AdjustPolarization &quot;True&quot;</span>
<span class="s2">                        .PolarizationAngle &quot;0&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create waveguide port&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span> </div>





<div class="viewcode-block" id="CST_Commands.WaveguidePortWithPins">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.WaveguidePortWithPins">[docs]</a>
    <span class="k">def</span> <span class="nf">WaveguidePortWithPins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the Waveguide Port for  </span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Port Parameters</span>
<span class="sd">                                Parameters[&quot;Orientation&quot;] = Str with Port Orientation can be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                            this function an 2 ports will be defined so please give an array with two Oriantations</span>
<span class="sd">                                                            like  Parameters[&quot;Orientation&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                                Parameters[&quot;Coordinates&quot;] = Str witch Coordinates type, &quot;Picks&quot; is the best one!</span>
<span class="sd">                                Parameters[&quot;Span&quot;] = Array with Array of port span [[Ymin, Ymax],[Zmin, Zmax]]</span>
<span class="sd">                                Parameters[&quot;Potential&quot;] = Array with port Potential . For example [1,2]</span>
<span class="sd">                                Parameters[&quot;Port Number&quot;] = Array with Port number [1,2]</span>
<span class="sd">                                Parameters[&quot;Polarity&quot;] = Port Polarity can be be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                        this function an 2 ports will be defined so please give an </span>
<span class="sd">                                                        array with two Polaritys. For example Parameters[&quot;Polarity&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                                Parameters[&quot;Solid Name&quot;] = Name of the Object on witch the Waveguide port will be created. For example &quot;WG:WG1&quot;</span>
<span class="sd">                                Parameters[&quot;Face ID&quot;] = Array with the ID of the two picked faces. For example Parameters[&quot;Face ID&quot;] = [2,4]</span>
<span class="sd">            PicParams (dict): Dictionary with Pick Faces Parameters</span>
<span class="sd">                                PickParams[&quot;Face Number&quot;] = Integer with the number of the picked face of the structure</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Parameters to determin port position </span>
        <span class="n">Orientation</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span>
        <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span>
        <span class="c1"># Choose coordinates</span>
        <span class="n">PortNumber</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>
        <span class="n">Span</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">]</span>
        <span class="n">set_number</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Picked Port Number&quot;</span><span class="p">]</span> 
        <span class="n">Number_of_picks</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Number of picks&quot;</span><span class="p">]</span>
        
        
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">Number_of_picks</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">potential</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Picked Port Polarity&quot;</span><span class="p">]</span>
            <span class="n">marked_face</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Picked Component Name&quot;</span><span class="p">]</span>
            <span class="n">facet_Id</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">marked_face</span><span class="p">)):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.AddPotentialPicked &quot;</span><span class="si">{</span><span class="n">set_number</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">potential</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">marked_face</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;, &quot;</span><span class="si">{</span><span class="n">facet_Id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

            <span class="c1"># join them with newlines</span>
            <span class="n">line_block</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            

            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Port</span>
<span class="s2">                            .Reset</span>
<span class="s2">                            .PortNumber &quot;</span><span class="si">{</span><span class="n">PortNumber</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .Label &quot;&quot;</span>
<span class="s2">                            .Folder &quot;&quot;</span>
<span class="s2">                            .NumberOfModes &quot;1&quot;</span>
<span class="s2">                            .AdjustPolarization &quot;False&quot;</span>
<span class="s2">                            .PolarizationAngle &quot;0.0&quot;</span>
<span class="s2">                            .ReferencePlaneDistance &quot;0.0&quot;</span>
<span class="s2">                            .TextSize &quot;50&quot;</span>
<span class="s2">                            .TextMaxLimit &quot;0&quot;</span>
<span class="s2">                            .Coordinates &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .Orientation &quot;</span><span class="si">{</span><span class="n">Orientation</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .PortOnBound &quot;True&quot;</span>
<span class="s2">                            .ClipPickedPortToBound &quot;False&quot;</span>
<span class="s2">                            .Xrange &quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                            .Yrange &quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                            .Zrange &quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                            .XrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .YrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .ZrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                            .SingleEnded &quot;False&quot;</span>
<span class="s2">                            </span><span class="si">{</span><span class="n">line_block</span><span class="si">}</span>
<span class="s2">                            .WaveguideMonitor &quot;False&quot;</span>
<span class="s2">                            .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create waveguide port </span><span class="si">{</span><span class="n">PortNumber</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Port</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .PortNumber &quot;</span><span class="si">{</span><span class="n">PortNumber</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Label &quot;&quot;</span>
<span class="s2">                        .Folder &quot;&quot;</span>
<span class="s2">                        .NumberOfModes &quot;1&quot;</span>
<span class="s2">                        .AdjustPolarization &quot;False&quot;</span>
<span class="s2">                        .PolarizationAngle &quot;0&quot;</span>
<span class="s2">                        .ReferencePlaneDistance &quot;0&quot;</span>
<span class="s2">                        .TextSize &quot;50&quot;</span>
<span class="s2">                        .TextMaxLimit &quot;1&quot;</span>
<span class="s2">                        .Coordinates &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Orientation &quot;</span><span class="si">{</span><span class="n">Orientation</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="s2">                        .PortOnBound &quot;True&quot;</span>
<span class="s2">                        .ClipPickedPortToBound &quot;False&quot;</span>
<span class="s2">                        .Xrange &quot;0&quot;, &quot;100&quot;</span>
<span class="s2">                        .Yrange &quot;0&quot;, &quot;100&quot;</span>
<span class="s2">                        .Zrange &quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                        .XrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .YrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZrangeAdd &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SingleEnded &quot;False&quot;</span>
<span class="s2">                        .WaveguideMonitor &quot;False&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create waveguide port&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




        
<div class="viewcode-block" id="CST_Commands.MoveWaveguidePorts">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.MoveWaveguidePorts">[docs]</a>
    <span class="k">def</span> <span class="nf">MoveWaveguidePorts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to move the waveguide ports</span>

<span class="sd">            Args: Parameters (dict): Dictionary with Port Parameters</span>
<span class="sd">                Parameters[&quot;Port Number&quot;] : (int) Port number</span>
<span class="sd">                Parameters[&quot;Distance&quot;] : (int/float) distance to move the waveguide </span>
<span class="sd">                Parameters[&quot;Span&quot;] : (dict) with array to set the range in &quot;X&quot;, &quot;Y&quot; and &quot;Z&quot;</span>
<span class="sd">                    Parameters[&quot;Span&quot;][0][0] - Yrange min</span>
<span class="sd">                    Parameters[&quot;Span&quot;][0][1] - Yrange max</span>
<span class="sd">                    Parameters[&quot;Span&quot;][1][0] - Zrange min</span>
<span class="sd">                    Parameters[&quot;Span&quot;][1][1] - Zrange max</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Distance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Distance&quot;</span><span class="p">]</span>
        <span class="n">Span11</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Span12</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Span21</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Span22</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Ports Numbers</span>
        <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

        <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


        <span class="c1"># Xposition of thw teo ends </span>
        <span class="n">Xpos</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">Distance</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">Distance</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
        <span class="c1">#Start Loop for Ports</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">PortNum</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Port</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        LoadContentForModify &quot;</span><span class="si">{</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Coordinates &quot;Free&quot;</span>
<span class="s2">                        .ClipPickedPortToBound &quot;False&quot;</span>
<span class="s2">                        .Yrange  &quot;</span><span class="si">{</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zrange  &quot;</span><span class="si">{</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xrange &quot;</span><span class="si">{</span><span class="n">Xpos</span><span class="p">[</span><span class="n">index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Xpos</span><span class="p">[</span><span class="n">index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .NumberOfModes &quot;5&quot;</span>
<span class="s2">                        .AdjustPolarization &quot;True&quot;</span>
<span class="s2">                        .PolarizationAngle &quot;0&quot;</span>
<span class="s2">                        .Modify</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;move waveguide port&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.SetDiscretePort">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.SetDiscretePort">[docs]</a>
    <span class="k">def</span> <span class="nf">SetDiscretePort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to set discrete port</span>

<span class="sd">            Args: Parameters (dict): Dictionary with parameters to set discrete port</span>
<span class="sd">                Parameters[&quot;Discrete Port Number&quot;] : (int) Port number</span>
<span class="sd">                Parameters[&quot;Discrete Port Type&quot;] : (str) Type of discrete port, can be:</span>
<span class="sd">                                                   &quot;Voltage&quot;</span>
<span class="sd">                                                   &quot;S-Parameters&quot;</span>
<span class="sd">                                                   &quot;Current&quot;</span>
<span class="sd">                Parameters[&quot;Port Impedance&quot;] : (int/float) Impedance of the port</span>
<span class="sd">                Parameters[&quot;Port Voltage&quot;] : (int/float) set Port voltage</span>
<span class="sd">                Parameters[&quot;Port Current&quot;] : (int/float) set Port current</span>
<span class="sd">                Parameters[&quot;Port Radius&quot;] : (int/float) set Port radius</span>
<span class="sd">                Parameters[&quot;Discrete Port Coordinates&quot;] : (dict) set dictionary with port coordiantes</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;X1&quot;]</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;Y1&quot;]</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;Z1&quot;]</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;X2&quot;]</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;Y2&quot;]</span>
<span class="sd">                        Parameters[&quot;Discrete Port Coordinates&quot;][&quot;Z2&quot;]</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">PortNumber</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Number&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Voltage&quot;</span><span class="p">,</span> <span class="s2">&quot;S-Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">]:</span>
            <span class="n">PortType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Type&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Port Type can be on of &#39;Voltage&#39;&#39;S-Parameters&#39; or &#39;Current&#39;&quot;</span><span class="p">)</span>
        <span class="n">PortImpedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Impedance&quot;</span><span class="p">]</span>
        <span class="n">Voltage</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Voltage&quot;</span><span class="p">]</span>
        <span class="n">Current</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Current&quot;</span><span class="p">]</span>
        <span class="n">PortRadius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Radius&quot;</span><span class="p">]</span>


        <span class="c1"># Port = {}</span>
        <span class="c1"># Port[&quot;1&quot;] = None</span>
        <span class="c1"># Port[&quot;2&quot;] = None</span>

        <span class="k">if</span> <span class="s2">&quot;Discrete Port Coordinates&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Coordinates&quot;</span><span class="p">]</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With DiscretePort</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .PortNumber &quot;</span><span class="si">{</span><span class="n">PortNumber</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Type &quot;</span><span class="si">{</span><span class="n">PortType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Label &quot;&quot;</span>
<span class="s2">                        .Folder &quot;&quot;</span>
<span class="s2">                        .Impedance &quot;</span><span class="si">{</span><span class="n">PortImpedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Voltage &quot;</span><span class="si">{</span><span class="n">Voltage</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Current &quot;</span><span class="si">{</span><span class="n">Current</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Monitor &quot;True&quot;</span>
<span class="s2">                        .Radius &quot;</span><span class="si">{</span><span class="n">PortRadius</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetP1 &quot;False&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z1&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetP2 &quot;False&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z2&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .InvertDirection &quot;False&quot;</span>
<span class="s2">                        .LocalCoordinates &quot;False&quot;</span>
<span class="s2">                        .Wire &quot;&quot;</span>
<span class="s2">                        .Position &quot;end1&quot;</span>
<span class="s2">                        .Create</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create discrete waveguide port&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                With DiscretePort</span>
<span class="s2">                .Reset</span>
<span class="s2">                .PortNumber &quot;</span><span class="si">{</span><span class="n">PortNumber</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Type &quot;</span><span class="si">{</span><span class="n">PortType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Label &quot;&quot;</span>
<span class="s2">                .Folder &quot;&quot;</span>
<span class="s2">                .Impedance &quot;</span><span class="si">{</span><span class="n">PortImpedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Impedance &quot;</span><span class="si">{</span><span class="n">PortImpedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Voltage &quot;</span><span class="si">{</span><span class="n">Voltage</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Current &quot;</span><span class="si">{</span><span class="n">Current</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .Monitor &quot;True&quot;</span>
<span class="s2">                .Radius &quot;</span><span class="si">{</span><span class="n">PortRadius</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                .SetP1 &quot;True&quot;, &quot;-23&quot;, &quot;-2.9618802153517&quot;, &quot;1.7&quot;</span>
<span class="s2">                .SetP2 &quot;True&quot;, &quot;-23&quot;, &quot;3&quot;, &quot;1.7&quot;</span>
<span class="s2">                .InvertDirection &quot;False&quot;</span>
<span class="s2">                .LocalCoordinates &quot;False&quot;</span>
<span class="s2">                .Wire &quot;&quot;</span>
<span class="s2">                .Position &quot;end1&quot;</span>
<span class="s2">                .Create </span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;move waveguide port&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

            


<span class="c1"># def WaveguidePorts_on_Electrodes_MZM(self, Parameters, Obj):</span>
<span class="c1">#     for i in range(len(Parameters[&quot;Port Number&quot;])):</span>
<span class="c1">#         for j in range(len(Parameters[&quot;Electrodes_Names&quot;])):</span>
<span class="c1">#             PicParams = {}</span>
<span class="c1">#             PicParams[&quot;Option&quot;] = &quot;Face&quot;</span>
<span class="c1">#             PicParams[&quot;Object&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             PicParams[&quot;Face Number&quot;] = Parameters[&quot;Face ID&quot;][i]</span>
<span class="c1">#             PickFace = Pick(PicParams)</span>
<span class="c1">#             Parameters[&quot;Solid Name&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             Obj.schematic.execute_vba_code(PickFace, timeout=None)</span>
        
<span class="c1">#         Port = WaveguidePortWithPins(Parameters, PicParams)</span>
<span class="c1">#         Obj.schematic.execute_vba_code(Port[str(i+1)], timeout=None)</span>





<span class="c1"># def Optical_WaveguidePorts_MZM(self, Parameters, Obj):</span>
<span class="c1">#     for i in range(len(Parameters[&quot;Port Number&quot;])):</span>
<span class="c1">#         for j in range(len(Parameters[&quot;Electrodes_Names&quot;])):</span>
<span class="c1">#             PicParams = {}</span>
<span class="c1">#             PicParams[&quot;Option&quot;] = &quot;Face&quot;</span>
<span class="c1">#             PicParams[&quot;Object&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             PicParams[&quot;Face Number&quot;] = Parameters[&quot;Face ID&quot;][i]</span>
<span class="c1">#             PickFace = Pick(PicParams)</span>
<span class="c1">#             Parameters[&quot;Solid Name&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             Obj.schematic.execute_vba_code(PickFace, timeout=None)</span>
        
<span class="c1">#         Port = WaveguidePort(Parameters)</span>
<span class="c1">#         Obj.schematic.execute_vba_code(Port[str(i+1)], timeout=None)</span>






<span class="c1"># def Discrete_Port(self, Parameters, Obj):</span>
<span class="c1">#     for i in range(len(Parameters[&quot;Port Number&quot;])):</span>
<span class="c1">#         Parameters[&quot;Discrete Port Number&quot;] = Parameters[&quot;Port Number&quot;][i]</span>
<span class="c1">#         for j in range(len(Parameters[&quot;Port Number&quot;])):</span>
<span class="c1">#             PicParams = {}</span>
<span class="c1">#             PicParams[&quot;Option&quot;] = &quot;Centerpoint&quot;</span>
<span class="c1">#             PicParams[&quot;Object&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             PicParams[&quot;Face Number&quot;] = Parameters[&quot;Face ID&quot;][i]</span>
<span class="c1">#             PickFace = Pick(PicParams)</span>
<span class="c1">#             Parameters[&quot;Solid Name&quot;] = Parameters[&quot;Electrodes_Names&quot;][j]</span>
<span class="c1">#             Obj.schematic.execute_vba_code(PickFace, timeout=None)</span>

<span class="c1">#         DiscretePort = SetDiscretePort(Parameters)</span>
<span class="c1">#         Obj.schematic.execute_vba_code(DiscretePort, timeout=None)</span>
    
<span class="c1">############################################################################</span>
<span class="c1"># Picks</span>
<span class="c1">############################################################################</span>
                

<div class="viewcode-block" id="CST_Commands.Pick">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Pick">[docs]</a>
    <span class="k">def</span> <span class="nf">Pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pick function</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters   </span>
<span class="sd">                            PicParams[&quot;Option&quot;] : Pcik option. For example &quot;Face&quot;</span>
<span class="sd">                            PicParams[&quot;Object&quot;] : Name of the object on witch the pick will be executed.</span>
<span class="sd">                            PicParams[&quot;Face Number&quot;] = int with the ID of the picked Face for example.</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Parameters for Picking an object</span>
        <span class="n">FaceName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span>
        <span class="n">Number</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Face&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        Pick.PickFaceFromId &quot;</span><span class="si">{</span><span class="n">FaceName</span><span class="si">}</span><span class="s2">&quot;,&quot;</span><span class="si">{</span><span class="n">Number</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set pick&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Centerpoint&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        Pick.PickCenterpointFromId &quot;</span><span class="si">{</span><span class="n">FaceName</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Number</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set pick&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong Object, can be choose from &#39;Face&#39; and &#39;Centerpoint&#39; for the moment!&quot;</span><span class="p">)</span></div>


        
<div class="viewcode-block" id="CST_Commands.ClearAllPicks">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ClearAllPicks">[docs]</a>
    <span class="k">def</span> <span class="nf">ClearAllPicks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear all pciks</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                Pick.ClearAllPicks</span>
<span class="s2">                &quot;&quot;&quot;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;delete pick&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>    </div>






                
                    


<span class="c1">############################################################################</span>
<span class="c1"># Solvers</span>
<span class="c1">############################################################################</span>

<div class="viewcode-block" id="CST_Commands.setTimeSolver">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setTimeSolver">[docs]</a>
    <span class="k">def</span> <span class="nf">setTimeSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Time solver Parameters</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Accuracy&quot;] : int from 10,15,20,25,30,35,40. Simulation accuracy. For example 20.    </span>
<span class="sd">                                Parameters[&quot;Caclculate Modes Only&quot;] : Boolen. True if you want to calculate </span>
<span class="sd">                                only the Ports modes. False to calculate the hole structure. </span>
<span class="sd">                                Parameters[&quot;Auto Impedance&quot;] : Booled. Set Port Impedance. True if you want to set manually</span>
<span class="sd">                                False otherwise.</span>
<span class="sd">                                Parameters[&quot;Impedance&quot;] : int/float Port Impedance. </span>
<span class="sd">                                Parameters[&quot;Source Port&quot;] : Int. Set the Source Port. For example 1 or 2</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Accuracy</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
        <span class="n">ModesOnly</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Caclculate Modes Only&quot;</span><span class="p">]</span>
        <span class="n">AutoImpedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Auto Impedance&quot;</span><span class="p">]</span>
        <span class="n">Impedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Impedance&quot;</span><span class="p">]</span>
        <span class="n">Source</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Source Port&quot;</span><span class="p">]</span>
        <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solver Mesh Type&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">MeshType</span> <span class="o">==</span> <span class="s2">&quot;FIT&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        With Solver</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Method &quot;Hexahedral&quot;</span>
<span class="s2">                        .SteadyStateLimit &quot;-</span><span class="si">{</span><span class="n">Accuracy</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .CalculateModesOnly &quot;</span><span class="si">{</span><span class="n">ModesOnly</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .StimulationPort &quot;</span><span class="si">{</span><span class="n">Source</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .StimulationMode &quot;All&quot;</span>
<span class="s2">                        .MeshAdaption &quot;False&quot;</span>
<span class="s2">                        .SParaSymmetry &quot;True&quot;</span>
<span class="s2">                        .AutoNormImpedance  &quot;</span><span class="si">{</span><span class="n">AutoImpedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .NormingImpedance &quot;</span><span class="si">{</span><span class="n">Impedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set </span><span class="si">{</span><span class="n">MeshType</span><span class="si">}</span><span class="s2"> time solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>  


        <span class="k">elif</span> <span class="n">MeshType</span> <span class="o">==</span> <span class="s2">&quot;TLM&quot;</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        Mesh.SetCreator &quot;High Frequency&quot;</span>
<span class="s2">                        With Solver</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .Method &quot;Hexahedral TLM&quot;</span>
<span class="s2">                        .SteadyStateLimit &quot;-</span><span class="si">{</span><span class="n">Accuracy</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .StimulationPort &quot;</span><span class="si">{</span><span class="n">Source</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .StimulationMode &quot;All&quot;</span>
<span class="s2">                        .MeshAdaption &quot;False&quot;</span>
<span class="s2">                        .SParaSymmetry &quot;False&quot;</span>
<span class="s2">                        .AutoNormImpedance &quot;True&quot;</span>
<span class="s2">                        .NormingImpedance &quot;</span><span class="si">{</span><span class="n">Impedance</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .StoreTDResultsInCache  &quot;False&quot;</span>
<span class="s2">                        .RunDiscretizerOnly &quot;False&quot;</span>
<span class="s2">                        .SuperimposePLWExcitation &quot;False&quot;</span>
<span class="s2">                        End With</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set </span><span class="si">{</span><span class="n">MeshType</span><span class="si">}</span><span class="s2"> time solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mesh Type is not recognized, only &#39;TLM&#39; or &#39;FIT&#39; are supported! &quot;</span><span class="p">)</span></div>







<div class="viewcode-block" id="CST_Commands.setFreqSolver">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setFreqSolver">[docs]</a>
    <span class="k">def</span> <span class="nf">setFreqSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Frequency solver Parameters</span>
<span class="sd">         </span>
<span class="sd">            TODO : This function will set an IDLE Frequency solver parameters. It need to be customizable!</span>
<span class="sd">        For Example Somthing liek:</span>
<span class="sd">        def setFreqSolver(self)</span>
<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Accuracy&quot;] : int from 10,15,20,25,30,35,40. Simulation accuracy. For example 20.    </span>
<span class="sd">                                Parameters[&quot;Caclculate Modes Only&quot;] : Boolen. True if you want to calculate </span>
<span class="sd">                                only the Ports modes. False to calculate the hole structure. </span>
<span class="sd">                                Parameters[&quot;Auto Impedance&quot;] : Booled. Set Port Impedance. True if you want to set manually</span>
<span class="sd">                                False otherwise.</span>
<span class="sd">                                Parameters[&quot;Impedance&quot;] : int/float Port Impedance. </span>
<span class="sd">                                Parameters[&quot;Source Port&quot;] : Int. Set the Source Port. For example 1 or 2</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Accuracy = Parameters[&quot;Accuracy&quot;]</span>
        <span class="c1"># ModesOnly = Parameters[&quot;Caclculate Modes Only&quot;]</span>
        <span class="c1"># AutoImpedance = Parameters[&quot;Auto Impedance&quot;]</span>
        <span class="c1"># Impedance = Parameters[&quot;Impedance&quot;]</span>
        <span class="c1"># Source = Parameters[&quot;Source Port&quot;]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Mesh.SetCreator &quot;High Frequency&quot; </span>

<span class="s2">            With FDSolver</span>
<span class="s2">                .Reset </span>
<span class="s2">                .SetMethod &quot;Tetrahedral&quot;, &quot;General purpose&quot; </span>
<span class="s2">                .OrderTet &quot;Second&quot; </span>
<span class="s2">                .OrderSrf &quot;First&quot; </span>
<span class="s2">                .Stimulation &quot;All&quot;, &quot;All&quot; </span>
<span class="s2">                .ResetExcitationList </span>
<span class="s2">                .AutoNormImpedance &quot;True&quot; </span>
<span class="s2">                .NormingImpedance &quot;50&quot; </span>
<span class="s2">                .ModesOnly &quot;False&quot; </span>
<span class="s2">                .ConsiderPortLossesTet &quot;True&quot; </span>
<span class="s2">                .SetShieldAllPorts &quot;False&quot; </span>
<span class="s2">                .AccuracyHex &quot;1e-6&quot; </span>
<span class="s2">                .AccuracyTet &quot;1e-4&quot; </span>
<span class="s2">                .AccuracySrf &quot;1e-3&quot; </span>
<span class="s2">                .LimitIterations &quot;False&quot; </span>
<span class="s2">                .MaxIterations &quot;0&quot; </span>
<span class="s2">                .SetCalcBlockExcitationsInParallel &quot;True&quot;, &quot;True&quot;, &quot;&quot; </span>
<span class="s2">                .StoreAllResults &quot;False&quot; </span>
<span class="s2">                .StoreResultsInCache &quot;False&quot; </span>
<span class="s2">                .UseHelmholtzEquation &quot;True&quot; </span>
<span class="s2">                .LowFrequencyStabilization &quot;True&quot; </span>
<span class="s2">                .Type &quot;Auto&quot; </span>
<span class="s2">                .MeshAdaptionHex &quot;False&quot; </span>
<span class="s2">                .MeshAdaptionTet &quot;True&quot; </span>
<span class="s2">                .AcceleratedRestart &quot;True&quot; </span>
<span class="s2">                .FreqDistAdaptMode &quot;Distributed&quot; </span>
<span class="s2">                .NewIterativeSolver &quot;True&quot; </span>
<span class="s2">                .TDCompatibleMaterials &quot;False&quot; </span>
<span class="s2">                .ExtrudeOpenBC &quot;False&quot; </span>
<span class="s2">                .SetOpenBCTypeHex &quot;Default&quot; </span>
<span class="s2">                .SetOpenBCTypeTet &quot;Default&quot; </span>
<span class="s2">                .AddMonitorSamples &quot;True&quot; </span>
<span class="s2">                .CalcPowerLoss &quot;True&quot; </span>
<span class="s2">                .CalcPowerLossPerComponent &quot;False&quot; </span>
<span class="s2">                .SetKeepSolutionCoefficients &quot;MonitorsAndMeshAdaptation&quot; </span>
<span class="s2">                .UseDoublePrecision &quot;False&quot; </span>
<span class="s2">                .UseDoublePrecision_ML &quot;True&quot; </span>
<span class="s2">                .MixedOrderSrf &quot;False&quot; </span>
<span class="s2">                .MixedOrderTet &quot;False&quot; </span>
<span class="s2">                .PreconditionerAccuracyIntEq &quot;0.15&quot; </span>
<span class="s2">                .MLFMMAccuracy &quot;Default&quot; </span>
<span class="s2">                .MinMLFMMBoxSize &quot;0.3&quot; </span>
<span class="s2">                .UseCFIEForCPECIntEq &quot;True&quot; </span>
<span class="s2">                .UseEnhancedCFIE2 &quot;True&quot; </span>
<span class="s2">                .UseFastRCSSweepIntEq &quot;false&quot; </span>
<span class="s2">                .UseSensitivityAnalysis &quot;False&quot; </span>
<span class="s2">                .UseEnhancedNFSImprint &quot;True&quot; </span>
<span class="s2">                .UseFastDirectFFCalc &quot;True&quot; </span>
<span class="s2">                .RemoveAllStopCriteria &quot;Hex&quot;</span>
<span class="s2">                .AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;True&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;False&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;False&quot;</span>
<span class="s2">                .RemoveAllStopCriteria &quot;Tet&quot;</span>
<span class="s2">                .AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;True&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;False&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;False&quot;</span>
<span class="s2">                .AddStopCriterion &quot;All Probes&quot;, &quot;0.05&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;True&quot;</span>
<span class="s2">                .RemoveAllStopCriteria &quot;Srf&quot;</span>
<span class="s2">                .AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;True&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;False&quot;</span>
<span class="s2">                .AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;False&quot;</span>
<span class="s2">                .SweepMinimumSamples &quot;3&quot; </span>
<span class="s2">                .SetNumberOfResultDataSamples &quot;1001&quot; </span>
<span class="s2">                .SetResultDataSamplingMode &quot;Automatic&quot; </span>
<span class="s2">                .SweepWeightEvanescent &quot;1.0&quot; </span>
<span class="s2">                .AccuracyROM &quot;1e-4&quot; </span>
<span class="s2">                .AddSampleInterval &quot;&quot;, &quot;&quot;, &quot;1&quot;, &quot;Automatic&quot;, &quot;True&quot; </span>
<span class="s2">                .AddSampleInterval &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;Automatic&quot;, &quot;False&quot; </span>
<span class="s2">                .MPIParallelization &quot;False&quot;</span>
<span class="s2">                .UseDistributedComputing &quot;False&quot;</span>
<span class="s2">                .NetworkComputingStrategy &quot;RunRemote&quot;</span>
<span class="s2">                .NetworkComputingJobCount &quot;3&quot;</span>
<span class="s2">                .UseParallelization &quot;True&quot;</span>
<span class="s2">                .MaxCPUs &quot;1024&quot;</span>
<span class="s2">                .MaximumNumberOfCPUDevices &quot;2&quot;</span>
<span class="s2">                .HardwareAcceleration &quot;False&quot;</span>
<span class="s2">                .MaximumNumberOfGPUs &quot;1&quot;</span>
<span class="s2">            End With</span>

<span class="s2">            With IESolver</span>
<span class="s2">                .Reset </span>
<span class="s2">                .UseFastFrequencySweep &quot;True&quot; </span>
<span class="s2">                .UseIEGroundPlane &quot;False&quot; </span>
<span class="s2">                .SetRealGroundMaterialName &quot;&quot; </span>
<span class="s2">                .CalcFarFieldInRealGround &quot;False&quot; </span>
<span class="s2">                .RealGroundModelType &quot;Auto&quot; </span>
<span class="s2">                .PreconditionerType &quot;Auto&quot; </span>
<span class="s2">                .ExtendThinWireModelByWireNubs &quot;False&quot; </span>
<span class="s2">                .ExtraPreconditioning &quot;False&quot; </span>
<span class="s2">            End With</span>

<span class="s2">            With IESolver</span>
<span class="s2">                .SetFMMFFCalcStopLevel &quot;0&quot; </span>
<span class="s2">                .SetFMMFFCalcNumInterpPoints &quot;6&quot; </span>
<span class="s2">                .UseFMMFarfieldCalc &quot;True&quot; </span>
<span class="s2">                .SetCFIEAlpha &quot;0.500000&quot; </span>
<span class="s2">                .LowFrequencyStabilization &quot;False&quot; </span>
<span class="s2">                .LowFrequencyStabilizationML &quot;True&quot; </span>
<span class="s2">                .Multilayer &quot;False&quot; </span>
<span class="s2">                .SetiMoMACC_I &quot;0.0001&quot; </span>
<span class="s2">                .SetiMoMACC_M &quot;0.0001&quot; </span>
<span class="s2">                .DeembedExternalPorts &quot;True&quot; </span>
<span class="s2">                .SetOpenBC_XY &quot;True&quot; </span>
<span class="s2">                .OldRCSSweepDefintion &quot;False&quot; </span>
<span class="s2">                .SetRCSOptimizationProperties &quot;True&quot;, &quot;100&quot;, &quot;0.00001&quot; </span>
<span class="s2">                .SetAccuracySetting &quot;Medium&quot; </span>
<span class="s2">                .CalculateSParaforFieldsources &quot;True&quot; </span>
<span class="s2">                .ModeTrackingCMA &quot;True&quot; </span>
<span class="s2">                .NumberOfModesCMA &quot;3&quot; </span>
<span class="s2">                .StartFrequencyCMA &quot;-1.0&quot; </span>
<span class="s2">                .SetAccuracySettingCMA &quot;Default&quot; </span>
<span class="s2">                .FrequencySamplesCMA &quot;0&quot; </span>
<span class="s2">                .SetMemSettingCMA &quot;Auto&quot; </span>
<span class="s2">                .CalculateModalWeightingCoefficientsCMA &quot;True&quot; </span>
<span class="s2">                .DetectThinDielectrics &quot;True&quot; </span>
<span class="s2">                .UseLegacyRadiatedPowerCalc &quot;False&quot; </span>
<span class="s2">            End With</span>

<span class="s2">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set frequency solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span> </div>


                        
<div class="viewcode-block" id="CST_Commands.StartTimeSolver">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.StartTimeSolver">[docs]</a>
    <span class="k">def</span> <span class="nf">StartTimeSolver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start Time Simulation</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Solver</span>
<span class="s2">                    .Start</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;start time solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




    <span class="c1"># Set Optical Simulation Domain </span>
<div class="viewcode-block" id="CST_Commands.setOpticalSimulationProperties">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setOpticalSimulationProperties">[docs]</a>
    <span class="k">def</span> <span class="nf">setOpticalSimulationProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to set an Optical Simulation Properties. </span>

<span class="sd">            TODO : The function need to be expands so more parameters such as mesh properties can be added!</span>

<span class="sd">            Args: Parameters (dict): Dictionary with Parameters</span>

<span class="sd">                    Parameters[&#39;Dimensions&#39;] : (str) Unit Leghts</span>
<span class="sd">                    Parameters[&#39;Frequency&#39;]  : (str) Frequency Units</span>
<span class="sd">                    Parameters[&#39;Time&#39;] : (str) Time Units</span>
<span class="sd">                    Parameters[&#39;Temperature&#39;] : (str) Temperature Units</span>
<span class="sd">                    Parameters[&quot;Type Background&quot;] : (str) Background Type</span>
<span class="sd">                    Parameters[&quot;Xmin Background&quot;] : (int/float) Backgroun X min span</span>
<span class="sd">                    Parameters[&quot;Xmax Background&quot;] : (int/float) Background X max span</span>
<span class="sd">                    Parameters[&quot;Ymin Background&quot;] : (int/float) Backgroun Y min span</span>
<span class="sd">                    Parameters[&quot;Ymax Background&quot;] : (int/float) Backgroun Y max span</span>
<span class="sd">                    Parameters[&quot;Zmin Background&quot;] : (int/float) Backgroun Z min span</span>
<span class="sd">                    Parameters[&quot;Zmax Background&quot;] : (int/float) Backgroun Z max span</span>
<span class="sd">                    Parameters[&quot;Min Wavelength&quot;] : (int/float) Min wavelenght</span>
<span class="sd">                    Parameters[&quot;Max Wavelength&quot;] : (int/float) Max wavelenght</span>
<span class="sd">                    Parameters[&quot;Xmin Boundary&quot;] : (int/float) Min X boundary</span>
<span class="sd">                    Parameters[&quot;Xmax Boundary&quot;] : (int/float) Max X boundary</span>
<span class="sd">                    Parameters[&quot;Ymin Boundary&quot;] : (int/float) Min Y boundary</span>
<span class="sd">                    Parameters[&quot;Ymax Boundary&quot;] : (int/float) Max Y boundary</span>
<span class="sd">                    Parameters[&quot;Zmin Boundary&quot;] : (int/float) Min Z boundary</span>
<span class="sd">                    Parameters[&quot;Zmax Boundary&quot;] : (int/float) Max Z boundary</span>
<span class="sd">                    Parameters[&quot;Xsymmetry Boundary&quot;] : (int/float) set symetrie to the X boundary</span>
<span class="sd">                    Parameters[&quot;Ysymmetry Boundary&quot;] : (int/float) set symetrie to the Y boundary</span>
<span class="sd">                    Parameters[&quot;Zsymmetry Boundary&quot;] : (int/float) set symetrie to the Z boundary</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Units Properties</span>
        <span class="n">Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">]</span> 
        <span class="n">Frequency</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> 
        <span class="n">Time</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> 
        <span class="n">Temperature</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> 

        <span class="c1"># Set Background</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>
        <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">]</span> 
        <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">]</span>
        <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">]</span> 
        <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">]</span>
        <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">]</span> 
        <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">]</span>

        <span class="c1"># Operational Wavelength</span>
        <span class="n">WavelengthMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Wavelength&quot;</span><span class="p">]</span>
        <span class="n">WavelengtMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Wavelength&quot;</span><span class="p">]</span>

        <span class="c1"># Set Boundary</span>
        <span class="n">XminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">XmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">XSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span> 

        <span class="c1"># # Mesh Settings</span>
        <span class="c1"># MeshType = Parameters[&quot;Mesh Type&quot;] </span>
        <span class="c1"># CellNear = Parameters[&quot;Mesh Cells Near Object&quot;] </span>
        <span class="c1"># CellFar = Parameters[&quot;Mesh Cells far Object&quot;] </span>


        <span class="c1"># VBA Code</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Units</span>
<span class="s2">                        .SetUnit &quot;Length&quot;, &quot;</span><span class="si">{</span><span class="n">Length</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Frequency&quot;, &quot;</span><span class="si">{</span><span class="n">Frequency</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Voltage&quot;, &quot;V&quot;</span>
<span class="s2">                        .SetUnit &quot;Resistance&quot;, &quot;Ohm&quot;</span>
<span class="s2">                        .SetUnit &quot;Inductance&quot;, &quot;nH&quot;</span>
<span class="s2">                        .SetUnit &quot;Temperature&quot;, &quot;</span><span class="si">{</span><span class="n">Temperature</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Time&quot;, &quot;</span><span class="si">{</span><span class="n">Time</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Current&quot;, &quot;A&quot;</span>
<span class="s2">                        .SetUnit &quot;Conductance&quot;, &quot;S&quot;</span>
<span class="s2">                        .SetUnit &quot;Capacitance&quot;, &quot;pF&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                ThermalSolver.AmbientTemperature &quot;0&quot;</span>
<span class="s2">                Plot.DrawBox &quot;True&quot;</span>
<span class="s2">                    With Background</span>
<span class="s2">                        .Type &quot;</span><span class="si">{</span><span class="n">Type</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Epsilon &quot;1.0&quot;</span>
<span class="s2">                        .Mu &quot;1.0&quot;</span>
<span class="s2">                        .Rho &quot;1.204&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;0.026&quot;</span>
<span class="s2">                        .SpecificHeat &quot;1005&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .XminSpace &quot;</span><span class="si">{</span><span class="n">Xmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .XmaxSpace &quot;</span><span class="si">{</span><span class="n">Xmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .YminSpace &quot;</span><span class="si">{</span><span class="n">Ymin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .YmaxSpace &quot;</span><span class="si">{</span><span class="n">Ymax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZminSpace &quot;</span><span class="si">{</span><span class="n">Zmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZmaxSpace &quot;</span><span class="si">{</span><span class="n">Zmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With Boundary</span>
<span class="s2">                        .Xmin &quot;</span><span class="si">{</span><span class="n">XminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xmax &quot;</span><span class="si">{</span><span class="n">XmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ymin &quot;</span><span class="si">{</span><span class="n">YminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ymax &quot;</span><span class="si">{</span><span class="n">YmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zmin &quot;</span><span class="si">{</span><span class="n">ZminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zmax &quot;</span><span class="si">{</span><span class="n">ZmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xsymmetry &quot;</span><span class="si">{</span><span class="n">XSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ysymmetry &quot;</span><span class="si">{</span><span class="n">YSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zsymmetry &quot;</span><span class="si">{</span><span class="n">ZSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With Solver</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .WavelengthRange &quot;</span><span class="si">{</span><span class="n">WavelengthMin</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">WavelengtMax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With Mesh</span>
<span class="s2">                        .MergeThinPECLayerFixpoints &quot;True&quot;</span>
<span class="s2">                        .RatioLimit &quot;20&quot;</span>
<span class="s2">                        .AutomeshRefineAtPecLines &quot;True&quot;, &quot;6&quot;</span>
<span class="s2">                        .FPBAAvoidNonRegUnite &quot;True&quot;</span>
<span class="s2">                        .ConsiderSpaceForLowerMeshLimit &quot;False&quot;</span>
<span class="s2">                        .MinimumStepNumber &quot;5&quot;</span>
<span class="s2">                        .AnisotropicCurvatureRefinement &quot;True&quot;</span>
<span class="s2">                        .AnisotropicCurvatureRefinementFSM &quot;True&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With MeshSettings</span>
<span class="s2">                        .SetMeshType &quot;Hex&quot;</span>
<span class="s2">                        .Set &quot;RatioLimitGeometry&quot;, &quot;20&quot;</span>
<span class="s2">                        .Set &quot;EdgeRefinementOn&quot;, &quot;1&quot;</span>
<span class="s2">                        .Set &quot;EdgeRefinementRatio&quot;, &quot;6&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With MeshSettings</span>
<span class="s2">                        .SetMeshType &quot;Tet&quot;</span>
<span class="s2">                        .Set &quot;VolMeshGradation&quot;, &quot;1.5&quot;</span>
<span class="s2">                        .Set &quot;SrfMeshGradation&quot;, &quot;1.5&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With MeshSettings</span>
<span class="s2">                        .SetMeshType &quot;HexTLM&quot;</span>
<span class="s2">                        .Set &quot;RatioLimitGeometry&quot;, &quot;20&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                MeshAdaption3D.SetAdaptionStrategy &quot;Energy&quot;</span>
<span class="s2">                ChangeProblemType &quot;Optical&quot;</span>
<span class="s2">                    With MeshSettings</span>
<span class="s2">                        .SetMeshType &quot;Hex&quot;</span>
<span class="s2">                        .Set &quot;Version&quot;, 1%</span>
<span class="s2">                    End With</span>

<span class="s2">                    With Mesh</span>
<span class="s2">                        .MeshType &quot;PBA&quot;</span>
<span class="s2">                    End With</span>

<span class="s2">                ChangeSolverType(&quot;HF Time Domain&quot;)</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set optical simulation&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>






      
    <span class="c1"># Set Optical Simulation Domain </span>
<div class="viewcode-block" id="CST_Commands.setElectricalSimulationProperties">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setElectricalSimulationProperties">[docs]</a>
    <span class="k">def</span> <span class="nf">setElectricalSimulationProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set electrical simulation properties</span>

<span class="sd">            TODO : The function need to be expands so more parameters such as mesh properties can be added!</span>

<span class="sd">            Args: Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                    Parameters[&#39;Dimensions&#39;] : (str) Unit Leghts</span>
<span class="sd">                    Parameters[&#39;Frequency&#39;]  : (str) Frequency Units</span>
<span class="sd">                    Parameters[&#39;Time&#39;] : (str) Time Units</span>
<span class="sd">                    Parameters[&#39;Temperature&#39;] : (str) Temperature Units</span>
<span class="sd">                    Parameters[&quot;Type Background&quot;] : (str) Background Type</span>
<span class="sd">                    Parameters[&quot;Xmin Background&quot;] : (int/float) Backgroun X min span</span>
<span class="sd">                    Parameters[&quot;Xmax Background&quot;] : (int/float) Background X max span</span>
<span class="sd">                    Parameters[&quot;Ymin Background&quot;] : (int/float) Backgroun Y min span</span>
<span class="sd">                    Parameters[&quot;Ymax Background&quot;] : (int/float) Backgroun Y max span</span>
<span class="sd">                    Parameters[&quot;Zmin Background&quot;] : (int/float) Backgroun Z min span</span>
<span class="sd">                    Parameters[&quot;Zmax Background&quot;] : (int/float) Backgroun Z max span</span>
<span class="sd">                    Parameters[&quot;Min Frequency&quot;] : (int/float) Min frequency</span>
<span class="sd">                    Parameters[&quot;Max Frequency&quot;] : (int/float) Max frequency</span>
<span class="sd">                    Parameters[&quot;Xmin Boundary&quot;] : (int/float) Min X boundary</span>
<span class="sd">                    Parameters[&quot;Xmax Boundary&quot;] : (int/float) Max X boundary</span>
<span class="sd">                    Parameters[&quot;Ymin Boundary&quot;] : (int/float) Min Y boundary</span>
<span class="sd">                    Parameters[&quot;Ymax Boundary&quot;] : (int/float) Max Y boundary</span>
<span class="sd">                    Parameters[&quot;Zmin Boundary&quot;] : (int/float) Min Z boundary</span>
<span class="sd">                    Parameters[&quot;Zmax Boundary&quot;] : (int/float) Max Z boundary</span>
<span class="sd">                    Parameters[&quot;Xsymmetry Boundary&quot;] : (int/float) set symetrie to the X boundary</span>
<span class="sd">                    Parameters[&quot;Ysymmetry Boundary&quot;] : (int/float) set symetrie to the Y boundary</span>
<span class="sd">                    Parameters[&quot;Zsymmetry Boundary&quot;] : (int/float) set symetrie to the Z boundary</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Units Properties</span>
        <span class="n">Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">]</span> 
        <span class="n">Frequency</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> 
        <span class="n">Time</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> 
        <span class="n">Temperature</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> 

        <span class="c1"># Set Background</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>
        <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">]</span> 
        <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">]</span>
        <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">]</span> 
        <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">]</span>
        <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">]</span> 
        <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">]</span>


        <span class="c1"># Operational Frequency </span>
        <span class="n">FreqMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Frequency&quot;</span><span class="p">]</span>
        <span class="n">FreqMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Frequency&quot;</span><span class="p">]</span>


        <span class="c1"># Set Boundary</span>
        <span class="n">XminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">XmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span> 
        <span class="n">XSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span> 
        <span class="n">YSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
        <span class="n">ZSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span> 

        <span class="c1"># # Mesh Settings</span>
        <span class="c1"># MeshType = Parameters[&quot;Mesh Type&quot;] </span>
        <span class="c1"># CellNear = Parameters[&quot;Mesh Cells Near Object&quot;] </span>
        <span class="c1"># CellFar = Parameters[&quot;Mesh Cells far Object&quot;] </span>




        <span class="c1"># VBA Code</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Units</span>
<span class="s2">                        .SetUnit &quot;Length&quot;, &quot;</span><span class="si">{</span><span class="n">Length</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Frequency&quot;, &quot;</span><span class="si">{</span><span class="n">Frequency</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Voltage&quot;, &quot;V&quot;</span>
<span class="s2">                        .SetUnit &quot;Resistance&quot;, &quot;Ohm&quot;</span>
<span class="s2">                        .SetUnit &quot;Inductance&quot;, &quot;nH&quot;</span>
<span class="s2">                        .SetUnit &quot;Temperature&quot;, &quot;</span><span class="si">{</span><span class="n">Temperature</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Time&quot;, &quot;</span><span class="si">{</span><span class="n">Time</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .SetUnit &quot;Current&quot;, &quot;A&quot;</span>
<span class="s2">                        .SetUnit &quot;Conductance&quot;, &quot;S&quot;</span>
<span class="s2">                        .SetUnit &quot;Capacitance&quot;, &quot;pF&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                ThermalSolver.AmbientTemperature &quot;0&quot;</span>
<span class="s2">                Plot.DrawBox &quot;True&quot;</span>
<span class="s2">                    With Background</span>
<span class="s2">                        .Type &quot;</span><span class="si">{</span><span class="n">Type</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Epsilon &quot;1.0&quot;</span>
<span class="s2">                        .Mu &quot;1.0&quot;</span>
<span class="s2">                        .Rho &quot;1.204&quot;</span>
<span class="s2">                        .ThermalType &quot;Normal&quot;</span>
<span class="s2">                        .ThermalConductivity &quot;0.026&quot;</span>
<span class="s2">                        .SpecificHeat &quot;1005&quot;, &quot;J/K/kg&quot;</span>
<span class="s2">                        .XminSpace &quot;</span><span class="si">{</span><span class="n">Xmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .XmaxSpace &quot;</span><span class="si">{</span><span class="n">Xmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .YminSpace &quot;</span><span class="si">{</span><span class="n">Ymin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .YmaxSpace &quot;</span><span class="si">{</span><span class="n">Ymax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZminSpace &quot;</span><span class="si">{</span><span class="n">Zmin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .ZmaxSpace &quot;</span><span class="si">{</span><span class="n">Zmax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With Boundary</span>
<span class="s2">                        .Xmin &quot;</span><span class="si">{</span><span class="n">XminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xmax &quot;</span><span class="si">{</span><span class="n">XmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ymin &quot;</span><span class="si">{</span><span class="n">YminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ymax &quot;</span><span class="si">{</span><span class="n">YmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zmin &quot;</span><span class="si">{</span><span class="n">ZminBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zmax &quot;</span><span class="si">{</span><span class="n">ZmaxBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Xsymmetry &quot;</span><span class="si">{</span><span class="n">XSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Ysymmetry &quot;</span><span class="si">{</span><span class="n">YSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Zsymmetry &quot;</span><span class="si">{</span><span class="n">ZSimetryBound</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    With Solver</span>
<span class="s2">                        .Reset</span>
<span class="s2">                        .FrequencyRange &quot;</span><span class="si">{</span><span class="n">FreqMin</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">FreqMax</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                        Mesh.MinimumCurvatureRefinement &quot;150&quot;</span>
<span class="s2">                        With MeshSettings</span>
<span class="s2">                            .SetMeshType &quot;HexTLM&quot;</span>
<span class="s2">                            .Set &quot;StepsPerWaveNear&quot;, &quot;</span><span class="si">{</span><span class="n">CellNear</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Set &quot;StepsPerWaveFar&quot;, &quot;</span><span class="si">{</span><span class="n">CellFar</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .Set &quot;StepsPerBoxNear&quot;, &quot;</span><span class="si">{</span><span class="n">CellNear</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                        .Set &quot;StepsPerBoxFar&quot;, &quot;</span><span class="si">{</span><span class="n">CellFar</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .Set &quot;RatioLimitGeometry&quot;, &quot;15&quot;</span>
<span class="s2">                        End With</span>
<span class="s2">                        With MeshSettings</span>
<span class="s2">                            .SetMeshType &quot;Hex&quot;</span>
<span class="s2">                            .Set &quot;Version&quot;, 1%</span>
<span class="s2">                        End With</span>
<span class="s2">                        With Mesh</span>
<span class="s2">                            .MeshType &quot;PBA&quot;</span>
<span class="s2">                        End With</span>
<span class="s2">                        ChangeSolverType(&quot;HF Time Domain&quot;)</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set electrical simulation&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>




<div class="viewcode-block" id="CST_Commands.ChangeSolverType">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.ChangeSolverType">[docs]</a>
    <span class="k">def</span> <span class="nf">ChangeSolverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Change solver type</span>

<span class="sd">            TODO: Include the rest of the solver types. For now only time is available!</span>

<span class="sd">         Args: Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                    Parameters[&#39;Type&#39;] : (str) Solver type. Can be:</span>
<span class="sd">                                        Parameters[&#39;Type&#39;] = &quot;Time&quot;</span>

<span class="sd">         Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Type</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
            <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        ChangeSolverType &quot;HF Time Domain&quot;</span>
<span class="s2">                        &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;change solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">pass</span></div>

    



<div class="viewcode-block" id="CST_Commands.setDomainSolverType">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.setDomainSolverType">[docs]</a>
    <span class="k">def</span> <span class="nf">setDomainSolverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Domein solver type</span>

<span class="sd">        Args: Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                    Parameters[&#39;Domain&#39;] : (str) Solver domain. Can be:</span>
<span class="sd">                                        &quot;Time&quot;</span>
<span class="sd">                                        &quot;Freq&quot;</span>
<span class="sd">                                        &quot;EigenMode&quot;</span>
<span class="sd">                                        &quot;Integral&quot;</span>
<span class="sd">                                        &quot;Asymptotic&quot;</span>
<span class="sd">                                        &quot;Multilayer&quot;</span>

<span class="sd">         Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#Set Parameters</span>
        <span class="n">Domain</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Domain&quot;</span><span class="p">]</span>

        <span class="n">domain_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Freq&quot;</span><span class="p">,</span> <span class="s2">&quot;EigenMode&quot;</span><span class="p">,</span> <span class="s2">&quot;Integral&quot;</span><span class="p">,</span> <span class="s2">&quot;Asymptotic&quot;</span><span class="p">,</span> <span class="s2">&quot;Multilayer&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Domain</span> <span class="ow">in</span> <span class="n">domain_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;Time&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span> <span class="s2">&quot;HF Time Domain&quot;</span>
            <span class="k">elif</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;Freq&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span> <span class="s2">&quot;HF Frequency Domain&quot;</span>
            <span class="k">elif</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;EigenMode&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span> <span class="s2">&quot;HF Eigenmode&quot;</span>
            <span class="k">elif</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;Integral&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span>  <span class="s2">&quot;HF IntegralEq&quot;</span>
            <span class="k">elif</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;Asymptotic&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span> <span class="s2">&quot;HF Asymptotic&quot;</span>
            <span class="k">elif</span> <span class="n">Domain</span> <span class="o">==</span> <span class="s2">&quot;Multilayer&quot;</span><span class="p">:</span>
                <span class="n">domain_type</span> <span class="o">=</span> <span class="s2">&quot;HF Multilayer&quot;</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    ChangeSolverType &quot;</span><span class="si">{</span><span class="n">domain_type</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set freq solver&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>



<span class="c1">############################################################################</span>
<span class="c1"># Monitora</span>
<span class="c1">############################################################################</span>


<div class="viewcode-block" id="CST_Commands.CreateEfieldMonitor">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.CreateEfieldMonitor">[docs]</a>
    <span class="k">def</span> <span class="nf">CreateEfieldMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Monitor</span>

<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                                Parameters[&quot;Monitor Wavelength&quot;] : Int/float. This will set the wavelength. For this function</span>
<span class="sd">                                and only for this function you need to give the exact number. So 1.55 um will be Parameters[&quot;Wavelength&quot;]  = 1.55e-6</span>
<span class="sd">                                Parameters[&quot;Monitor Frequency&quot;] : Set Frequency of the Monitor</span>
<span class="sd">                                Parameters[&quot;Domain&quot;] : Str can be &quot;Frequency&quot; or &quot;Wavelength&quot;</span>
<span class="sd">                                Parameters[&quot;Monitor Type&quot;] : str with monitor Type. Can be one of :</span>
<span class="sd">                                    &quot;Efield&quot;, &quot;Hfield&quot;, &quot;Surfacecurrent&quot;, &quot;Powerflow&quot;, &quot;Current&quot;,</span>
<span class="sd">                                    &quot;Powerloss&quot;, &quot;Eenergy&quot;, &quot;Elossdens&quot;, &quot;Lossdens&quot;, &quot;Henergy&quot;, </span>
<span class="sd">                                    &quot;Farfield&quot;, &quot;Fieldsource&quot;, &quot;Spacecharge&quot;, &quot;ParticleCurrentDensity&quot;, &quot;Electrondensity&quot; </span>
<span class="sd">                                </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Error massage</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">MonitorType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Monitor Type&quot;</span><span class="p">]</span>
        <span class="n">Domain</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Domain&quot;</span><span class="p">]</span>
        <span class="n">Types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Efield&quot;</span><span class="p">,</span> <span class="s2">&quot;Hfield&quot;</span><span class="p">,</span> <span class="s2">&quot;Surfacecurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Powerflow&quot;</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">,</span> <span class="s2">&quot;Powerloss&quot;</span><span class="p">,</span> <span class="s2">&quot;Eenergy&quot;</span><span class="p">,</span> <span class="s2">&quot;Elossdens&quot;</span><span class="p">,</span> <span class="s2">&quot;Lossdens&quot;</span><span class="p">,</span> <span class="s2">&quot;Henergy&quot;</span><span class="p">,</span> <span class="s2">&quot;Farfield&quot;</span><span class="p">,</span> <span class="s2">&quot;Fieldsource&quot;</span><span class="p">,</span> <span class="s2">&quot;Spacecharge&quot;</span><span class="p">,</span> <span class="s2">&quot;ParticleCurrentDensity&quot;</span><span class="p">,</span> <span class="s2">&quot;Electrondensity&quot;</span> <span class="p">]</span>
    
        

        <span class="k">if</span> <span class="n">MonitorType</span> <span class="ow">in</span> <span class="n">Types</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Monitor Frequency&quot;</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># if Parameters[&quot;Monitor Frequency&quot;] != None:</span>
                <span class="n">Freq</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Monitor Frequency&quot;</span><span class="p">]</span>
                <span class="n">Name</span> <span class="o">=</span> <span class="n">MonitorType</span> <span class="o">+</span> <span class="s1">&#39; (wl=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Freq</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
                <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Monitor</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Domain &quot;</span><span class="si">{</span><span class="n">Domain</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .FieldType &quot;</span><span class="si">{</span><span class="n">MonitorType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .MonitorValue &quot;</span><span class="si">{</span><span class="n">Freq</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .UseSubvolume &quot;False&quot;</span>
<span class="s2">                    .Coordinates &quot;Structure&quot;</span>
<span class="s2">                    .SetSubvolume &quot;-5.5&quot;, &quot;2.5&quot;, &quot;-3.5&quot;, &quot;3.5&quot;, &quot;-2.5&quot;, &quot;3.8&quot;</span>
<span class="s2">                    .SetSubvolumeOffset &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;</span>
<span class="s2">                    .SetSubvolumeInflateWithOffset &quot;False&quot;</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;create Efield monitor&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">Wavelength</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Monitor Wavelength&quot;</span><span class="p">]</span>
                <span class="n">Name</span> <span class="o">=</span> <span class="n">MonitorType</span> <span class="o">+</span> <span class="s1">&#39; (wl=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Wavelength</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
                <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Monitor</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Domain &quot;</span><span class="si">{</span><span class="n">Domain</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .FieldType &quot;</span><span class="si">{</span><span class="n">MonitorType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .MonitorValue &quot;</span><span class="si">{</span><span class="n">Wavelength</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .UseSubvolume &quot;False&quot;</span>
<span class="s2">                    .Coordinates &quot;Structure&quot;</span>
<span class="s2">                    .SetSubvolume &quot;-5.5&quot;, &quot;2.5&quot;, &quot;-3.5&quot;, &quot;3.5&quot;, &quot;-2.5&quot;, &quot;3.8&quot;</span>
<span class="s2">                    .SetSubvolumeOffset &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;</span>
<span class="s2">                    .SetSubvolumeInflateWithOffset &quot;False&quot;</span>
<span class="s2">                    .Create</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>   
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameters[&#39;Monitor Type&#39;] is not in allowed types. Please choose one of the following types: [&#39;Efield&#39;, &#39;Hfield&#39;, &#39;Surfacecurrent&#39;, &#39;Powerflow&#39;, &#39;Current&#39;, &#39;Powerloss&#39;, &#39;Eenergy&#39;, &#39;Elossdens&#39;, &#39;Lossdens&#39;, &#39;Henergy&#39;, &#39;Farfield&#39;, &#39;Fieldsource&#39;, &#39;Spacecharge&#39;, &#39;ParticleCurrentDensity&#39;, &#39;Electrondensity&#39;]&quot;</span><span class="p">)</span></div>




<span class="c1">############################################################################</span>
<span class="c1"># Mesh</span>
<span class="c1">############################################################################</span>

<div class="viewcode-block" id="CST_Commands.SetMesh">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.SetMesh">[docs]</a>
    <span class="k">def</span> <span class="nf">SetMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the type of the mesh. The user can define the mesh cells per wavelength near and far</span>
<span class="sd">            from the simulations object.</span>
<span class="sd">        Args:</span>
<span class="sd">            Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                                Parameters[&quot;Mesh Type&quot;] : str Type of the Mesh. You can choose between:  </span>
<span class="sd">                                                        PBA - Hexahedral mesh with Perfect Boundary Approximation</span>
<span class="sd">                                                        HexahedralTLM</span>
<span class="sd">                                                        CFD</span>
<span class="sd">                                                        CFDNew</span>
<span class="sd">                                                        Staircase - Hexahedral mesh with staircase cells</span>
<span class="sd">                                                        Tetrahedral - Tetrahedral mesh</span>
<span class="sd">                                                        Surface - Surface mesh</span>
<span class="sd">                                                        SurfaceMLS - urface multi layer mesh</span>
<span class="sd">                                                        Planar - Planar 2D mesh</span>
<span class="sd">                                Parameters[&quot;Mesh Cells Near Object&quot;] : int Cells per Wavelength near the simulation object</span>
<span class="sd">                                Parameters[&quot;Mesh Cells far Object&quot;] : int Cells per Wavelength far from the simulation object</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: String with VBA Code </span>

<span class="sd">        &quot;&quot;&quot;</span>
        

        <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Type&quot;</span><span class="p">]</span>
        <span class="n">CellNear</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells Near Object&quot;</span><span class="p">]</span>
        <span class="n">CellFar</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells far Object&quot;</span><span class="p">]</span>


        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            With Mesh</span>
<span class="s2">            .MeshType &quot;</span><span class="si">{</span><span class="n">MeshType</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">            .SetCreator &quot;High Frequency&quot;</span>
<span class="s2">            End With</span>
<span class="s2">            nWith MeshSettings</span>
<span class="s2">            .SetMeshType &quot;Hex&quot;</span>
<span class="s2">            .Set &quot;Version&quot;, 1%</span>
<span class="s2">            .Set &quot;StepsPerWaveNear&quot;, &quot;</span><span class="si">{</span><span class="n">CellNear</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">            .Set &quot;StepsPerWaveFar&quot;, &quot;</span><span class="si">{</span><span class="n">CellFar</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">            .Set &quot;WavelengthRefinementSameAsNear&quot;, &quot;0&quot; </span>
<span class="s2">            .Set &quot;StepsPerBoxNear&quot;, &quot;</span><span class="si">{</span><span class="n">CellNear</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">            .Set &quot;StepsPerBoxFar&quot;, &quot;</span><span class="si">{</span><span class="n">CellFar</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">            .Set &quot;MaxStepNear&quot;, &quot;0&quot;</span>
<span class="s2">            .Set &quot;MaxStepFar&quot;, &quot;0&quot;</span>
<span class="s2">            .Set &quot;ModelBoxDescrNear&quot;, &quot;maxedge&quot;</span>
<span class="s2">            .Set &quot;ModelBoxDescrFar&quot;, &quot;maxedge&quot;</span>
<span class="s2">            .Set &quot;UseMaxStepAbsolute&quot;, &quot;0&quot;</span>
<span class="s2">            .Set &quot;GeometryRefinementSameAsNear&quot;, &quot;0&quot;</span>
<span class="s2">            End With</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="s2">&quot;set mesh&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>






<span class="c1">############################################################################</span>
<span class="c1"># Translations of objects</span>
<span class="c1">############################################################################</span>

    

<div class="viewcode-block" id="CST_Commands.RotationTranslation">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.RotationTranslation">[docs]</a>
    <span class="k">def</span> <span class="nf">RotationTranslation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotation Translation function</span>

<span class="sd">            Args: Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                    Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                    Parameters[&quot;Angle X&quot;] : (int/float) X Angle of rotation</span>
<span class="sd">                    Parameters[&quot;Angle Y&quot;] : (int/float) Y Angle of rotation</span>
<span class="sd">                    Parameters[&quot;Angle Z&quot;] : (int/float) Z Angle of rotation</span>


<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
        <span class="n">AngleX</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle X&quot;</span><span class="p">]</span>
        <span class="n">AngleY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Y&quot;</span><span class="p">]</span>
        <span class="n">AngleZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Z&quot;</span><span class="p">]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    With Transform</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Origin &quot;ShapeCenter&quot;</span>
<span class="s2">                    .Center &quot;0&quot;, &quot;0&quot;, &quot;0&quot;</span>
<span class="s2">                    .Angle &quot;</span><span class="si">{</span><span class="n">AngleX</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">AngleY</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">AngleZ</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .MultipleObjects &quot;False&quot;</span>
<span class="s2">                    .GroupObjects &quot;False&quot;</span>
<span class="s2">                    .Repetitions &quot;1&quot;</span>
<span class="s2">                    .MultipleSelection &quot;False&quot;</span>
<span class="s2">                    .Transform &quot;Curve&quot;, &quot;Rotate&quot;</span>
<span class="s2">                    End With</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rotational translation&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>





<div class="viewcode-block" id="CST_Commands.Translation">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation">[docs]</a>
    <span class="k">def</span> <span class="nf">Translation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Translation function</span>

<span class="sd">            Args: Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                    Parameters[&quot;Translate Type&quot;] : (str) Type of translation. Can be:</span>
<span class="sd">                                                    &quot;Translate&quot;</span>
<span class="sd">                                                    &quot;Scale&quot;</span>
<span class="sd">                                                    &quot;Rotate&quot;</span>
<span class="sd">                    If Parameters[&quot;Translate Type&quot;] = &quot;Translate&quot;</span>
<span class="sd">                        Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                        Parameters[&quot;Object to rotate&quot;] : (str) The object you wanna rotate. If solid</span>
<span class="sd">                            Parameters[&quot;Object to rotate&quot;] = &quot;Shape&quot;, if Curve Parameters[&quot;Object to rotate&quot;] = &quot;Curve&quot;</span>
<span class="sd">                        Parameters[&quot;Position&quot;] : array with (int/float) with position parameters. For [&quot;X&quot;, &quot;Y&quot; , &quot;Z&quot;] directions </span>
<span class="sd">                            For Example -&gt; Parameters[&quot;Position&quot;] = [1,2,3]      </span>
<span class="sd">                    If Parameters[&quot;Translate Type&quot;] = &quot;Scale&quot;</span>
<span class="sd">                         Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                         Parameters[&quot;Center Positions&quot;] : array with (int/float) with Center position for scale operation. For [&quot;X&quot;, &quot;Y&quot; , &quot;Z&quot;] directions </span>
<span class="sd">                            For Example -&gt; Parameters[&quot;Center Positions&quot;] = [1,2,3]     </span>
<span class="sd">                         Parameters[&quot;Scale Factors&quot;] : array with (int/float) with Scale factor. For [&quot;X&quot;, &quot;Y&quot; , &quot;Z&quot;] directions </span>
<span class="sd">                            For Example -&gt; Parameters[&quot;Scale Factors&quot;] = [1,2,3]     </span>
<span class="sd">                    If Parameters[&quot;Translate Type&quot;] = &quot;Rotate&quot;</span>
<span class="sd">                        Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                        Parameters[&quot;Object to rotate&quot;] : (str) The object you wanna rotate. If solid</span>
<span class="sd">                            Parameters[&quot;Object to rotate&quot;] = &quot;Shape&quot;, if Curve Parameters[&quot;Object to rotate&quot;] = &quot;Curve&quot;</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;] : array with (int/float) with Center position for scale operation. For [&quot;X&quot;, &quot;Y&quot; , &quot;Z&quot;] directions </span>
<span class="sd">                            For Example -&gt; Parameters[&quot;Center Positions&quot;] = [1,2,3]</span>
<span class="sd">                        Parameters[&quot;Angle Values&quot;] : array with (int/float) with Scale factor. For [&quot;X&quot;, &quot;Y&quot; , &quot;Z&quot;] directions </span>
<span class="sd">                            For Example -&gt; Parameters[&quot;Angle Values&quot;] = [1,2,3]</span>

<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Translate Type&quot;</span><span class="p">]</span>
        <span class="n">Type_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Translate&quot;</span><span class="p">,</span> <span class="s2">&quot;Scale&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotate&quot;</span><span class="p">]</span>
        
        
        

        <span class="k">if</span> <span class="n">Type</span> <span class="ow">in</span> <span class="n">Type_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;Translate&quot;</span><span class="p">:</span>
                <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
                <span class="n">PosX</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">PosY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">PosZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">OBJ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">OBJ</span> <span class="o">!=</span> <span class="s2">&quot;Curve&quot;</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;     .AutoDestination &quot;True&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                            With Transform</span>
<span class="s2">                            .Reset</span>
<span class="s2">                            .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .Vector &quot;</span><span class="si">{</span><span class="n">PosX</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">PosY</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">PosZ</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            .UsePickedPoints &quot;False&quot;</span>
<span class="s2">                            .InvertPickedPoints &quot;False&quot;</span>
<span class="s2">                            .MultipleObjects &quot;False&quot;</span>
<span class="s2">                            .GroupObjects &quot;False&quot;</span>
<span class="s2">                            .Repetitions &quot;1&quot;</span>
<span class="s2">                            .MultipleSelection &quot;False&quot;</span>
<span class="s2">                            </span><span class="si">{</span><span class="n">auto_destination</span><span class="si">}</span><span class="s2">    </span>
<span class="s2">                            .Transform &quot;</span><span class="si">{</span><span class="n">OBJ</span><span class="si">}</span><span class="s2">&quot;, &quot;Translate</span>
<span class="s2">                            End With</span>
<span class="s2">                            &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;translation </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;Scale&quot;</span><span class="p">:</span>  
                <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
                <span class="n">CenterPos</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span>
                <span class="n">ScaleFactor</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Scale Factors&quot;</span><span class="p">]</span>
                <span class="n">OBJ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">OBJ</span> <span class="o">!=</span> <span class="s2">&quot;Curve&quot;</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;     .AutoDestination &quot;True&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="s2">&quot;Origin&quot;</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">Origin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Origin&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Origin</span> <span class="o">=</span> <span class="s2">&quot;Free&quot;</span>
                <span class="n">vba_code2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;                                        </span>
<span class="s2">                            With Transform </span>
<span class="s2">                                 .Reset </span>
<span class="s2">                                 .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                                 .Origin &quot;Free&quot; </span>
<span class="s2">                                 .Center &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                                 .ScaleFactor &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                                 .MultipleObjects &quot;False&quot; </span>
<span class="s2">                                 .GroupObjects &quot;False&quot; </span>
<span class="s2">                                 .Repetitions &quot;1&quot; </span>
<span class="s2">                                 .MultipleSelection &quot;False&quot; </span>
<span class="s2">                                 </span><span class="si">{</span><span class="n">auto_destination</span><span class="si">}</span><span class="s2">    </span>
<span class="s2">                                 .Transform &quot;</span><span class="si">{</span><span class="n">OBJ</span><span class="si">}</span><span class="s2">&quot;, &quot;Scale&quot; </span>
<span class="s2">                            End With</span>
<span class="s2">                         &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;translation scale </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;Rotate&quot;</span><span class="p">:</span>
                <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
                <span class="n">CenterPos</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span>
                <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span>
                <span class="n">OBJ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Object to rotate&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">OBJ</span> <span class="o">!=</span> <span class="s2">&quot;Curve&quot;</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;     .AutoDestination &quot;True&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">auto_destination</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="s2">&quot;Origin&quot;</span> <span class="ow">in</span> <span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">Origin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Origin&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Origin</span> <span class="o">=</span> <span class="s2">&quot;Free&quot;</span>

                <span class="n">vba_code3</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                With Transform</span>
<span class="s2">                    .Reset</span>
<span class="s2">                    .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Origin &quot;</span><span class="si">{</span><span class="n">Origin</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Center &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .Angle &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                    .MultipleObjects &quot;False&quot;</span>
<span class="s2">                    .GroupObjects &quot;False&quot;</span>
<span class="s2">                    .Repetitions &quot;1&quot;</span>
<span class="s2">                    .MultipleSelection &quot;False&quot;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">auto_destination</span><span class="si">}</span><span class="s2">     </span>
<span class="s2">                    .Transform &quot;</span><span class="si">{</span><span class="n">OBJ</span><span class="si">}</span><span class="s2">&quot;, &quot;Rotate&quot;</span>
<span class="s2">                End With</span>
<span class="s2">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;translation scale </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code3</span><span class="p">)</span></div>

                        
        
    
<div class="viewcode-block" id="CST_Commands.Translation_Scale">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation_Scale">[docs]</a>
    <span class="k">def</span> <span class="nf">Translation_Scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale tranlation function</span>

<span class="sd">            Args: Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                    Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                    Parameters[&quot;Center Positions&quot;] : (dict) Center position for scale operation</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;X&quot;] : (int/float) Center position X</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;Y&quot;] : (int/float) Center position Y</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;Z&quot;] : (int/float) Center position Z</span>
<span class="sd">                    Parameters[&quot;Scale Factors&quot;] : (dict) Scale factor</span>
<span class="sd">                        Parameters[&quot;Scale Factors&quot;][&quot;X&quot;] : (int/float) Scale factor X</span>
<span class="sd">                        Parameters[&quot;Scale Factors&quot;][&quot;Y&quot;] : (int/float) Scale factor Y</span>
<span class="sd">                        Parameters[&quot;Scale Factors&quot;][&quot;Z&quot;] : (int/float) Scale factor Z</span>
<span class="sd">        </span>
<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
        <span class="n">CenterPos</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span>
        <span class="n">ScaleFactor</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Scale Factors&quot;</span><span class="p">]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;                                        </span>
<span class="s2">                    With Transform </span>
<span class="s2">                         .Reset </span>
<span class="s2">                         .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .Origin &quot;Free&quot; </span>
<span class="s2">                         .Center &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .ScaleFactor &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">ScaleFactor</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .MultipleObjects &quot;False&quot; </span>
<span class="s2">                         .GroupObjects &quot;False&quot; </span>
<span class="s2">                         .Repetitions &quot;1&quot; </span>
<span class="s2">                         .MultipleSelection &quot;False&quot; </span>
<span class="s2">                         .AutoDestination &quot;True&quot; </span>
<span class="s2">                         .Transform &quot;Shape&quot;, &quot;Scale&quot; </span>
<span class="s2">                    End With</span>
<span class="s2">                 &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;translation scale </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

        
        
        
        
<div class="viewcode-block" id="CST_Commands.Translation_Rotation">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Translation_Rotation">[docs]</a>
    <span class="k">def</span> <span class="nf">Translation_Rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotation tranlation function</span>

<span class="sd">            Args: Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                    Parameters[&quot;Name Object&quot;] : (str) Name of the Object that you want to rotate</span>
<span class="sd">                    Parameters[&quot;Center Positions&quot;] : (dict) Center position for scale operation</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;X&quot;] : (int/float) Center position X</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;Y&quot;] : (int/float) Center position Y</span>
<span class="sd">                        Parameters[&quot;Center Positions&quot;][&quot;Z&quot;] : (int/float) Center position Z</span>
<span class="sd">                    Parameters[&quot;Angle Values&quot;] : (dict) Scale factor</span>
<span class="sd">                        Parameters[&quot;Angle Values&quot;][&quot;X&quot;] : (int/float) Angle Value X</span>
<span class="sd">                        Parameters[&quot;Angle Values&quot;][&quot;Y&quot;] : (int/float) Angle Value Y</span>
<span class="sd">                        Parameters[&quot;Angle Values&quot;][&quot;Z&quot;] : (int/float) Angle Value Z</span>
<span class="sd">                </span>
<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
        <span class="n">CenterPos</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Center Positions&quot;</span><span class="p">]</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Values&quot;</span><span class="p">]</span>

        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;                                        </span>
<span class="s2">                    With Transform </span>
<span class="s2">                         .Reset </span>
<span class="s2">                         .Name &quot;</span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .Origin &quot;Free&quot; </span>
<span class="s2">                         .Center &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CenterPos</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .Angle &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">Angle</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot; </span>
<span class="s2">                         .MultipleObjects &quot;False&quot; </span>
<span class="s2">                         .GroupObjects &quot;False&quot; </span>
<span class="s2">                         .Repetitions &quot;1&quot; </span>
<span class="s2">                         .MultipleSelection &quot;False&quot; </span>
<span class="s2">                         .AutoDestination &quot;True&quot; </span>
<span class="s2">                         .Transform &quot;Shape&quot;, &quot;Rotate&quot; </span>
<span class="s2">                    End With</span>

<span class="s2">                 &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;translation scale </span><span class="si">{</span><span class="n">Name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>

    



<div class="viewcode-block" id="CST_Commands.Cut_structures">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.CST_Commands.Cut_structures">[docs]</a>
    <span class="k">def</span> <span class="nf">Cut_structures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cut function</span>

<span class="sd">            Args: Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                    Parameters[&quot;Name Cut Structure&quot;] : (str) Name of the structure to cut</span>
<span class="sd">                    Parameters[&quot;Name Structure to Cut&quot;] : (str) Name Structure to cut the Parameters[&quot;Name Cut Structure&quot;] to.</span>
<span class="sd">                </span>
<span class="sd">            Returns:</span>
<span class="sd">                str: String with VBA Code </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CutElement</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Cut Structure&quot;</span><span class="p">]</span>
        <span class="n">CutterElement</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Structure to Cut&quot;</span><span class="p">]</span>
        <span class="n">vba_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    Solid.Subtract &quot;</span><span class="si">{</span><span class="n">CutElement</span><span class="si">}</span><span class="s2">&quot;, &quot;</span><span class="si">{</span><span class="n">CutterElement</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prj</span><span class="o">.</span><span class="n">model3d</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cur Structure </span><span class="si">{</span><span class="n">CutElement</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vba_code</span><span class="p">)</span></div>
</div>

        
        




<span class="c1">#################################################################################</span>
<span class="c1"># Curves Class</span>
<span class="c1">#################################################################################</span>

<div class="viewcode-block" id="Curves">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.Curves">[docs]</a>
<span class="k">class</span> <span class="nc">Curves</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Curve class is given an Euler Bezier and Cosinis curves (S-Curves). It was created to use the mathematical expressions </span>
<span class="sd">    to assist the above CST wire to solid functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Span_X</span><span class="p">,</span> <span class="n">Span_Y</span><span class="p">,</span> <span class="n">NumberOfPoints</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Curves function</span>

<span class="sd">        Args:</span>
<span class="sd">            Span_X (int): Give an span of the X (Lenght) of the S-Curve</span>
<span class="sd">            Span_Y (int): Give an span of the Y (Lenght) of the S-Curve</span>
<span class="sd">            Number of Points (int): Lenght of the object also an random number can be given. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span> <span class="o">=</span> <span class="n">Span_X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Span_Y</span> <span class="o">=</span> <span class="n">Span_Y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberOfPoints</span> <span class="o">=</span> <span class="n">NumberOfPoints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NumberOfPoints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_Points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_Points</span> <span class="o">=</span> <span class="p">[]</span>
        
        
<div class="viewcode-block" id="Curves.Bezier_Curve">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Bezier_Curve">[docs]</a>
    <span class="k">def</span> <span class="nf">Bezier_Curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Cubic Bezier Polynoms are taken from Wikipedia!</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        curve : 2 dimentional np array</span>
<span class="sd">            curve[:,0] - X Param of the Bezier Curve</span>
<span class="sd">            curve[:,1] - Y Param of the Bezier Curve</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_Points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_Points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(((</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Span_Y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Span_Y</span><span class="p">)))</span>
            
        <span class="n">x_Points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_Points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">y_Points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_Points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  
        <span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x_Points</span><span class="p">,</span> <span class="n">y_Points</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        
        <span class="k">return</span> <span class="n">curve</span></div>

    
    
    
<div class="viewcode-block" id="Curves.Cosinus_Curve">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Cosinus_Curve">[docs]</a>
    <span class="k">def</span> <span class="nf">Cosinus_Curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The cosinus function is SpanY*(cos((pi/(2*SpanX))*t)^2)  ----&gt;&gt; t in the range of 0 to SpanY</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        curve : 2 dimentional np array</span>
<span class="sd">            curve[:,0] - X Param of the Bezier Curve</span>
<span class="sd">            curve[:,1] - Y Param of the Bezier Curve</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Span_Y</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span>
        <span class="n">stepSize</span> <span class="o">=</span> <span class="n">L</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span> <span class="n">stepSize</span><span class="p">)</span> 
        <span class="n">Func</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">))</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  
        <span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">Func</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
        
        <span class="k">return</span> <span class="n">curve</span></div>

    
    
    
    
<div class="viewcode-block" id="Curves.Euler_Curve">
<a class="viewcode-back" href="../../_rst/CST_Constructor.CST_Constructor.html#CST_Constructor.CST_Constructor.Curves.Euler_Curve">[docs]</a>
    <span class="k">def</span> <span class="nf">Euler_Curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Returns a smooth, continuous-curvature Euler S-bend from (0, 0) to (Span_X, Span_Y)</span>
<span class="sd">        using Fresnel integrals and linear curvature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Span_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Span_X</span>
        <span class="n">Span_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Span_Y</span>
        <span class="n">num_pts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NumberOfPoints</span>
        
        <span class="c1"># Arc length parameter</span>
        <span class="c1"># s = np.arange(-1, 1, 2/num_pts)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_pts</span><span class="p">)</span>
        
        <span class="c1"># Fresnel integrals (Euler spiral)</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">fresnel</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="c1"># Normalize to range [-1, 1]</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">C</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">S</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">C</span> <span class="o">/</span> <span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Euler spiral from -90 to +90  makes an S-bend</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Span_X</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">Span_Y</span>
        

        <span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    
        <span class="k">return</span> <span class="n">curve</span></div>
</div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>