

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Functions &mdash; Python CST Script 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Python CST Script
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python CST Script</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">Functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Functions</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.cluster</span>
<span class="kn">import</span> <span class="nn">scipy.constants</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># Add the directory containing the project to sys.path</span>
<span class="n">current_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;__file__&#39;</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_path</span><span class="p">)</span>




<div class="viewcode-block" id="Material">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Material">[docs]</a>
<span class="k">def</span> <span class="nf">Material</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add Anisotropic material to Material Libs</span>

<span class="sd">    Args:</span>
<span class="sd">        Name (str): Name of the Material</span>
<span class="sd">        Values (Dict): Dictionary with the material Values:</span>
<span class="sd">                        Values[&quot;X&quot;] : X Epsilon Value</span>
<span class="sd">                        Values[&quot;Y&quot;] : Y Epsilon Value</span>
<span class="sd">                        Values[&quot;Z&quot;] : Z Epsilon Value</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with the VBA code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Chix = round((Values[&quot;X&quot;] - 1), 2)</span>
    <span class="c1"># Chiy = round((Values[&quot;Y&quot;] - 1), 2)</span>
    <span class="c1"># Chiz = round((Values[&quot;Z&quot;] - 1), 2 )</span>
    <span class="n">Chix</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> 
    <span class="n">Chiy</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> 
    <span class="n">Chiz</span> <span class="o">=</span> <span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>


    <span class="c1"># Add Meterial . Values is array with X, Y and Z Values for the Anisotropic Material Permittivity</span>
    <span class="n">component</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Material&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrqType &quot;All&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;Anisotropic&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MuX &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MuY &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MuZ &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.EpsilonX &#39;</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.EpsilonY &#39;</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.EpsilonZ &#39;</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DispModelEps &quot;nonlinear2nd&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DispCoeff0EpsX &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Chix</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DispCoeff0EpsY &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Chiy</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DispCoeff0EpsZ &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Chiz</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DispModelMu &quot;None&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddDispEpsPole1stOrderX &quot;0&quot;,&quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Color &quot;1&quot;,&quot;0&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>

    <span class="k">return</span> <span class="n">component</span>    </div>






<div class="viewcode-block" id="Material_Silicon">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Material_Silicon">[docs]</a>
<span class="k">def</span> <span class="nf">Material_Silicon</span><span class="p">(</span><span class="n">Name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add silicon to the Material Library</span>

<span class="sd">    Args:</span>
<span class="sd">        Name (str): Name of the Material</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with the VBA code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add Meterial . Values is array with X, Y and Z Values for the Anisotropic Material Permittivity</span>
    <span class="n">component</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Material&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrqType &quot;All&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Epsilon &quot;11.9&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Rho 2330&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalConductivity &quot;148&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalType &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MechanicsType &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SpecificHeat &quot;700&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YoungsModulus &quot;112&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PoissonsRatio &quot;0.28&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Color &quot;0.5&quot;,&quot;0.5&quot;, &quot;0.5&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>

    <span class="k">return</span> </div>





<div class="viewcode-block" id="Material_SiO2">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Material_SiO2">[docs]</a>
<span class="k">def</span> <span class="nf">Material_SiO2</span><span class="p">(</span><span class="n">Name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add silicon dioxide to the Material Library</span>

<span class="sd">    Args:</span>
<span class="sd">        Name (str): Name of the Material</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with the VBA code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add Meterial . Values is array with X, Y and Z Values for the Anisotropic Material Permittivity</span>
    <span class="n">component</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Material&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrqType &quot;All&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Epsilon &quot;2.0851&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Color &quot;0.529&quot;, &quot;0.808&quot;, &quot;0.922&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>

    <span class="k">return</span> <span class="n">component</span></div>





<div class="viewcode-block" id="Material_Au">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Material_Au">[docs]</a>
<span class="k">def</span> <span class="nf">Material_Au</span><span class="p">(</span><span class="n">Name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add gold to the Material Library</span>
<span class="sd">    Args:</span>
<span class="sd">        Name (str): Name of the Material</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with the VBA code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add Meterial Gold.</span>
    <span class="n">component</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Material&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrqType &quot;All&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;lossy metal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMaterialUnit &quot;GHz&quot;, &quot;um&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Sigma &quot;4.561e+007&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Rho &quot;19320&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalConductivity &quot;130&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalType &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SpecificHeat &quot;700&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YoungsModulus &quot;78&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PoissonsRatio &quot;42&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Color &quot;1&quot;,&quot;0.84&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>

    <span class="k">return</span> <span class="n">component</span></div>





<div class="viewcode-block" id="Curve">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Curve">[docs]</a>
<span class="k">def</span> <span class="nf">Curve</span><span class="p">(</span><span class="n">CurveName</span><span class="p">,</span> <span class="n">Points</span><span class="p">):</span>

    <span class="n">CurveName</span>  <span class="o">=</span> <span class="n">CurveName</span>
    <span class="c1"># Extract the first points as starting Points</span>
    <span class="n">Start_PointX</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Start_PointY</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Polygon&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">CurveName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Curve &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">CurveName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Point &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Start_PointX</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Start_PointY</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LineTo &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">CurveData</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CurveData</span></div>




<div class="viewcode-block" id="RotationTranslation">
<a class="viewcode-back" href="../rst/Functions.html#Functions.RotationTranslation">[docs]</a>
<span class="k">def</span> <span class="nf">RotationTranslation</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>


    <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
    <span class="n">AngleX</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle X&quot;</span><span class="p">]</span>
    <span class="n">AngleY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Y&quot;</span><span class="p">]</span>
    <span class="n">AngleZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Angle Z&quot;</span><span class="p">]</span>

    <span class="n">Translate</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Transform&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Origin &quot;ShapeCenter&quot;&#39;</span>  <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Center &quot;0&quot;, &quot;0&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Angle &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">AngleX</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">AngleY</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">AngleZ</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MultipleObjects &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.GroupObjects &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Repetitions &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MultipleSelection &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Transform &quot;Curve&quot;, &quot;Rotate&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">Translate</span></div>




<div class="viewcode-block" id="Translation">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Translation">[docs]</a>
<span class="k">def</span> <span class="nf">Translation</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>

    <span class="n">Name</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Name Object&quot;</span><span class="p">]</span>
    <span class="n">PosX</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position X&quot;</span><span class="p">]</span>
    <span class="n">PosY</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position Y&quot;</span><span class="p">]</span>
    <span class="n">PosZ</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Position Z&quot;</span><span class="p">]</span>

    <span class="n">Translate</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Transform&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Vector &#39;</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PosX</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PosY</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PosZ</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UsePickedPoints &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.InvertPickedPoints &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MultipleObjects &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.GroupObjects &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Repetitions &quot;1&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MultipleSelection &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Transform &quot;Curve&quot;, &quot;Translate&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">Translate</span></div>






<div class="viewcode-block" id="ToSolid">
<a class="viewcode-back" href="../rst/Functions.html#Functions.ToSolid">[docs]</a>
<span class="k">def</span> <span class="nf">ToSolid</span><span class="p">(</span><span class="n">SolidName</span><span class="p">,</span> <span class="n">CurveName</span> <span class="o">=</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span> <span class="n">NameFolder</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Material</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function transfer an function or polynom to solid object.</span>

<span class="sd">    Args:</span>
<span class="sd">        SolidName (str): Name of the solid object</span>
<span class="sd">        CurveName (str, optional): Name of the curve. Defaults to &quot;Polygon&quot;.</span>
<span class="sd">        NameFolder (str, optional): Name of the folder. Defaults to Curve name.</span>
<span class="sd">        Material (str, optional): Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                  in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                  will not be found. Defaults to Aluminum.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Check Curve Name</span>
    <span class="k">if</span> <span class="n">CurveName</span> <span class="o">!=</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
        <span class="n">CurveName</span> <span class="o">=</span> <span class="n">CurveName</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># Folder Name</span>
    <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">CurveName</span>

    <span class="c1"># Material Def</span>
    <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Aluminum&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>



    <span class="n">SolidWire</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Wire&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SolidName &quot;component1:&#39;</span><span class="o">+</span> <span class="n">SolidName</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">CurveName</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Folder &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">NameFolder</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Material &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Material</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.KeepWire &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ConvertToSolidShape&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">SolidWire</span></div>





<div class="viewcode-block" id="Poligon_2D">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Poligon_2D">[docs]</a>
<span class="k">def</span> <span class="nf">Poligon_2D</span><span class="p">(</span><span class="n">WGName</span><span class="p">,</span> <span class="n">Points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the 2D poligon for tRib waveguide</span>

<span class="sd">    Args:</span>
<span class="sd">        WGName (str): Name of the poligon</span>
<span class="sd">        Points (dict): Dictionary with the Points:</span>
<span class="sd">                        Points[&#39;X&#39;] = []</span>
<span class="sd">                        Points[&#39;Y&#39;] = []</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">WGName</span>  <span class="o">=</span> <span class="n">WGName</span>
    <span class="c1"># Extract the first points as starting Points</span>
    <span class="n">Start_PointX</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Start_PointY</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Polygon&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WGName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Curve &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WGName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Point &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Start_PointX</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Start_PointY</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LineTo &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">CurveData</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CurveData</span></div>





<div class="viewcode-block" id="Poligon_3D">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Poligon_3D">[docs]</a>
<span class="k">def</span> <span class="nf">Poligon_3D</span><span class="p">(</span><span class="n">WGName</span><span class="p">,</span> <span class="n">Points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the 2D poligon for tRib waveguide</span>

<span class="sd">    Args:</span>
<span class="sd">        WGName (str): Name of the poligon</span>
<span class="sd">        Points (dict): Dictionary with the Points:</span>
<span class="sd">                        Points[&#39;X&#39;] = []</span>
<span class="sd">                        Points[&#39;Y&#39;] = []</span>
<span class="sd">                        Points[&#39;Z&#39;] = []   </span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">WGName</span>  <span class="o">=</span> <span class="n">WGName</span>
    <span class="c1"># Extract the first points as starting Points</span>
    <span class="n">Start_PointX</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Start_PointY</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Start_PointZ</span> <span class="o">=</span> <span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Polygon3D&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WGName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Curve &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WGName</span>  <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Point &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>  <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Points</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">CurveData</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CurveData</span></div>









<div class="viewcode-block" id="RibWaveguide_ToSolid">
<a class="viewcode-back" href="../rst/Functions.html#Functions.RibWaveguide_ToSolid">[docs]</a>
<span class="k">def</span> <span class="nf">RibWaveguide_ToSolid</span><span class="p">(</span><span class="n">SolidName</span><span class="p">,</span> <span class="n">WaveguideName</span> <span class="o">=</span> <span class="s2">&quot;Rib_Waveguide&quot;</span><span class="p">,</span> <span class="n">WG_Hight</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Angle</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">NameFolder</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Material</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">WGFolderName</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">WGName</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is ToSolid function that will allow the use to create the RibWaveguide. </span>
<span class="sd">       TODO: Murrge the TOSolid and RibWaveguideToSolid functions later on. </span>

<span class="sd">    Args:</span>
<span class="sd">        SolidName (str): Solid name</span>
<span class="sd">        WaveguideName (str, optional): Waveguide Name. Defaults to &quot;Rib_Waveguide&quot;.</span>
<span class="sd">        WG_Hight (int/float, optional): Hight of the waveguide. Defaults to None.</span>
<span class="sd">        Angle (int/float, optional): Side angle of the waveguide. Defaults to None.</span>
<span class="sd">        NameFolder (str, optional): Folder name. Defaults to None.</span>
<span class="sd">        Material (str, optional): Material for of the Bond wire. For now you need to load the material </span>
<span class="sd">                                  in your simulation and then use this function. Otherwise the material </span>
<span class="sd">                                  will not be found. Defaults to None.</span>
<span class="sd">        WGFolderName (str, optional): Name of the folder where the poligon 3D or 2D is created. Defaults to None.</span>
<span class="sd">        WGName (str, optional): Name of the Poligon 3D or 2D. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Error massage</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Check Curve Name</span>
    <span class="k">if</span> <span class="n">WaveguideName</span> <span class="o">!=</span> <span class="s2">&quot;Rib_Waveguide&quot;</span><span class="p">:</span>
        <span class="n">WaveguideName</span> <span class="o">=</span> <span class="n">WaveguideName</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># Folder Name</span>
    <span class="k">if</span> <span class="n">NameFolder</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">NameFolder</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">NameFolder</span> <span class="o">=</span> <span class="n">WaveguideName</span>

    <span class="c1"># Material Def</span>
    <span class="k">if</span> <span class="n">Material</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="s2">&quot;Copper (annealed)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Material</span> <span class="o">=</span> <span class="n">Material</span>

    <span class="c1"># Angle and Height. Pre define Hight = 2 and Angle = 30</span>
    <span class="k">if</span> <span class="n">WG_Hight</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">WG_Hight</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">WG_Hight</span> <span class="o">=</span> <span class="n">WG_Hight</span>

    <span class="k">if</span> <span class="n">Angle</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Angle</span> <span class="o">=</span> <span class="n">Angle</span>

    
     <span class="c1"># Check if Curve Name and Folder Name are given</span>
    <span class="k">if</span> <span class="n">WGFolderName</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">WGName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;To create an Rib Waveguide you need to give the Waveguide Folder Name (WGFolderName) and the Rib Waveguide Name (WGName) that you already gave!&quot;</span><span class="p">)</span>


    <span class="n">SolidWire</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With ExtrudeCurve&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WaveguideName</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Component &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WaveguideName</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Material &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Material</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Thickness &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WG_Hight</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Twistangle &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Taperangle &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Angle</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Curve &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">WGFolderName</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">WGName</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">SolidWire</span></div>






<div class="viewcode-block" id="AddGlobalParameter">
<a class="viewcode-back" href="../rst/Functions.html#Functions.AddGlobalParameter">[docs]</a>
<span class="k">def</span> <span class="nf">AddGlobalParameter</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add Global parameters to the working enviroment</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with the name and value of the parameter.</span>
<span class="sd">                           GlobalParam[&#39;Length&#39;]</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parameters Values and Keys</span>
    <span class="n">Param</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">Values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Param</span><span class="p">)):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">StoreParameter &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Param</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">ParametersAdd</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ParametersAdd</span></div>





<div class="viewcode-block" id="DeleteGlobalParameter">
<a class="viewcode-back" href="../rst/Functions.html#Functions.DeleteGlobalParameter">[docs]</a>
<span class="k">def</span> <span class="nf">DeleteGlobalParameter</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete an Global parameter from the enviroment.</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with the name and value of the parameter.</span>
<span class="sd">                           GlobalParam[&#39;Length&#39;]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parameters Values and Keys</span>
    <span class="n">Param</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Param</span><span class="p">)):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DeleteParameter &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Param</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">ParametersAdd</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ParametersAdd</span></div>






<div class="viewcode-block" id="BackgroundSet">
<a class="viewcode-back" href="../rst/Functions.html#Functions.BackgroundSet">[docs]</a>
<span class="k">def</span> <span class="nf">BackgroundSet</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the Simulation background.</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dic): Dictionary with coordinates for the background. </span>
<span class="sd">                            Parameters[&quot;Type Background&quot;] = str, Type of the Background. Defoult is &quot;Normal&quot;</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">                            Parameters[&quot;Xmin Background&quot;] = int/float</span>
<span class="sd">        Type (str, optional): Type of background material. Cehck CST for more information. Defaults to Normal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Check Background Type</span>
    <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Normal&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>

    <span class="n">BackgroundObj</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span>  \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Background&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ResetBackground&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">Type</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Epsilon &quot;1.0&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1.0&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Rho &quot;1.204&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalType &quot;Normal&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalConductivity &quot;0&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SpecificHeat &quot;1005&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ApplyInAllDirections &quot;False&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">BackgroundObj</span></div>





<div class="viewcode-block" id="SetUnits">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetUnits">[docs]</a>
<span class="k">def</span> <span class="nf">SetUnits</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the Simulation Global Units</span>

<span class="sd">    Args:</span>
<span class="sd">        DictUnits (dict): Dictionary with Units:</span>
<span class="sd">                          DictUnits[&#39;Dimensions&#39;] - Length</span>
<span class="sd">                          DictUnits[&#39;Frequency&#39;] - Frequency</span>
<span class="sd">                          DictUnits[&#39;Time&#39;] - time</span>
<span class="sd">                          DictUnits[&#39;Temperature&#39;] - Temperature</span>
<span class="sd">                          Not nessesery. Can be left out</span>
<span class="sd">                          DictUnits[&#39;Voltage&#39;] - Voltage</span>
<span class="sd">                          DictUnits[&#39;Current&#39;] - Current</span>
<span class="sd">                          DictUnits[&#39;Resistance&#39;] - Resistance</span>
<span class="sd">                          DictUnits[&#39;Conductance&#39;] - Conductance</span>
<span class="sd">                          DictUnits[&#39;Capacitance&#39;] - Capacitance</span>
<span class="sd">                          DictUnits[&#39;Inductance&#39;] - Inductance</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Check Values</span>
    <span class="n">Keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">DictUnits</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Sub Main () &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Units&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="s1">&#39;Dimensions&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Geometry &quot;mm&quot;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Geometry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Frequency&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;hz&quot;</span><span class="p">)</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Frequency &quot;hz&quot;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Frequency &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Time &quot;s&quot;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Time &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Temperature&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;degC&#39;</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Temperature &quot;degC&quot;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Temperature &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Voltage&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Voltage &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Voltage&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Current&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># DictUnits[&#39;Current&#39;] = &#39;A&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Current &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Current&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Resistance&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="c1"># DictUnits[&#39;Resistance&#39;] = &#39;Ohm&#39;</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Resistance &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Resistance&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Conductance&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="c1"># DictUnits[&#39;Conductance&#39;] = &#39;Siemens&#39;</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Conductance &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Conductance&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Capacitance&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="c1"># DictUnits[&#39;Capacitance&#39;] =</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Capacitance &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Capacitance&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Inductance&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Keys</span><span class="p">:</span>
        <span class="c1"># DictUnits[&#39;Inductance&#39;] = &#39;NanoH&#39;</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Inductance &#39;</span> <span class="o">+</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">DictUnits</span><span class="p">[</span><span class="s1">&#39;Inductance&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">)</span>
    <span class="c1"># Units = &#39;Sub Main () &#39; \</span>
    <span class="c1">#             &#39;\n With Units&#39; + \</span>
    <span class="c1">#                 &#39;\n.Geometry &quot;mm&quot;&#39; + \</span>
    <span class="c1">#                 &#39;\n.TemperatureUnit &quot;Kelvin&quot;&#39; + \</span>
    <span class="c1">#                 &#39;\n.Frequency &quot;MHz&quot;&#39; + \</span>
    <span class="c1">#                 &#39;\n.Time &quot;ns&quot;&#39; + \</span>
    <span class="c1">#              &#39;\n End With&#39; + \</span>
    <span class="c1">#         &#39;\n End Sub&#39;</span>


    <span class="c1"># Units = &#39;Sub Main () &#39; \</span>
    <span class="c1">#             &#39;\nWith Units&#39; + \</span>
    <span class="c1">#                 &#39;\n.Geometry (&quot;m&quot;)&#39;+ \</span>
    <span class="c1">#                 &#39;\n.Frequency (&quot;khz&quot;)&#39;+ \</span>
    <span class="c1">#                 &#39;\n.Time (&quot;ns&quot;)&#39;+ \</span>
    <span class="c1">#                 &#39;\n.TemperatureUnit (&quot;kelvin&quot;)&#39;+ \</span>
    <span class="c1">#             &#39;\nEnd With&#39; + \</span>
    <span class="c1">#         &#39;\nEnd Sub&#39;</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span><span class="p">)</span>
    <span class="n">Units</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Units</span></div>





<div class="viewcode-block" id="SetBoundary">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetBoundary">[docs]</a>
<span class="k">def</span> <span class="nf">SetBoundary</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Boundary box Parameters</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Boundary Parameters </span>
<span class="sd">                            Parameters[&quot;Xmin Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Xmax Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Ymin Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Ymax Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Zmin Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Zmax Boundary&quot;] = str </span>
<span class="sd">                            Parameters[&quot;Xsymmetry Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Ysymmetry Boundary&quot;] = str</span>
<span class="sd">                            Parameters[&quot;Zsymmetry Boundary&quot;] = str</span>


<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Boundary parameters</span>
    <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span>
    <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span>
    <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span>
    <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span>
    <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span>
    <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span>
    <span class="n">Xsym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span>
    <span class="n">Ysym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
    <span class="n">Zsym</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span>


    <span class="n">BoundaryData</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Boundary&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xsym</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ysymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ysym</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zsym</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ApplyInAllDirections &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XPeriodicShift &quot;45.0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YPeriodicShift &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZPeriodicShift &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PeriodicUseConstantAngles &quot;True&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetPeriodicBoundaryAngles &quot;30.0&quot;, &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XminPotential &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XmaxPotential &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YminPotential &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YmaxPotential &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZmaxPotential &quot;&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> End Sub&#39;</span>

    <span class="k">return</span> <span class="n">BoundaryData</span></div>




<div class="viewcode-block" id="WaveguidePort">
<a class="viewcode-back" href="../rst/Functions.html#Functions.WaveguidePort">[docs]</a>
<span class="k">def</span> <span class="nf">WaveguidePort</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the Waveguide Port for  </span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Port Parameters</span>
<span class="sd">                            Parameters[&quot;Orientation&quot;] = Str with Port Orientation can be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                        this function an 2 ports will be defined so please give an array with two Oriantations</span>
<span class="sd">                                                        like  Parameters[&quot;Orientation&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                            Parameters[&quot;Coordinates&quot;] = Str witch Coordinates type, &quot;Picks&quot; is the best one!</span>
<span class="sd">                            Parameters[&quot;Span&quot;] = Array with Array of port span [[Ymin, Ymax],[Zmin, Zmax]]</span>
<span class="sd">                            Parameters[&quot;Potential&quot;] = Array with port Potential . For example [1,2]</span>
<span class="sd">                            Parameters[&quot;Port Number&quot;] = Array with Port number [1,2]</span>
<span class="sd">                            Parameters[&quot;Polarity&quot;] = Port Polarity can be be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                    this function an 2 ports will be defined so please give an </span>
<span class="sd">                                                    array with two Polaritys. For example Parameters[&quot;Polarity&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                            Parameters[&quot;Solid Name&quot;] = Name of the Object on witch the Waveguide port will be created. For example &quot;WG:WG1&quot;</span>
<span class="sd">                            Parameters[&quot;Face ID&quot;] = Array with the ID of the two picked faces. For example Parameters[&quot;Face ID&quot;] = [2,4]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parameters to determin port position </span>
    <span class="n">Orientation</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span>
    <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span>
    <span class="c1"># Choose coordinates</span>
    <span class="n">Span11</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span12</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Span21</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span22</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Polarity</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Polarity&quot;</span><span class="p">]</span>
    <span class="n">SolidName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span>
    <span class="n">PickID</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face ID&quot;</span><span class="p">]</span>
    <span class="c1">#Return Ports in Dictionary for one Object 2 Ports can be define </span>
    <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Ports Numbers</span>
    <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

    <span class="c1"># loop true mode sets</span>
    <span class="n">Potentials</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Potential&quot;</span><span class="p">]</span>


    <span class="c1">#Start Loop for Ports</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Potentials</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Port&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortNumber &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NumberOfModes &quot;5&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ReferencePlaneDistance &quot;0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Coordinates &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Orientation &#39;</span> <span class="o">+</span>  <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Orientation</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortOnBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ClipPickedPortToBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AdjustPolarization &quot;True&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PolarizationAngle &quot;0&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="c1">#  &#39;\n.AddPotentialPicked  &#39; + &#39;&quot;&#39; + str(index) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(Polarity[index-1]) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(SolidName) + &#39;&quot;&#39;+ &#39;,&#39; + &#39;&quot;&#39; + str(PickID[index-1]) + &#39;&quot;&#39; + \</span>
        <span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Port</span></div>





<div class="viewcode-block" id="WaveguidePortWithPins">
<a class="viewcode-back" href="../rst/Functions.html#Functions.WaveguidePortWithPins">[docs]</a>
<span class="k">def</span> <span class="nf">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="n">PicParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the Waveguide Port for  </span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Port Parameters</span>
<span class="sd">                            Parameters[&quot;Orientation&quot;] = Str with Port Orientation can be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                        this function an 2 ports will be defined so please give an array with two Oriantations</span>
<span class="sd">                                                        like  Parameters[&quot;Orientation&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                            Parameters[&quot;Coordinates&quot;] = Str witch Coordinates type, &quot;Picks&quot; is the best one!</span>
<span class="sd">                            Parameters[&quot;Span&quot;] = Array with Array of port span [[Ymin, Ymax],[Zmin, Zmax]]</span>
<span class="sd">                            Parameters[&quot;Potential&quot;] = Array with port Potential . For example [1,2]</span>
<span class="sd">                            Parameters[&quot;Port Number&quot;] = Array with Port number [1,2]</span>
<span class="sd">                            Parameters[&quot;Polarity&quot;] = Port Polarity can be be &quot;Positive&quot; or &quot;Negative&quot;. For </span>
<span class="sd">                                                    this function an 2 ports will be defined so please give an </span>
<span class="sd">                                                    array with two Polaritys. For example Parameters[&quot;Polarity&quot;] = [&quot;Positive&quot;, &quot;Positive&quot;]</span>
<span class="sd">                            Parameters[&quot;Solid Name&quot;] = Name of the Object on witch the Waveguide port will be created. For example &quot;WG:WG1&quot;</span>
<span class="sd">                            Parameters[&quot;Face ID&quot;] = Array with the ID of the two picked faces. For example Parameters[&quot;Face ID&quot;] = [2,4]</span>
<span class="sd">        PicParams (dict): Dictionary with Pick Faces Parameters</span>
<span class="sd">                            PickParams[&quot;Face Number&quot;] = Integer with the number of the picked face of the structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parameters to determin port position </span>
    <span class="n">Orientation</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Orientation&quot;</span><span class="p">]</span>
    <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Coordinates&quot;</span><span class="p">]</span>
    <span class="c1"># Choose coordinates</span>
    <span class="n">Span11</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span12</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Span21</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span22</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Polarity</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Polarity&quot;</span><span class="p">]</span>
    <span class="n">SolidName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">]</span>
    <span class="n">PickID</span> <span class="o">=</span> <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SolidName</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#Return Ports in Dictionary for one Object 2 Ports can be define </span>
        <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Ports Numbers</span>
        <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

        <span class="c1"># loop true mode sets</span>
        <span class="n">Potentials</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Potential&quot;</span><span class="p">]</span>


        <span class="c1">#Start Loop for Ports</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Potentials</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Port&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortNumber &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NumberOfModes &quot;5&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ReferencePlaneDistance &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Coordinates &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Orientation &#39;</span> <span class="o">+</span>  <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Orientation</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortOnBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ClipPickedPortToBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AdjustPolarization &quot;True&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PolarizationAngle &quot;0&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SingleEnded &quot;False&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddPotentialPicked &quot;1&quot;, &quot;positive&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">SignalName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PickID</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
            <span class="c1">#  &#39;\n.AddPotentialPicked  &#39; + &#39;&quot;&#39; + str(index) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(Polarity[index-1]) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(SolidName) + &#39;&quot;&#39;+ &#39;,&#39; + &#39;&quot;&#39; + str(PickID[index-1]) + &#39;&quot;&#39; + \</span>
            <span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Check names</span>
        <span class="k">if</span> <span class="s2">&quot;Signal&quot;</span> <span class="ow">in</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">):</span>
            <span class="n">SignalName</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">GNDName1</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">GNDName2</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;Signal&quot;</span> <span class="ow">in</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">):</span>
            <span class="n">SignalName</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">GNDName1</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">GNDName2</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SignalName</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">GNDName1</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">GNDName2</span> <span class="o">=</span> <span class="n">SolidName</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        

        <span class="c1">#Return Ports in Dictionary for one Object 2 Ports can be define </span>
        <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Ports Numbers</span>
        <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

        <span class="c1"># loop true mode sets</span>
        <span class="n">Potentials</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Potential&quot;</span><span class="p">]</span>


        <span class="c1">#Start Loop for Ports</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Potentials</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Port&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortNumber &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NumberOfModes &quot;5&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ReferencePlaneDistance &quot;0&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Coordinates &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Orientation &#39;</span> <span class="o">+</span>  <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Orientation</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortOnBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ClipPickedPortToBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZrangeAdd  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AdjustPolarization &quot;True&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PolarizationAngle &quot;0&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SingleEnded &quot;False&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddPotentialPicked &quot;1&quot;, &quot;positive&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">SignalName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PickID</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddPotentialPicked &quot;1&quot;, &quot;negative&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">GNDName1</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PickID</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddPotentialPicked &quot;1&quot;, &quot;negative&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">GNDName2</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PickID</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
            <span class="c1">#  &#39;\n.AddPotentialPicked  &#39; + &#39;&quot;&#39; + str(index) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(Polarity[index-1]) + &#39;&quot;&#39; + &#39;,&#39; + &#39;&quot;&#39; + str(SolidName) + &#39;&quot;&#39;+ &#39;,&#39; + &#39;&quot;&#39; + str(PickID[index-1]) + &#39;&quot;&#39; + \</span>
            <span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Port</span></div>






<div class="viewcode-block" id="Pick">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Pick">[docs]</a>
<span class="k">def</span> <span class="nf">Pick</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pick function</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters   </span>
<span class="sd">                        PicParams[&quot;Option&quot;] : Pcik option. For example &quot;Face&quot;</span>
<span class="sd">                        PicParams[&quot;Object&quot;] : Name of the object on witch the pick will be executed.</span>
<span class="sd">                        PicParams[&quot;Face Number&quot;] = int with the ID of the picked Face for example.</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters for Picking an object</span>
    <span class="n">FaceName</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span>
    <span class="n">Number</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Face&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Pick.PickFaceFromId &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FaceName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>  <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Number</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Centerpoint&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Pick.PickCenterpointFromId &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FaceName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>  <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Number</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong Object, can be choose from &#39;Face&#39; and &#39;Centerpoint&#39; for the moment!&quot;</span><span class="p">)</span></div>





<div class="viewcode-block" id="ClearAllPicks">
<a class="viewcode-back" href="../rst/Functions.html#Functions.ClearAllPicks">[docs]</a>
<span class="k">def</span> <span class="nf">ClearAllPicks</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear all pciks</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Pick.ClearAllPicks &#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">return</span> <span class="n">data</span></div>





<div class="viewcode-block" id="SetSimFreqeuncy">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetSimFreqeuncy">[docs]</a>
<span class="k">def</span> <span class="nf">SetSimFreqeuncy</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Simulation Frequency</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                            Parameters[&quot;Min Frequency&quot;] : Min Frequency of Simulation</span>
<span class="sd">                            Parameters[&quot;Max Frequency&quot;] : Max Frequency of Simulation</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">FreqMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Frequency&quot;</span><span class="p">]</span>
    <span class="n">FreqMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Frequency&quot;</span><span class="p">]</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrequencyRange &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FreqMin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FreqMax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>




<div class="viewcode-block" id="SetSimWavelength">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetSimWavelength">[docs]</a>
<span class="k">def</span> <span class="nf">SetSimWavelength</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Simulation SetSimWavelength</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                            Parameters[&quot;Min Wavelength&quot;] : Min Wavelength</span>
<span class="sd">                            Parameters[&quot;Max Wavelength&quot;] : Max Wavelength</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WavelengthMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Wavelength&quot;</span><span class="p">]</span>
    <span class="n">WavelengtMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Wavelength&quot;</span><span class="p">]</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.WavelengthRange &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WavelengthMin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WavelengtMax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>




<div class="viewcode-block" id="SetTimeSolver">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetTimeSolver">[docs]</a>
<span class="k">def</span> <span class="nf">SetTimeSolver</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Time solver Parameters</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                            Parameters[&quot;Accuracy&quot;] : int from 10,15,20,25,30,35,40. Simulation accuracy. For example 20.    </span>
<span class="sd">                            Parameters[&quot;Caclculate Modes Only&quot;] : Boolen. True if you want to calculate </span>
<span class="sd">                            only the Ports modes. False to calculate the hole structure. </span>
<span class="sd">                            Parameters[&quot;Auto Impedance&quot;] : Booled. Set Port Impedance. True if you want to set manually</span>
<span class="sd">                            False otherwise.</span>
<span class="sd">                            Parameters[&quot;Impedance&quot;] : int/float Port Impedance. </span>
<span class="sd">                            Parameters[&quot;Source Port&quot;] : Int. Set the Source Port. For example 1 or 2</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Accuracy</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
    <span class="n">ModesOnly</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Caclculate Modes Only&quot;</span><span class="p">]</span>
    <span class="n">AutoImpedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Auto Impedance&quot;</span><span class="p">]</span>
    <span class="n">Impedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Impedance&quot;</span><span class="p">]</span>
    <span class="n">Source</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Source Port&quot;</span><span class="p">]</span>
    <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solver Mesh Type&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">MeshType</span> <span class="o">==</span> <span class="s2">&quot;FIT&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Method &quot;Hexahedral&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SteadyStateLimit &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Accuracy</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalculateModesOnly &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ModesOnly</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StimulationPort &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Source</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StimulationMode &quot;All&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshAdaption &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SParaSymmetry &quot;True&quot;&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AutoNormImpedance  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">AutoImpedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NormingImpedance &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Impedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Mesh.SetCreator &quot;High Frequency&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Method &quot;Hexahedral TLM&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SteadyStateLimit &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Accuracy</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StimulationPort &quot;All&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StimulationMode &quot;All&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshAdaption &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SParaSymmetry &quot;True&quot;&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AutoNormImpedance &quot;True&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NormingImpedance &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Impedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StoreTDResultsInCache  &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RunDiscretizerOnly &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SuperimposePLWExcitation &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Port</span></div>




    
     
     
     






<div class="viewcode-block" id="SetFreqSolver">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetFreqSolver">[docs]</a>
<span class="k">def</span> <span class="nf">SetFreqSolver</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Frequency solver Parameters</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                            Parameters[&quot;Accuracy&quot;] : int from 10,15,20,25,30,35,40. Simulation accuracy. For example 20.    </span>
<span class="sd">                            Parameters[&quot;Caclculate Modes Only&quot;] : Boolen. True if you want to calculate </span>
<span class="sd">                            only the Ports modes. False to calculate the hole structure. </span>
<span class="sd">                            Parameters[&quot;Auto Impedance&quot;] : Booled. Set Port Impedance. True if you want to set manually</span>
<span class="sd">                            False otherwise.</span>
<span class="sd">                            Parameters[&quot;Impedance&quot;] : int/float Port Impedance. </span>
<span class="sd">                            Parameters[&quot;Source Port&quot;] : Int. Set the Source Port. For example 1 or 2</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Accuracy</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
    <span class="n">ModesOnly</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Caclculate Modes Only&quot;</span><span class="p">]</span>
    <span class="n">AutoImpedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Auto Impedance&quot;</span><span class="p">]</span>
    <span class="n">Impedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Impedance&quot;</span><span class="p">]</span>
    <span class="n">Source</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Source Port&quot;</span><span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Mesh.SetCreator &quot;High Frequency&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With FDSolver&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMethod &quot;Tetrahedral&quot;, &quot;General purpose&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.OrderTet &quot;Second&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.OrderSrf &quot;First&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Stimulation &quot;All&quot;, &quot;All&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ResetExcitationList &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AutoNormImpedance &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NormingImpedance &quot;50&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ModesOnly &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ConsiderPortLossesTet &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetShieldAllPorts &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AccuracyHex &quot;1e-6&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AccuracyTet &quot;1e-5&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AccuracySrf &quot;1e-3&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LimitIterations &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MaxIterations &quot;0&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetCalcBlockExcitationsInParallel &quot;True&quot;, &quot;True&quot;, &quot;&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StoreAllResults &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StoreResultsInCache &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseHelmholtzEquation &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LowFrequencyStabilization &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;Direct&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshAdaptionHex &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshAdaptionTet &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AcceleratedRestart &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FreqDistAdaptMode &quot;Distributed&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NewIterativeSolver &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.TDCompatibleMaterials &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ExtrudeOpenBC &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetOpenBCTypeHex &quot;Default&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetOpenBCTypeTet &quot;Default&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddMonitorSamples &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalcPowerLoss &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalcPowerLossPerComponent &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetKeepSolutionCoefficients &quot;MonitorsAndMeshAdaptation&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseDoublePrecision &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseDoublePrecision_ML &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MixedOrderSrf &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MixedOrderTet &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PreconditionerAccuracyIntEq &quot;0.15&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MLFMMAccuracy &quot;Default&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MinMLFMMBoxSize &quot;0.3&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseCFIEForCPECIntEq &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseEnhancedCFIE2 &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseFastRCSSweepIntEq &quot;false&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseSensitivityAnalysis &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseEnhancedNFSImprint &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseFastDirectFFCalc &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RemoveAllStopCriteria &quot;Hex&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Hex&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RemoveAllStopCriteria &quot;Tet&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;All Probes&quot;, &quot;0.05&quot;, &quot;2&quot;, &quot;Tet&quot;, &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RemoveAllStopCriteria &quot;Srf&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;All S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Reflection S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddStopCriterion &quot;Transmission S-Parameters&quot;, &quot;0.01&quot;, &quot;2&quot;, &quot;Srf&quot;, &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SweepMinimumSamples &quot;3&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetNumberOfResultDataSamples &quot;5001&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetResultDataSamplingMode &quot;Automatic&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SweepWeightEvanescent &quot;1.0&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AccuracyROM &quot;1e-4&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddSampleInterval &quot;&quot;, &quot;&quot;, &quot;5&quot;, &quot;Automatic&quot;, &quot;True&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AddSampleInterval &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;Automatic&quot;, &quot;False&quot;  &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MPIParallelization &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseDistributedComputing &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NetworkComputingStrategy &quot;RunRemote&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NetworkComputingJobCount &quot;3&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseParallelization &quot;True&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MaxCPUs &quot;1024&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MaximumNumberOfCPUDevices &quot;2&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.HardwareAcceleration &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MaximumNumberOfGPUs &quot;1&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With IESolver &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseFastFrequencySweep &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseIEGroundPlane &quot;False&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetRealGroundMaterialName &quot;&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalcFarFieldInRealGround &quot;False&quot; &#39;</span><span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RealGroundModelType &quot;Auto&quot; &#39;</span><span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PreconditionerType &quot;Auto&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ExtendThinWireModelByWireNubs &quot;False&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ExtraPreconditioning &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With IESolver &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetFMMFFCalcStopLevel &quot;0&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetFMMFFCalcNumInterpPoints &quot;6&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseFMMFarfieldCalc &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetCFIEAlpha &quot;0.500000&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LowFrequencyStabilization &quot;False&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LowFrequencyStabilizationML &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Multilayer &quot;False&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetiMoMACC_I &quot;0.0001&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetiMoMACC_M &quot;0.0001&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DeembedExternalPorts &quot;True&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetOpenBC_XY &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.OldRCSSweepDefintion &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetRCSOptimizationProperties &quot;True&quot;, &quot;100&quot;, &quot;0.00001&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetAccuracySetting &quot;Medium&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalculateSParaforFieldsources &quot;True&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ModeTrackingCMA &quot;True&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NumberOfModesCMA &quot;3&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.StartFrequencyCMA &quot;-1.0&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetAccuracySettingCMA &quot;Default&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrequencySamplesCMA &quot;0&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMemSettingCMA &quot;Auto&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.CalculateModalWeightingCoefficientsCMA &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.DetectThinDielectrics &quot;True&quot; &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseLegacyRadiatedPowerCalc &quot;False&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Port</span></div>

        




<div class="viewcode-block" id="StartTimeSolver">
<a class="viewcode-back" href="../rst/Functions.html#Functions.StartTimeSolver">[docs]</a>
<span class="k">def</span> <span class="nf">StartTimeSolver</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start Time Simulation</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Start&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>





<div class="viewcode-block" id="CreateEfieldMonitor">
<a class="viewcode-back" href="../rst/Functions.html#Functions.CreateEfieldMonitor">[docs]</a>
<span class="k">def</span> <span class="nf">CreateEfieldMonitor</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Monitor</span>

<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionary with Parameters</span>
<span class="sd">                            Parameters[&quot;Wavelength&quot;] : Int/float. This will set the wavelength. For this function</span>
<span class="sd">                            and only for this function you need to give the exact number. So 1.55 um will be Parameters[&quot;Wavelength&quot;]  = 1.55e-6</span>
<span class="sd">                            Parameters[&quot;Monitor Type&quot;] : str with monitor Type. Can be one of :</span>
<span class="sd">                                &quot;Efield&quot;, &quot;Hfield&quot;, &quot;Surfacecurrent&quot;, &quot;Powerflow&quot;, &quot;Current&quot;,</span>
<span class="sd">                                &quot;Powerloss&quot;, &quot;Eenergy&quot;, &quot;Elossdens&quot;, &quot;Lossdens&quot;, &quot;Henergy&quot;, </span>
<span class="sd">                                &quot;Farfield&quot;, &quot;Fieldsource&quot;, &quot;Spacecharge&quot;, &quot;ParticleCurrentDensity&quot;, &quot;Electrondensity&quot; </span>
<span class="sd">                            </span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Error massage</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Wavelength</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">]</span>
    <span class="n">MonitorType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Monitor Type&quot;</span><span class="p">]</span>
    <span class="n">Types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Efield&quot;</span><span class="p">,</span> <span class="s2">&quot;Hfield&quot;</span><span class="p">,</span> <span class="s2">&quot;Surfacecurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Powerflow&quot;</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">,</span> <span class="s2">&quot;Powerloss&quot;</span><span class="p">,</span> <span class="s2">&quot;Eenergy&quot;</span><span class="p">,</span> <span class="s2">&quot;Elossdens&quot;</span><span class="p">,</span> <span class="s2">&quot;Lossdens&quot;</span><span class="p">,</span> <span class="s2">&quot;Henergy&quot;</span><span class="p">,</span> <span class="s2">&quot;Farfield&quot;</span><span class="p">,</span> <span class="s2">&quot;Fieldsource&quot;</span><span class="p">,</span> <span class="s2">&quot;Spacecharge&quot;</span><span class="p">,</span> <span class="s2">&quot;ParticleCurrentDensity&quot;</span><span class="p">,</span> <span class="s2">&quot;Electrondensity&quot;</span> <span class="p">]</span>
    <span class="n">Speed_of_light</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="mf">1e-6</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">Speed_of_light</span> <span class="o">/</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">MonitorType</span> <span class="ow">in</span> <span class="n">Types</span><span class="p">:</span>
        <span class="n">Name</span> <span class="o">=</span> <span class="n">MonitorType</span> <span class="o">+</span> <span class="s1">&#39; (wl=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Wavelength</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Monitor&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Name &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Domain &quot;Wavelength&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FieldType &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MonitorType</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MonitorValue &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Wavelength</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.UseSubvolume &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Coordinates &quot;Structure&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetSubvolume &quot;-5.5&quot;, &quot;2.5&quot;, &quot;-3.5&quot;, &quot;3.5&quot;, &quot;-2.5&quot;, &quot;3.8&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetSubvolumeOffset &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;, &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetSubvolumeInflateWithOffset &quot;False&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="n">Data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Data</span>
    <span class="k">else</span><span class="p">:</span>   
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameters[&#39;Monitor Type&#39;] is not in allowed types. Please choose one of the following types: [&#39;Efield&#39;, &#39;Hfield&#39;, &#39;Surfacecurrent&#39;, &#39;Powerflow&#39;, &#39;Current&#39;, &#39;Powerloss&#39;, &#39;Eenergy&#39;, &#39;Elossdens&#39;, &#39;Lossdens&#39;, &#39;Henergy&#39;, &#39;Farfield&#39;, &#39;Fieldsource&#39;, &#39;Spacecharge&#39;, &#39;ParticleCurrentDensity&#39;, &#39;Electrondensity&#39;]&quot;</span><span class="p">)</span></div>


<span class="c1">#&#39;\n.Frequency &#39; + &#39;&quot;&#39; + str(freq) + &#39;&quot;&#39; + \</span>


<span class="c1"># Set Mesh</span>
<div class="viewcode-block" id="SetMesh">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetMesh">[docs]</a>
<span class="k">def</span> <span class="nf">SetMesh</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the type of the mesh. The user can define the mesh cells per wavelength near and far</span>
<span class="sd">        from the simulations object.</span>

<span class="sd">        </span>



<span class="sd">    Args:</span>
<span class="sd">        Parameters (dict): Dictionarty with Parameters</span>
<span class="sd">                            Parameters[&quot;Mesh Type&quot;] : str Type of the Mesh. You can choose between:  </span>
<span class="sd">                                                    PBA - Hexahedral mesh with Perfect Boundary Approximation</span>
<span class="sd">                                                    HexahedralTLM</span>
<span class="sd">                                                    CFD</span>
<span class="sd">                                                    CFDNew</span>
<span class="sd">                                                    Staircase - Hexahedral mesh with staircase cells</span>
<span class="sd">                                                    Tetrahedral - Tetrahedral mesh</span>
<span class="sd">                                                    Surface - Surface mesh</span>
<span class="sd">                                                    SurfaceMLS - urface multi layer mesh</span>
<span class="sd">                                                    Planar - Planar 2D mesh</span>
<span class="sd">                            Parameters[&quot;Mesh Cells Near Object&quot;] : int Cells per Wavelength near the simulation object</span>
<span class="sd">                            Parameters[&quot;Mesh Cells far Object&quot;] : int Cells per Wavelength far from the simulation object</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: String with VBA Code </span>
<span class="sd">    &quot;&quot;&quot;</span>
    

    <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Type&quot;</span><span class="p">]</span>
    <span class="n">CellNear</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells Near Object&quot;</span><span class="p">]</span>
    <span class="n">CellFar</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells far Object&quot;</span><span class="p">]</span>


    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Mesh&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshType &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MeshType</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetCreator &quot;High Frequency&quot;&#39;</span><span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Hex&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;Version&quot;, 1%&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;WavelengthRefinementSameAsNear&quot;, &quot;0&quot; &#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;MaxStepNear&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;MaxStepFar&quot;, &quot;0&quot;&#39;</span>  <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;ModelBoxDescrNear&quot;, &quot;maxedge&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;ModelBoxDescrFar&quot;, &quot;maxedge&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;UseMaxStepAbsolute&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;GeometryRefinementSameAsNear&quot;, &quot;0&quot;&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>

        


<div class="viewcode-block" id="MoveWaveguidePorts">
<a class="viewcode-back" href="../rst/Functions.html#Functions.MoveWaveguidePorts">[docs]</a>
<span class="k">def</span> <span class="nf">MoveWaveguidePorts</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
    <span class="n">Distance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Distance&quot;</span><span class="p">]</span>
    <span class="n">Span11</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span12</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Span21</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Span22</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Ports Numbers</span>
    <span class="n">PortNum</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">]</span>

    <span class="n">Port</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">Port</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


    <span class="c1"># Xposition of thw teo ends </span>
    <span class="n">Xpos</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">Distance</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">Distance</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
    <span class="c1">#Start Loop for Ports</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">PortNum</span><span class="p">,</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Port&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LoadContentForModify &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNum</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Coordinates &quot;Free&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ClipPickedPortToBound &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Yrange  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span11</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span12</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zrange  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span21</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Span22</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xrange &quot;&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Xpos</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xpos</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.NumberOfModes &quot;5&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AdjustPolarization &quot;True&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PolarizationAngle &quot;0&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Modify&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Port</span></div>

    

<div class="viewcode-block" id="SetDiscretePort">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetDiscretePort">[docs]</a>
<span class="k">def</span> <span class="nf">SetDiscretePort</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>

    <span class="n">PortNumber</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Number&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Voltage&quot;</span><span class="p">,</span> <span class="s2">&quot;S-Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">]:</span>
        <span class="n">PortType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Type&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Port Type can be on of &#39;Voltage&#39;, &#39;S-Parameters&#39; or &#39;Current&#39;&quot;</span><span class="p">)</span>
    <span class="n">PortImpedance</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Impedance&quot;</span><span class="p">]</span>
    <span class="n">Voltage</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Voltage&quot;</span><span class="p">]</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Current&quot;</span><span class="p">]</span>
    <span class="n">PortRadius</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Radius&quot;</span><span class="p">]</span>


    <span class="c1"># Port = {}</span>
    <span class="c1"># Port[&quot;1&quot;] = None</span>
    <span class="c1"># Port[&quot;2&quot;] = None</span>

    <span class="k">if</span> <span class="s2">&quot;Discrete Port Coordinates&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">Coordinates</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Coordinates&quot;</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With DiscretePort&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortNumber &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNumber</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortType</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Label &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Folder &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Impedance &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortImpedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Voltage &quot;&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Voltage</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Current &quot;&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Current</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Monitor &quot;True&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Radius &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortRadius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetP1 &quot;False&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X1&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y1&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z1&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetP2 &quot;False&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Y2&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;, &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Coordinates</span><span class="p">[</span><span class="s2">&quot;Z2&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.InvertDirection &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LocalCoordinates &quot;False&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Wire &quot;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Position &quot;end1&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create &#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>

        <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Port</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main ()&#39;</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With DiscretePort&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.PortNumber &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortNumber</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortType</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Label &quot;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Folder &quot;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Impedance &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortImpedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Impedance &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortImpedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Voltage &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Voltage</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Current &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Current</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Monitor &quot;True&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Radius &quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PortRadius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetP1 &quot;True&quot;, &quot;-23&quot;, &quot;-2.9618802153517&quot;, &quot;1.7&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetP2 &quot;True&quot;, &quot;-23&quot;, &quot;3&quot;, &quot;1.7&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.InvertDirection &quot;False&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.LocalCoordinates &quot;False&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Wire &quot;&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Position &quot;end1&quot;&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Create &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
        <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Port</span></div>


                    
                


<span class="c1"># Set Optical Simulation Domain </span>
<div class="viewcode-block" id="SetOpticalSimulationProperties">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetOpticalSimulationProperties">[docs]</a>
<span class="k">def</span> <span class="nf">SetOpticalSimulationProperties</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
     <span class="c1"># Units Properties</span>
     <span class="n">Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">]</span> 
     <span class="n">Frequency</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> 
     <span class="n">Time</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> 
     <span class="n">Temperature</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> 
 
     <span class="c1"># Set Background</span>
     <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>
     <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">]</span> 
     <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">]</span>
     <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">]</span> 
     <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">]</span>
     <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">]</span> 
     <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">]</span>
 
     <span class="c1"># Operational Wavelength</span>
     <span class="n">WavelengthMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Wavelength&quot;</span><span class="p">]</span>
     <span class="n">WavelengtMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Wavelength&quot;</span><span class="p">]</span>
 
     <span class="c1"># Set Boundary</span>
     <span class="n">XminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span> 
     <span class="n">XmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span> 
     <span class="n">YminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span> 
     <span class="n">YmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span> 
     <span class="n">ZminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span> 
     <span class="n">ZmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span> 
     <span class="n">XSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span> 
     <span class="n">YSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
     <span class="n">ZSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span> 
 
     <span class="c1"># Mesh Settings</span>
     <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Type&quot;</span><span class="p">]</span> 
     <span class="n">CellNear</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells Near Object&quot;</span><span class="p">]</span> 
     <span class="n">CellFar</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells far Object&quot;</span><span class="p">]</span> 
 
 
     <span class="c1"># VBA Code</span>
     <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Units&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Length&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Length</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Frequency&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Frequency</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Voltage&quot;, &quot;V&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Resistance&quot;, &quot;Ohm&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Inductance&quot;, &quot;nH&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Temperature&quot;,  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Time&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Time</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Current&quot;, &quot;A&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Conductance&quot;, &quot;S&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Capacitance&quot;, &quot;pF&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ThermalSolver.AmbientTemperature &quot;0&quot;&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Plot.DrawBox &quot;True&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Background&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Type</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Epsilon &quot;1.0&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1.0&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Rho &quot;1.204&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalType &quot;Normal&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalConductivity &quot;0.026&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SpecificHeat &quot;1005&quot;, &quot;J/K/kg&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>  <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Boundary&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ysymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.WavelengthRange &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WavelengthMin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WavelengtMax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Mesh&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MergeThinPECLayerFixpoints &quot;True&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.RatioLimit &quot;20&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AutomeshRefineAtPecLines &quot;True&quot;, &quot;6&quot;&#39;</span> <span class="o">+</span>\
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FPBAAvoidNonRegUnite &quot;True&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ConsiderSpaceForLowerMeshLimit &quot;False&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MinimumStepNumber &quot;5&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AnisotropicCurvatureRefinement &quot;True&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.AnisotropicCurvatureRefinementFSM &quot;True&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Hex&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;RatioLimitGeometry&quot;, &quot;20&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;EdgeRefinementOn&quot;, &quot;1&quot;&#39;</span><span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;EdgeRefinementRatio&quot;, &quot;6&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Tet&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;VolMeshGradation&quot;, &quot;1.5&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;SrfMeshGradation&quot;, &quot;1.5&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;HexTLM&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;RatioLimitGeometry&quot;, &quot;20&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">MeshAdaption3D.SetAdaptionStrategy &quot;Energy&quot;&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ChangeProblemType &quot;Optical&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Hex&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;Version&quot;, 1%&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;WavelengthRefinementSameAsNear&quot;, &quot;0&quot; &#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Mesh&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshType &#39;</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">MeshType</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ChangeSolverType(&quot;HF Time Domain&quot;)&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
     <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">data</span></div>





<span class="c1"># Set Optical Simulation Domain </span>
<div class="viewcode-block" id="SetElectricalSimulationProperties">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetElectricalSimulationProperties">[docs]</a>
<span class="k">def</span> <span class="nf">SetElectricalSimulationProperties</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span>
    <span class="c1"># Units Properties</span>
    <span class="n">Length</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Dimensions&#39;</span><span class="p">]</span> 
    <span class="n">Frequency</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> 
    <span class="n">Time</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> 
    <span class="n">Temperature</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> 

    <span class="c1"># Set Background</span>
    <span class="n">Type</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Type Background&quot;</span><span class="p">]</span>
    <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Background&quot;</span><span class="p">]</span> 
    <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Background&quot;</span><span class="p">]</span>
    <span class="n">Ymin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Background&quot;</span><span class="p">]</span> 
    <span class="n">Ymax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Background&quot;</span><span class="p">]</span>
    <span class="n">Zmin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Background&quot;</span><span class="p">]</span> 
    <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Background&quot;</span><span class="p">]</span>


    <span class="c1"># Operational Frequency </span>
    <span class="n">FreqMin</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Min Frequency&quot;</span><span class="p">]</span>
    <span class="n">FreqMax</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Max Frequency&quot;</span><span class="p">]</span>


    <span class="c1"># Set Boundary</span>
    <span class="n">XminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmin Boundary&quot;</span><span class="p">]</span> 
    <span class="n">XmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xmax Boundary&quot;</span><span class="p">]</span> 
    <span class="n">YminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymin Boundary&quot;</span><span class="p">]</span> 
    <span class="n">YmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ymax Boundary&quot;</span><span class="p">]</span> 
    <span class="n">ZminBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmin Boundary&quot;</span><span class="p">]</span> 
    <span class="n">ZmaxBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zmax Boundary&quot;</span><span class="p">]</span> 
    <span class="n">XSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Xsymmetry Boundary&quot;</span><span class="p">]</span> 
    <span class="n">YSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Ysymmetry Boundary&quot;</span><span class="p">]</span> 
    <span class="n">ZSimetryBound</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Zsymmetry Boundary&quot;</span><span class="p">]</span> 

    <span class="c1"># Mesh Settings</span>
    <span class="n">MeshType</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Type&quot;</span><span class="p">]</span> 
    <span class="n">CellNear</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells Near Object&quot;</span><span class="p">]</span> 
    <span class="n">CellFar</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Mesh Cells far Object&quot;</span><span class="p">]</span> 




    <span class="c1"># VBA Code</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Units&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Length&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Length</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Frequency&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Frequency</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Voltage&quot;, &quot;V&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Resistance&quot;, &quot;Ohm&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Inductance&quot;, &quot;nH&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Temperature&quot;,  &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Time&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Time</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Current&quot;, &quot;A&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Conductance&quot;, &quot;S&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Capacitance&quot;, &quot;pF&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ThermalSolver.AmbientTemperature &quot;0&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Plot.DrawBox &quot;True&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Background&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Type</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Epsilon &quot;1.0&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mu &quot;1.0&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Rho &quot;1.204&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalType &quot;Normal&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ThermalConductivity &quot;0.026&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SpecificHeat &quot;1005&quot;, &quot;J/K/kg&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>  <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ymax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZminSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZmaxSpace &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Zmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span>  <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Boundary&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmin &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZminBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmax &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZmaxBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">XSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ysymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">YSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zsymmetry &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ZSimetryBound</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Solver&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FrequencyRange &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FreqMin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">FreqMax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Mesh.MinimumCurvatureRefinement &quot;150&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;HexTLM&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxNear&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellNear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxFar&quot;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">CellFar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;RatioLimitGeometry&quot;, &quot;15&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Hex&quot;&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;Version&quot;, 1%&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Mesh&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshType &quot;PBA&quot;&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ChangeSolverType(&quot;HF Time Domain&quot;)&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># &#39;\n.SetMeshType &quot;Hex&quot;&#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;Version&quot;, 1%&#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;StepsPerWaveNear&quot;, &#39; + &#39;&quot;&#39; + str(CellNear) + &#39;&quot;&#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;StepsPerWaveFar&quot;, &#39; + &#39;&quot;&#39; + str(CellFar) + &#39;&quot;&#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;WavelengthRefinementSameAsNear&quot;, &quot;0&quot; &#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;StepsPerBoxNear&quot;, &#39; + &#39;&quot;&#39; + str(CellNear) + &#39;&quot;&#39; + \</span>
    <span class="c1"># &#39;\n.Set &quot;StepsPerBoxFar&quot;, &#39; + &#39;&quot;&#39; + str(CellFar) + &#39;&quot;&#39; + \</span>
    <span class="k">return</span> <span class="n">Port</span></div>




<div class="viewcode-block" id="ChangeSolverType">
<a class="viewcode-back" href="../rst/Functions.html#Functions.ChangeSolverType">[docs]</a>
<span class="k">def</span> <span class="nf">ChangeSolverType</span><span class="p">(</span><span class="n">Type</span><span class="p">):</span>
    <span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Type</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main () &#39;</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ChangeSolverType &quot;HF Time Domain&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">pass</span>

    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>





<div class="viewcode-block" id="ExportResults">
<a class="viewcode-back" href="../rst/Functions.html#Functions.ExportResults">[docs]</a>
<span class="k">def</span> <span class="nf">ExportResults</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Result</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main &#39;</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SelectTreeItem (&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Result</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span> <span class="o">+</span>\
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With ASCIIExport&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Reset&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.FileName (&quot;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.csv&quot;)&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetFileType (&quot;csv&quot;)&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetCsvSeparator (&quot;,&quot;)&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Mode (&quot;FixedWidth&quot;)&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Execute&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>








<div class="viewcode-block" id="WaveguidePorts_on_Electrodes_MZM">
<a class="viewcode-back" href="../rst/Functions.html#Functions.WaveguidePorts_on_Electrodes_MZM">[docs]</a>
<span class="k">def</span> <span class="nf">WaveguidePorts_on_Electrodes_MZM</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="n">Obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">])):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">])):</span>
            <span class="n">PicParams</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face ID&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">PickFace</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">(</span><span class="n">PicParams</span><span class="p">)</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">PickFace</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="n">Port</span> <span class="o">=</span> <span class="n">WaveguidePortWithPins</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="n">PicParams</span><span class="p">)</span>
        <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>






<div class="viewcode-block" id="Optical_WaveguidePorts_MZM">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Optical_WaveguidePorts_MZM">[docs]</a>
<span class="k">def</span> <span class="nf">Optical_WaveguidePorts_MZM</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="n">Obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">])):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">])):</span>
            <span class="n">PicParams</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Face&quot;</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face ID&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">PickFace</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">(</span><span class="n">PicParams</span><span class="p">)</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">PickFace</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="n">Port</span> <span class="o">=</span> <span class="n">WaveguidePort</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
        <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">Port</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>







<div class="viewcode-block" id="Discrete_Port">
<a class="viewcode-back" href="../rst/Functions.html#Functions.Discrete_Port">[docs]</a>
<span class="k">def</span> <span class="nf">Discrete_Port</span><span class="p">(</span><span class="n">Parameters</span><span class="p">,</span> <span class="n">Obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">])):</span>
        <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Discrete Port Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Port Number&quot;</span><span class="p">])):</span>
            <span class="n">PicParams</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Option&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Centerpoint&quot;</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">PicParams</span><span class="p">[</span><span class="s2">&quot;Face Number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Face ID&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">PickFace</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">(</span><span class="n">PicParams</span><span class="p">)</span>
            <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Solid Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">[</span><span class="s2">&quot;Electrodes_Names&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">PickFace</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">DiscretePort</span> <span class="o">=</span> <span class="n">SetDiscretePort</span><span class="p">(</span><span class="n">Parameters</span><span class="p">)</span>
        <span class="n">Obj</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">execute_vba_code</span><span class="p">(</span><span class="n">DiscretePort</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>



<div class="viewcode-block" id="SetElectricalTemplate">
<a class="viewcode-back" href="../rst/Functions.html#Functions.SetElectricalTemplate">[docs]</a>
<span class="k">def</span> <span class="nf">SetElectricalTemplate</span><span class="p">(</span><span class="n">Parameters</span><span class="p">):</span> 
    <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;Sub Main&#39;</span> \
           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Unit&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Length&quot;, &quot;um&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Frequency&quot;, &quot;GHz&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Voltage&quot;, &quot;V&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Resistance&quot;, &quot;Ohm&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Inductance&quot;, &quot;nH&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Temperature&quot;,  &quot;degC&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Time&quot;, &quot;ns&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Current&quot;, &quot;A&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Conductance&quot;, &quot;S&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetUnit &quot;Capacitance&quot;, &quot;pF&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ThermalSolver.AmbientTemperature &quot;0&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Solver.FrequencyRange &quot;1&quot;, &quot;150&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Background&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Type &quot;pec&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XminSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.XmaxSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YminSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.YmaxSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZminSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.ZmaxSpace &quot;0.0&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Boundary&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmin &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xmax &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymin &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ymax &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmin &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zmax &quot;electric&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Xsymmetry &quot;none&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Ysymmetry &quot;none&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Zsymmetry &quot;none&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Mesh.MinimumCurvatureRefinement &quot;150&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;HexTLM&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveNear&quot;, &quot;20&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxNear&quot;, &quot;10&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerWaveFar&quot;, &quot;20&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;StepsPerBoxFar&quot;, &quot;10&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;RatioLimitGeometry&quot;, &quot;15&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With MeshSettings&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.SetMeshType &quot;Hex&quot;&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.Set &quot;Version&quot;, 1%&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With Mesh&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">.MeshType &quot;PBA&quot;&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End With&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">End Sub&#39;</span>
    <span class="n">Port</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Port</span></div>

                        
                                        





<span class="c1"># With Mesh</span>
<span class="c1">#      .MeshType &quot;PBA&quot;</span>
<span class="c1">#      .SetCreator &quot;High Frequency&quot;</span>
<span class="c1">#      .AutomeshRefineAtPecLines &quot;True&quot;, &quot;2&quot;</span>
<span class="c1">#      .UseRatioLimit &quot;True&quot;</span>
<span class="c1">#      .RatioLimit &quot;10&quot;</span>
<span class="c1">#      .LinesPerWavelength &quot;20&quot;</span>
<span class="c1">#      .MinimumStepNumber &quot;10&quot;</span>
<span class="c1">#      .Automesh &quot;True&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># With MeshSettings</span>
<span class="c1">#      .SetMeshType &quot;Hex&quot;</span>
<span class="c1">#      .Set &quot;StepsPerWaveNear&quot;, &quot;13&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># &#39; solver - FD settings</span>
<span class="c1"># With FDSolver</span>
<span class="c1">#      .Reset</span>
<span class="c1">#      .Method &quot;Tetrahedral Mesh&quot; &#39; i.e. general purpose</span>

<span class="c1">#      .AccuracyHex &quot;1e-6&quot;</span>
<span class="c1">#      .AccuracyTet &quot;1e-5&quot;</span>
<span class="c1">#      .AccuracySrf &quot;1e-3&quot;</span>

<span class="c1">#      .SetUseFastResonantForSweepTet &quot;False&quot;</span>

<span class="c1">#      .Type &quot;Direct&quot;</span>
<span class="c1">#      .MeshAdaptionHex &quot;False&quot;</span>
<span class="c1">#      .MeshAdaptionTet &quot;True&quot;</span>

<span class="c1">#      .InterpolationSamples &quot;5001&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># With MeshAdaption3D</span>
<span class="c1">#     .SetType &quot;HighFrequencyTet&quot;</span>
<span class="c1">#     .SetAdaptionStrategy &quot;Energy&quot;</span>
<span class="c1">#     .MinPasses &quot;3&quot;</span>
<span class="c1">#     .MaxPasses &quot;10&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># With FDSolver</span>
<span class="c1">#      .Method &quot;Tetrahedral Mesh (MOR)&quot;</span>
<span class="c1">#      .HexMORSettings &quot;&quot;, &quot;5001&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># FDSolver.Method &quot;Tetrahedral Mesh&quot; &#39; i.e. general purpose</span>

<span class="c1"># &#39;----------------------------------------------------------------------------</span>

<span class="c1"># With FDSolver</span>
<span class="c1">#      .SetMethod &quot;Tetrahedral&quot;, &quot;Fast reduced order model&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># With MeshSettings</span>
<span class="c1">#      .SetMeshType &quot;Tet&quot;</span>
<span class="c1">#      .Set &quot;Version&quot;, 1%</span>
<span class="c1"># End With</span>

<span class="c1"># With Mesh</span>
<span class="c1">#      .MeshType &quot;Tetrahedral&quot;</span>
<span class="c1"># End With</span>

<span class="c1"># &#39;set the solver type</span>
<span class="c1"># ChangeSolverType(&quot;HF Frequency Domain&quot;)</span>

<span class="c1"># &#39;----------------------------------------------------------------------------</span>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Martin Mihaylov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>